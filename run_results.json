{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.0", "generated_at": "2026-02-05T21:55:01.840548Z", "invocation_id": "ba030689-8ef1-4904-9f62-649824a6d8fd", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.075426Z", "completed_at": "2026-02-05T21:54:59.128248Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.129710Z", "completed_at": "2026-02-05T21:54:59.129725Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.059946298599243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.dim_dates", "compiled": true, "compiled_code": "with date_spine as (\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 1095\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    cast('2022-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast('2024-12-31' as date)\n\n)\n\nselect * from filtered\n\n\n),\n\nfinal as (\n    select\n        cast(date_day as date) as date_day,\n        date_trunc('month', date_day) as date_month,\n        extract(year from date_day) as year,\n        extract(quarter from date_day) as quarter,\n        extract(month from date_day) as month,\n        extract(day from date_day) as day_of_month,\n        extract(dow from date_day) as day_of_week,\n        case when extract(dow from date_day) in (0, 6) then true else false end as is_weekend\n    from date_spine\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"dim_dates\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.137284Z", "completed_at": "2026-02-05T21:54:59.141730Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.143193Z", "completed_at": "2026-02-05T21:54:59.143202Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008569955825805664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_customers", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"customers\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by customer_id\n            order by updated_at desc nulls last, created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(customer_id as integer) as customer_id,\n        lower(trim(email)) as email,\n        trim(company_name) as company_name,\n        cast(signup_date as date) as signup_date,\n        cast(end_date as date) as end_date,\n        lower(trim(account_status)) as account_status,\n        trim(industry) as industry,\n        trim(company_size) as company_size,\n        trim(country) as country,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.147451Z", "completed_at": "2026-02-05T21:54:59.151552Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.152972Z", "completed_at": "2026-02-05T21:54:59.152980Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008118629455566406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_payments", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"payments\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by payment_id\n            order by created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(payment_id as integer) as payment_id,\n        cast(subscription_id as integer) as subscription_id,\n        cast(payment_date as date) as payment_date,\n        cast(amount as double) as amount,\n        lower(trim(status)) as status,\n        lower(trim(payment_method)) as payment_method,\n        cast(created_at as timestamp) as created_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_payments\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.157473Z", "completed_at": "2026-02-05T21:54:59.162316Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.163710Z", "completed_at": "2026-02-05T21:54:59.163718Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008933782577514648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_plans", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"plans\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by plan_id\n            order by created_date desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(plan_id as integer) as plan_id,\n        trim(plan_name) as plan_name,\n        lower(trim(plan_tier)) as plan_tier,\n        cast(base_price_monthly as double) as base_price_monthly,\n        cast(base_price_annual as double) as base_price_annual,\n        trim(features) as features,\n        cast(max_users as integer) as max_users,\n        cast(created_date as date) as created_date\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_plans\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.167949Z", "completed_at": "2026-02-05T21:54:59.172201Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.173616Z", "completed_at": "2026-02-05T21:54:59.173624Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008231639862060547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_subscriptions", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"subscriptions\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by subscription_id\n            order by updated_at desc nulls last, created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(subscription_id as integer) as subscription_id,\n        cast(customer_id as integer) as customer_id,\n        cast(plan_id as integer) as plan_id,\n        cast(start_date as date) as start_date,\n        cast(end_date as date) as end_date,\n        lower(trim(status)) as status,\n        cast(mrr_amount as double) as mrr_amount,\n        lower(trim(billing_cycle)) as billing_cycle,\n        cast(amount as double) as amount,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_subscriptions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.177888Z", "completed_at": "2026-02-05T21:54:59.181912Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.183350Z", "completed_at": "2026-02-05T21:54:59.183357Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008042335510253906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_support_tickets", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"support_tickets\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by ticket_id\n            order by created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(ticket_id as integer) as ticket_id,\n        cast(customer_id as integer) as customer_id,\n        cast(created_date as date) as created_date,\n        cast(resolved_date as date) as resolved_date,\n        lower(trim(category)) as category,\n        lower(trim(priority)) as priority,\n        cast(satisfaction_score as integer) as satisfaction_score,\n        cast(created_at as timestamp) as created_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_support_tickets\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.187829Z", "completed_at": "2026-02-05T21:54:59.191528Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.192924Z", "completed_at": "2026-02-05T21:54:59.192931Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0078046321868896484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_usage_events", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"usage_events\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by event_id\n            order by created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(event_id as integer) as event_id,\n        cast(customer_id as integer) as customer_id,\n        cast(event_date as date) as event_date,\n        lower(trim(event_type)) as event_type,\n        cast(usage_quantity as integer) as usage_quantity,\n        cast(created_at as timestamp) as created_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_usage_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.197432Z", "completed_at": "2026-02-05T21:54:59.211976Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.213367Z", "completed_at": "2026-02-05T21:54:59.213375Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018786907196044922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_customers_customer_id.b4eeb23995", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main\".\"customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.217435Z", "completed_at": "2026-02-05T21:54:59.222334Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.223697Z", "completed_at": "2026-02-05T21:54:59.223704Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008778095245361328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_payments_payment_id.3057b24598", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_id\nfrom \"saas_analytics\".\"main\".\"payments\"\nwhere payment_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.227783Z", "completed_at": "2026-02-05T21:54:59.232801Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.234216Z", "completed_at": "2026-02-05T21:54:59.234225Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008924722671508789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_plans_plan_id.60ea0c3f70", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main\".\"plans\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.238350Z", "completed_at": "2026-02-05T21:54:59.243353Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.244716Z", "completed_at": "2026-02-05T21:54:59.244724Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008913755416870117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_subscriptions_subscription_id.d38f0dcd3e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main\".\"subscriptions\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.248817Z", "completed_at": "2026-02-05T21:54:59.253748Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.255125Z", "completed_at": "2026-02-05T21:54:59.255133Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008797168731689453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_support_tickets_ticket_id.f5e0ca9687", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"saas_analytics\".\"main\".\"support_tickets\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.259198Z", "completed_at": "2026-02-05T21:54:59.265329Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.266690Z", "completed_at": "2026-02-05T21:54:59.266698Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010007381439208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_usage_events_event_id.6b4882f73b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"saas_analytics\".\"main\".\"usage_events\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.270771Z", "completed_at": "2026-02-05T21:54:59.280182Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.281588Z", "completed_at": "2026-02-05T21:54:59.281596Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013345479965209961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_payments_subscription_id__subscription_id__source_raw_saas_subscriptions_.eec6fd2df4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select subscription_id as from_field\n    from \"saas_analytics\".\"main\".\"payments\"\n    where subscription_id is not null\n),\n\nparent as (\n    select subscription_id as to_field\n    from \"saas_analytics\".\"main\".\"subscriptions\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.285788Z", "completed_at": "2026-02-05T21:54:59.292181Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.293581Z", "completed_at": "2026-02-05T21:54:59.293589Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01033163070678711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_subscriptions_customer_id__customer_id__source_raw_saas_customers_.d9d2470757", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main\".\"subscriptions\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main\".\"customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.297787Z", "completed_at": "2026-02-05T21:54:59.303731Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.305136Z", "completed_at": "2026-02-05T21:54:59.305144Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009932279586791992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_support_tickets_customer_id__customer_id__source_raw_saas_customers_.558da46c8f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main\".\"support_tickets\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main\".\"customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.309315Z", "completed_at": "2026-02-05T21:54:59.316393Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.317775Z", "completed_at": "2026-02-05T21:54:59.317783Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011083364486694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_usage_events_customer_id__customer_id__source_raw_saas_customers_.edd5bda594", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main\".\"usage_events\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main\".\"customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.321983Z", "completed_at": "2026-02-05T21:54:59.329196Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.330574Z", "completed_at": "2026-02-05T21:54:59.330582Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011234283447265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_customers_customer_id.5e4b5bfe1e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.334740Z", "completed_at": "2026-02-05T21:54:59.339696Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.341086Z", "completed_at": "2026-02-05T21:54:59.341094Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008854866027832031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_payments_payment_id.3ce97338e8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    payment_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"payments\"\nwhere payment_id is not null\ngroup by payment_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.345276Z", "completed_at": "2026-02-05T21:54:59.350283Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.351638Z", "completed_at": "2026-02-05T21:54:59.351646Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008969783782958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_plans_plan_id.1874d4258c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    plan_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"plans\"\nwhere plan_id is not null\ngroup by plan_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.355743Z", "completed_at": "2026-02-05T21:54:59.360623Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.361997Z", "completed_at": "2026-02-05T21:54:59.362005Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008793830871582031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_subscriptions_subscription_id.f107c8e56a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"subscriptions\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.366147Z", "completed_at": "2026-02-05T21:54:59.372432Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.373809Z", "completed_at": "2026-02-05T21:54:59.373816Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010280132293701172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_support_tickets_ticket_id.590438c9f6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"support_tickets\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.377895Z", "completed_at": "2026-02-05T21:54:59.382717Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.384102Z", "completed_at": "2026-02-05T21:54:59.384110Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008769512176513672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_usage_events_event_id.e76df55de9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"usage_events\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.388252Z", "completed_at": "2026-02-05T21:54:59.393260Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.394636Z", "completed_at": "2026-02-05T21:54:59.394644Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008988618850708008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_dates_date_day.1717af99fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"saas_analytics\".\"main_marts\".\"dim_dates\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.398731Z", "completed_at": "2026-02-05T21:54:59.403785Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.405164Z", "completed_at": "2026-02-05T21:54:59.405172Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008915901184082031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_dates_date_month.8043b8f3cb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"dim_dates\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.409284Z", "completed_at": "2026-02-05T21:54:59.414101Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.415445Z", "completed_at": "2026-02-05T21:54:59.415453Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008750677108764648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_dim_dates_date_day.5e9dfa95c7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_day as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"dim_dates\"\nwhere date_day is not null\ngroup by date_day\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.419564Z", "completed_at": "2026-02-05T21:54:59.424771Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.426224Z", "completed_at": "2026-02-05T21:54:59.426232Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009275197982788086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.dim_customers", "compiled": true, "compiled_code": "with customers as (\n    select\n        customer_id,\n        email,\n        company_name,\n        industry,\n        company_size,\n        country,\n        signup_date,\n        end_date,\n        account_status\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n),\n\nfinal as (\n    select\n        customer_id,\n        email,\n        company_name,\n        industry,\n        company_size,\n        case\n            when lower(company_size) = 'small' then 'smb'\n            when lower(company_size) = 'medium' then 'mid-market'\n            when lower(company_size) = 'large' then 'enterprise'\n            else 'unknown'\n        end as customer_segment,\n        country,\n        signup_date,\n        end_date as churn_date,\n        account_status,\n        case when account_status = 'active' then true else false end as is_active\n    from customers\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"dim_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.430596Z", "completed_at": "2026-02-05T21:54:59.434356Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.435770Z", "completed_at": "2026-02-05T21:54:59.435778Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008024930953979492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_customer_cohorts", "compiled": true, "compiled_code": "with customers as (\n    select\n        customer_id,\n        signup_date\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n),\n\nfinal as (\n    select\n        customer_id,\n        date_trunc('month', signup_date) as cohort_month\n    from customers\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.440154Z", "completed_at": "2026-02-05T21:54:59.450026Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.451423Z", "completed_at": "2026-02-05T21:54:59.451430Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014014720916748047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_customers_account_status__active__churned.4ba2500c79", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        account_status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n    group by account_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','churned'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.455620Z", "completed_at": "2026-02-05T21:54:59.474526Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.475972Z", "completed_at": "2026-02-05T21:54:59.475982Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022939443588256836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_match_regex_stg_customers_email___a_zA_Z0_9__a_zA_Z0_9_a_zA_Z0_9_.796c35c3c5", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \n\nregexp_matches(email, '^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$', '')\n\n\n > 0\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.480242Z", "completed_at": "2026-02-05T21:54:59.486474Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.487828Z", "completed_at": "2026-02-05T21:54:59.487836Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010147809982299805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_account_status.d9b1d833ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_status\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere account_status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.491992Z", "completed_at": "2026-02-05T21:54:59.496864Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.498253Z", "completed_at": "2026-02-05T21:54:59.498261Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00878763198852539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.502392Z", "completed_at": "2026-02-05T21:54:59.507355Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.508722Z", "completed_at": "2026-02-05T21:54:59.508730Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008927345275878906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_email.d7cf761533", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere email is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.512819Z", "completed_at": "2026-02-05T21:54:59.517826Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.519299Z", "completed_at": "2026-02-05T21:54:59.519307Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009033918380737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_signup_date.ef12d9c335", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect signup_date\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere signup_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.523494Z", "completed_at": "2026-02-05T21:54:59.529384Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.530757Z", "completed_at": "2026-02-05T21:54:59.530764Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009908199310302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_customers_customer_id.c7614daada", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.534845Z", "completed_at": "2026-02-05T21:54:59.551623Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.553083Z", "completed_at": "2026-02-05T21:54:59.553091Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020789146423339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_payment_history", "compiled": true, "compiled_code": "with payments as (\n    select\n        subscription_id,\n        date_trunc('month', payment_date) as payment_month,\n        status,\n        amount\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n),\n\nmonthly_payments as (\n    select\n        subscription_id,\n        payment_month,\n        count(*) as payment_count,\n        sum(case when status = 'success' then 1 else 0 end) as successful_payments,\n        sum(case when status = 'failed' then 1 else 0 end) as failed_payments,\n        sum(case when status = 'refunded' then 1 else 0 end) as refunded_payments,\n        sum(amount) as net_amount\n    from payments\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(subscription_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(payment_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as subscription_month_id,\n        subscription_id,\n        payment_month,\n        payment_count,\n        successful_payments,\n        failed_payments,\n        refunded_payments,\n        net_amount\n    from monthly_payments\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_payment_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.557423Z", "completed_at": "2026-02-05T21:54:59.564450Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.565870Z", "completed_at": "2026-02-05T21:54:59.565877Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011097908020019531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_payments_payment_method__credit_card__bank_transfer__paypal.9a9e2818f7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        payment_method as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n    group by payment_method\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'credit_card','bank_transfer','paypal'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.570077Z", "completed_at": "2026-02-05T21:54:59.576588Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.578001Z", "completed_at": "2026-02-05T21:54:59.578009Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010479211807250977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_payments_status__success__failed__refunded.f3ae67bf94", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'success','failed','refunded'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.582140Z", "completed_at": "2026-02-05T21:54:59.588044Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.589403Z", "completed_at": "2026-02-05T21:54:59.589411Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009790182113647461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_payment_id.c19cc50075", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere payment_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.593522Z", "completed_at": "2026-02-05T21:54:59.656344Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.657757Z", "completed_at": "2026-02-05T21:54:59.657767Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06686258316040039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_payment_method.dad6ff229d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_method\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere payment_method is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.662015Z", "completed_at": "2026-02-05T21:54:59.667114Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.668513Z", "completed_at": "2026-02-05T21:54:59.668524Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009171724319458008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_status.dec3c85699", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.672692Z", "completed_at": "2026-02-05T21:54:59.677732Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.679132Z", "completed_at": "2026-02-05T21:54:59.679140Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009016752243041992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_subscription_id.182bae4263", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.683262Z", "completed_at": "2026-02-05T21:54:59.688063Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.689450Z", "completed_at": "2026-02-05T21:54:59.689458Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008709907531738281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_payments_payment_id.3744510712", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    payment_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere payment_id is not null\ngroup by payment_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.693616Z", "completed_at": "2026-02-05T21:54:59.698260Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.699665Z", "completed_at": "2026-02-05T21:54:59.699673Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008624076843261719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.dim_plans", "compiled": true, "compiled_code": "with plans as (\n    select\n        plan_id,\n        plan_name,\n        plan_tier,\n        base_price_monthly,\n        base_price_annual,\n        features,\n        max_users,\n        created_date\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n),\n\nfinal as (\n    select\n        plan_id,\n        plan_name,\n        plan_tier,\n        base_price_monthly,\n        base_price_annual,\n        max_users,\n        features,\n        created_date\n    from plans\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"dim_plans\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.703933Z", "completed_at": "2026-02-05T21:54:59.710759Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.712168Z", "completed_at": "2026-02-05T21:54:59.712176Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010845422744750977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_plans_plan_tier__starter__professional__enterprise.6627a5bb68", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        plan_tier as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n    group by plan_tier\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'starter','professional','enterprise'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.716329Z", "completed_at": "2026-02-05T21:54:59.728277Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.729689Z", "completed_at": "2026-02-05T21:54:59.729698Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015988588333129883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_plans_base_price_annual__1000000__0.90f48edeea", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_annual >= 0 and base_price_annual <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.733895Z", "completed_at": "2026-02-05T21:54:59.739374Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.740771Z", "completed_at": "2026-02-05T21:54:59.740778Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009487628936767578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_plans_base_price_monthly__100000__0.29dde2c990", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_monthly >= 0 and base_price_monthly <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.744922Z", "completed_at": "2026-02-05T21:54:59.750900Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.752276Z", "completed_at": "2026-02-05T21:54:59.752284Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00993800163269043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_base_price_annual.7ff22b0352", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_annual\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere base_price_annual is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.756483Z", "completed_at": "2026-02-05T21:54:59.761448Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.762831Z", "completed_at": "2026-02-05T21:54:59.762839Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008988618850708008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_base_price_monthly.768fac3224", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_monthly\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere base_price_monthly is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.767011Z", "completed_at": "2026-02-05T21:54:59.771754Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.773163Z", "completed_at": "2026-02-05T21:54:59.773171Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008755207061767578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_plan_id.97197e92e3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.777340Z", "completed_at": "2026-02-05T21:54:59.782252Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.783630Z", "completed_at": "2026-02-05T21:54:59.783637Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008824348449707031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_plan_tier.eba3d0c0c9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_tier\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere plan_tier is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.787789Z", "completed_at": "2026-02-05T21:54:59.792687Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.794080Z", "completed_at": "2026-02-05T21:54:59.794088Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008863210678100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_plans_plan_id.b3adbcbaf7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    plan_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere plan_id is not null\ngroup by plan_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.798220Z", "completed_at": "2026-02-05T21:54:59.806085Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.807512Z", "completed_at": "2026-02-05T21:54:59.807520Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011810541152954102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.fct_monthly_recurring_revenue", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\nsubscriptions as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        billing_cycle,\n        amount,\n        -- Normalize MRR from amount + billing_cycle (more robust than trusting raw mrr_amount)\n        \n    case\n        when billing_cycle = 'annual' then amount / 12.0\n        when billing_cycle = 'monthly' then amount\n        else 0\n    end\n as normalized_mrr_amount\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n),\n\nsubscription_months as (\n    select\n        s.customer_id,\n        s.subscription_id,\n        s.plan_id,\n        m.date_month,\n        s.status,\n        s.billing_cycle,\n        s.amount,\n        case\n            when s.status = 'paused' then 0\n            else s.normalized_mrr_amount\n        end as mrr_amount\n    from subscriptions s\n    join months m\n        on m.date_month >= date_trunc('month', s.start_date)\n        and (\n            s.end_date is null\n            or m.date_month <= date_trunc('month', s.end_date)\n        )\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_month_id,\n        customer_id,\n        date_month,\n        sum(mrr_amount) as mrr_amount,\n        count(distinct subscription_id) as subscription_count\n    from subscription_months\n    group by 1, 2, 3\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.811732Z", "completed_at": "2026-02-05T21:54:59.815723Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.817157Z", "completed_at": "2026-02-05T21:54:59.817165Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008089780807495117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.fct_subscriptions", "compiled": true, "compiled_code": "with subscriptions as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        billing_cycle,\n        amount,\n        mrr_amount\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n),\n\nfinal as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        billing_cycle,\n        amount,\n        mrr_amount,\n        case\n            when status = 'active' then true\n            else false\n        end as is_currently_active\n    from subscriptions\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"fct_subscriptions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.821339Z", "completed_at": "2026-02-05T21:54:59.825358Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.826792Z", "completed_at": "2026-02-05T21:54:59.826800Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008106231689453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_subscription_periods", "compiled": true, "compiled_code": "with subscriptions as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        mrr_amount,\n        billing_cycle,\n        amount\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n),\n\nfinal as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        mrr_amount,\n        billing_cycle,\n        amount\n    from subscriptions\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.830977Z", "completed_at": "2026-02-05T21:54:59.837473Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.838859Z", "completed_at": "2026-02-05T21:54:59.838866Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010543346405029297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_subscriptions_billing_cycle__monthly__annual.373ee04739", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        billing_cycle as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    group by billing_cycle\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'monthly','annual'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.843051Z", "completed_at": "2026-02-05T21:54:59.850638Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.852049Z", "completed_at": "2026-02-05T21:54:59.852057Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011544942855834961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_subscriptions_status__active__paused__churned__upgraded__downgraded.2ca9adef65", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','paused','churned','upgraded','downgraded'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.856174Z", "completed_at": "2026-02-05T21:54:59.861670Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.863092Z", "completed_at": "2026-02-05T21:54:59.863100Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009464502334594727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_subscriptions_amount__1000000__0.0aec0f7ac5", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and amount >= 0 and amount <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.867263Z", "completed_at": "2026-02-05T21:54:59.872751Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.874176Z", "completed_at": "2026-02-05T21:54:59.874188Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009527206420898438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_subscriptions_mrr_amount__100000__0.1f718c7d2b", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.878328Z", "completed_at": "2026-02-05T21:54:59.883299Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.884664Z", "completed_at": "2026-02-05T21:54:59.884672Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008911371231079102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_amount.d2bc105990", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.888766Z", "completed_at": "2026-02-05T21:54:59.893551Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.894898Z", "completed_at": "2026-02-05T21:54:59.894906Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008671760559082031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_billing_cycle.a5cc3f107d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect billing_cycle\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere billing_cycle is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.899000Z", "completed_at": "2026-02-05T21:54:59.905148Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.906494Z", "completed_at": "2026-02-05T21:54:59.906501Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010055780410766602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_customer_id.2baac6ebd7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.910571Z", "completed_at": "2026-02-05T21:54:59.915482Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.916830Z", "completed_at": "2026-02-05T21:54:59.916837Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008757829666137695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_mrr_amount.9940a0b6a0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.920890Z", "completed_at": "2026-02-05T21:54:59.925639Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.927030Z", "completed_at": "2026-02-05T21:54:59.927038Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008606195449829102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_plan_id.ebc4c7e103", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.931737Z", "completed_at": "2026-02-05T21:54:59.936734Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.938121Z", "completed_at": "2026-02-05T21:54:59.938129Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009203910827636719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_start_date.aae12535b8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_date\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere start_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.942225Z", "completed_at": "2026-02-05T21:54:59.948040Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.949402Z", "completed_at": "2026-02-05T21:54:59.949410Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009766578674316406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_status.e945ee07e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.953453Z", "completed_at": "2026-02-05T21:54:59.958318Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.959674Z", "completed_at": "2026-02-05T21:54:59.959682Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00876617431640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_subscription_id.68a3edda91", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.963824Z", "completed_at": "2026-02-05T21:54:59.969700Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.971102Z", "completed_at": "2026-02-05T21:54:59.971111Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009787797927856445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_payments_subscription_id__subscription_id__ref_stg_subscriptions_.0ab4d26fa6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select subscription_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n    where subscription_id is not null\n),\n\nparent as (\n    select subscription_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.975306Z", "completed_at": "2026-02-05T21:54:59.981218Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.982621Z", "completed_at": "2026-02-05T21:54:59.982630Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009965658187866211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_subscriptions_customer_id__customer_id__ref_stg_customers_.3a4746f98e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.986786Z", "completed_at": "2026-02-05T21:54:59.993033Z"}, {"name": "execute", "started_at": "2026-02-05T21:54:59.994431Z", "completed_at": "2026-02-05T21:54:59.994440Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01022958755493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_subscriptions_plan_id__plan_id__ref_stg_plans_.9e3939335e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select plan_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    where plan_id is not null\n),\n\nparent as (\n    select plan_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:54:59.998583Z", "completed_at": "2026-02-05T21:55:00.004622Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.005997Z", "completed_at": "2026-02-05T21:55:00.006005Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009918689727783203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_subscriptions_subscription_id.d45e893a6e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.010089Z", "completed_at": "2026-02-05T21:55:00.017206Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.018585Z", "completed_at": "2026-02-05T21:55:00.018593Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011018753051757812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_support_tickets_category__billing__technical__feature_request__other.2da1083ca7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        category as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    group by category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'billing','technical','feature_request','other'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.022814Z", "completed_at": "2026-02-05T21:55:00.029996Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.031403Z", "completed_at": "2026-02-05T21:55:00.031411Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011164665222167969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_support_tickets_priority__low__medium__high__urgent.63d517161e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        priority as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    group by priority\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'low','medium','high','urgent'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.035638Z", "completed_at": "2026-02-05T21:55:00.041537Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.042940Z", "completed_at": "2026-02-05T21:55:00.042947Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009862661361694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_support_tickets_satisfaction_score__5__1__satisfaction_score_is_not_null.ea8ac41f35", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and satisfaction_score >= 1 and satisfaction_score <= 5\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    where\n        satisfaction_score is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.047143Z", "completed_at": "2026-02-05T21:55:00.053181Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.054550Z", "completed_at": "2026-02-05T21:55:00.054557Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010013580322265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_category.28b0c1060c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere category is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.058621Z", "completed_at": "2026-02-05T21:55:00.063615Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.065009Z", "completed_at": "2026-02-05T21:55:00.065017Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008926153182983398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_customer_id.1a8e520036", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.069145Z", "completed_at": "2026-02-05T21:55:00.073996Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.075390Z", "completed_at": "2026-02-05T21:55:00.075398Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008791685104370117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_priority.beb363395f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect priority\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere priority is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.079548Z", "completed_at": "2026-02-05T21:55:00.084502Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.085853Z", "completed_at": "2026-02-05T21:55:00.085861Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008983373641967773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_ticket_id.7830ecbac2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.090068Z", "completed_at": "2026-02-05T21:55:00.097185Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.098574Z", "completed_at": "2026-02-05T21:55:00.098583Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011046409606933594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_support_tickets_customer_id__customer_id__ref_stg_customers_.be9984b1c6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.102712Z", "completed_at": "2026-02-05T21:55:00.107449Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.108805Z", "completed_at": "2026-02-05T21:55:00.108813Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008654594421386719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_support_tickets_ticket_id.eed19dcb0a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.112891Z", "completed_at": "2026-02-05T21:55:00.118451Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.119852Z", "completed_at": "2026-02-05T21:55:00.119859Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009491920471191406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_customer_health_score", "compiled": true, "compiled_code": "with customers as (\n    select\n        customer_id\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n),\n\nas_of as (\n    select\n        greatest(\n            coalesce((select max(event_date) from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"), date '1900-01-01'),\n            coalesce((select max(payment_date) from \"saas_analytics\".\"main_staging\".\"stg_payments\"), date '1900-01-01'),\n            coalesce((select max(created_date) from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"), date '1900-01-01')\n        ) as as_of_date\n),\n\nusage_last_30d as (\n    select\n        ue.customer_id,\n        count(*) as events_last_30d,\n        sum(ue.usage_quantity) as usage_quantity_last_30d\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\" ue\n    cross join as_of a\n    where ue.event_date > a.as_of_date - interval 30 day\n      and ue.event_date <= a.as_of_date\n    group by 1\n),\n\ntickets_last_90d as (\n    select\n        t.customer_id,\n        count(*) as tickets_created_last_90d,\n        sum(case when t.resolved_date is null then 1 else 0 end) as open_tickets\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\" t\n    cross join as_of a\n    where t.created_date > a.as_of_date - interval 90 day\n      and t.created_date <= a.as_of_date\n    group by 1\n),\n\npayment_failures_last_90d as (\n    select\n        s.customer_id,\n        count(*) as payment_events_last_90d,\n        sum(case when p.status = 'failed' then 1 else 0 end) as failed_payments_last_90d\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\" p\n    join \"saas_analytics\".\"main_staging\".\"stg_subscriptions\" s\n        on p.subscription_id = s.subscription_id\n    cross join as_of a\n    where p.payment_date > a.as_of_date - interval 90 day\n      and p.payment_date <= a.as_of_date\n    group by 1\n),\n\nscored as (\n    select\n        c.customer_id,\n        a.as_of_date,\n        coalesce(u.events_last_30d, 0) as events_last_30d,\n        coalesce(u.usage_quantity_last_30d, 0) as usage_quantity_last_30d,\n        coalesce(t.tickets_created_last_90d, 0) as tickets_created_last_90d,\n        coalesce(t.open_tickets, 0) as open_tickets,\n        coalesce(p.payment_events_last_90d, 0) as payment_events_last_90d,\n        coalesce(p.failed_payments_last_90d, 0) as failed_payments_last_90d,\n        case\n            when coalesce(p.payment_events_last_90d, 0) = 0 then 0\n            else coalesce(p.failed_payments_last_90d, 0)::double / p.payment_events_last_90d\n        end as payment_failure_rate_last_90d\n    from customers c\n    cross join as_of a\n    left join usage_last_30d u\n        on c.customer_id = u.customer_id\n    left join tickets_last_90d t\n        on c.customer_id = t.customer_id\n    left join payment_failures_last_90d p\n        on c.customer_id = p.customer_id\n),\n\nfinal as (\n    select\n        customer_id,\n        as_of_date,\n        events_last_30d,\n        usage_quantity_last_30d,\n        tickets_created_last_90d,\n        open_tickets,\n        payment_events_last_90d,\n        failed_payments_last_90d,\n        payment_failure_rate_last_90d,\n        least(\n            100,\n            greatest(\n                0,\n                70\n                + least(30, events_last_30d)::integer\n                - least(40, open_tickets * 10)::integer\n                - least(40, (payment_failure_rate_last_90d * 100)::integer)\n            )\n        ) as health_score\n    from scored\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.124234Z", "completed_at": "2026-02-05T21:55:00.129753Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.131204Z", "completed_at": "2026-02-05T21:55:00.131212Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010131597518920898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_monthly_usage", "compiled": true, "compiled_code": "with usage_events as (\n    select\n        customer_id,\n        date_trunc('month', event_date) as usage_month,\n        event_type,\n        usage_quantity\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n),\n\nmonthly_usage as (\n    select\n        customer_id,\n        usage_month,\n        count(*) as event_count,\n        sum(usage_quantity) as total_usage_quantity,\n        sum(case when event_type = 'login' then 1 else 0 end) as login_events,\n        sum(case when event_type = 'feature_usage' then 1 else 0 end) as feature_usage_events,\n        sum(case when event_type = 'export' then 1 else 0 end) as export_events,\n        sum(case when event_type = 'api_call' then 1 else 0 end) as api_call_events\n    from usage_events\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(usage_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_month_id,\n        customer_id,\n        usage_month,\n        event_count,\n        total_usage_quantity,\n        login_events,\n        feature_usage_events,\n        export_events,\n        api_call_events\n    from monthly_usage\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.136473Z", "completed_at": "2026-02-05T21:55:00.144070Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.145470Z", "completed_at": "2026-02-05T21:55:00.145478Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011719226837158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_usage_events_event_type__login__feature_usage__export__api_call.9e239b4047", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        event_type as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n    group by event_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'login','feature_usage','export','api_call'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.149629Z", "completed_at": "2026-02-05T21:55:00.156247Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.157630Z", "completed_at": "2026-02-05T21:55:00.157637Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010531187057495117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_usage_events_usage_quantity__1000000__0.a19ac32495", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and usage_quantity >= 0 and usage_quantity <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.161725Z", "completed_at": "2026-02-05T21:55:00.166598Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.167942Z", "completed_at": "2026-02-05T21:55:00.167965Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008695840835571289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_customer_id.424cb78bfc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.172117Z", "completed_at": "2026-02-05T21:55:00.177081Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.178467Z", "completed_at": "2026-02-05T21:55:00.178475Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008866548538208008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_event_id.2c1891cce4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.182638Z", "completed_at": "2026-02-05T21:55:00.187465Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.188817Z", "completed_at": "2026-02-05T21:55:00.188825Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008781671524047852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_event_type.b865685b11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_type\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere event_type is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.192929Z", "completed_at": "2026-02-05T21:55:00.198861Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.200298Z", "completed_at": "2026-02-05T21:55:00.200306Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009930610656738281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_usage_quantity.8fafec8a69", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect usage_quantity\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere usage_quantity is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.204405Z", "completed_at": "2026-02-05T21:55:00.210151Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.211537Z", "completed_at": "2026-02-05T21:55:00.211545Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009684562683105469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_usage_events_customer_id__customer_id__ref_stg_customers_.33deb2f692", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.215695Z", "completed_at": "2026-02-05T21:55:00.220546Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.221912Z", "completed_at": "2026-02-05T21:55:00.221920Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008785247802734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_usage_events_event_id.8f4005aa34", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.226052Z", "completed_at": "2026-02-05T21:55:00.232719Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.234130Z", "completed_at": "2026-02-05T21:55:00.234138Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010681629180908203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_dim_customers_customer_segment__smb__mid_market__enterprise__unknown.59f6eba2cc", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.238276Z", "completed_at": "2026-02-05T21:55:00.243298Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.244676Z", "completed_at": "2026-02-05T21:55:00.244684Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00901651382446289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_customer_id.dd91cd1c8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.248787Z", "completed_at": "2026-02-05T21:55:00.254773Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.256161Z", "completed_at": "2026-02-05T21:55:00.256169Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009915590286254883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_customer_segment.bc342ee8ba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.260251Z", "completed_at": "2026-02-05T21:55:00.265191Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.266586Z", "completed_at": "2026-02-05T21:55:00.266594Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0089263916015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_email.ed68b54d1a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere email is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.270740Z", "completed_at": "2026-02-05T21:55:00.275659Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.277050Z", "completed_at": "2026-02-05T21:55:00.277058Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00889730453491211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_signup_date.7f7d0227dd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect signup_date\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere signup_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.281387Z", "completed_at": "2026-02-05T21:55:00.286061Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.287434Z", "completed_at": "2026-02-05T21:55:00.287442Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008809089660644531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_dim_customers_customer_id.15c9f1e2fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.291548Z", "completed_at": "2026-02-05T21:55:00.297651Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.299054Z", "completed_at": "2026-02-05T21:55:00.299062Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010040044784545898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_cohorts_cohort_month.5f7f1ecfb6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_month\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\"\nwhere cohort_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.303161Z", "completed_at": "2026-02-05T21:55:00.308004Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.309385Z", "completed_at": "2026-02-05T21:55:00.309393Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008830785751342773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_cohorts_customer_id.a75833fcff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.313523Z", "completed_at": "2026-02-05T21:55:00.318381Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.319755Z", "completed_at": "2026-02-05T21:55:00.319763Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008755207061767578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_customer_cohorts_customer_id.279a739d39", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.323998Z", "completed_at": "2026-02-05T21:55:00.329643Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.331102Z", "completed_at": "2026-02-05T21:55:00.331111Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009791135787963867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_payment_history_net_amount__1000000000___1000000000.297926e2b5", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and net_amount >= -1000000000 and net_amount <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.335341Z", "completed_at": "2026-02-05T21:55:00.341011Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.342414Z", "completed_at": "2026-02-05T21:55:00.342421Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009740829467773438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_payment_history_payment_count__100000000__0.41e5b20a2f", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and payment_count >= 0 and payment_count <= 100000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.346621Z", "completed_at": "2026-02-05T21:55:00.352757Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.354154Z", "completed_at": "2026-02-05T21:55:00.354162Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010078668594360352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_net_amount.c0b496bbc8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect net_amount\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere net_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.358240Z", "completed_at": "2026-02-05T21:55:00.363174Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.364554Z", "completed_at": "2026-02-05T21:55:00.364562Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008853435516357422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_payment_count.c9d746fa8b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_count\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere payment_count is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.368686Z", "completed_at": "2026-02-05T21:55:00.373568Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.374973Z", "completed_at": "2026-02-05T21:55:00.374981Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008845806121826172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_payment_month.218496379c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_month\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere payment_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.379291Z", "completed_at": "2026-02-05T21:55:00.384052Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.385411Z", "completed_at": "2026-02-05T21:55:00.385419Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008887529373168945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_subscription_id.f530bb3c51", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.389576Z", "completed_at": "2026-02-05T21:55:00.395628Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.397004Z", "completed_at": "2026-02-05T21:55:00.397012Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010015249252319336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_subscription_month_id.ea8c983f61", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_month_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere subscription_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.401164Z", "completed_at": "2026-02-05T21:55:00.407011Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.408389Z", "completed_at": "2026-02-05T21:55:00.408397Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009887456893920898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_payment_history_subscription_id__subscription_id__ref_stg_subscriptions_.c2dc1d48a4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select subscription_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\n    where subscription_id is not null\n),\n\nparent as (\n    select subscription_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.412573Z", "completed_at": "2026-02-05T21:55:00.417384Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.418746Z", "completed_at": "2026-02-05T21:55:00.418754Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008678436279296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_payment_history_subscription_month_id.d1f891bb75", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere subscription_month_id is not null\ngroup by subscription_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.422911Z", "completed_at": "2026-02-05T21:55:00.428168Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.429524Z", "completed_at": "2026-02-05T21:55:00.429532Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009153366088867188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_dim_plans_plan_tier__starter__professional__enterprise.951b43f83d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        plan_tier as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n    group by plan_tier\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'starter','professional','enterprise'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.433685Z", "completed_at": "2026-02-05T21:55:00.439331Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.440723Z", "completed_at": "2026-02-05T21:55:00.440731Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00955963134765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_dim_plans_base_price_annual__1000000__0.3da0c08240", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_annual >= 0 and base_price_annual <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.444933Z", "completed_at": "2026-02-05T21:55:00.451576Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.452976Z", "completed_at": "2026-02-05T21:55:00.452984Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01058340072631836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_dim_plans_base_price_monthly__100000__0.80491e18f9", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_monthly >= 0 and base_price_monthly <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.457114Z", "completed_at": "2026-02-05T21:55:00.462053Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.463495Z", "completed_at": "2026-02-05T21:55:00.463503Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00890803337097168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_base_price_annual.eee138969b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_annual\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere base_price_annual is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.467614Z", "completed_at": "2026-02-05T21:55:00.472579Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.473987Z", "completed_at": "2026-02-05T21:55:00.473995Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008991241455078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_base_price_monthly.0aa94d6b4b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_monthly\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere base_price_monthly is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.478237Z", "completed_at": "2026-02-05T21:55:00.483014Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.484372Z", "completed_at": "2026-02-05T21:55:00.484379Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00875544548034668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_plan_id.78a937462a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.488473Z", "completed_at": "2026-02-05T21:55:00.494423Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.495785Z", "completed_at": "2026-02-05T21:55:00.495793Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00992274284362793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_plan_tier.154dd327a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_tier\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere plan_tier is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.499852Z", "completed_at": "2026-02-05T21:55:00.504564Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.505923Z", "completed_at": "2026-02-05T21:55:00.505930Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008567333221435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_dim_plans_plan_id.27d8cecd0f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    plan_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere plan_id is not null\ngroup by plan_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.510042Z", "completed_at": "2026-02-05T21:55:00.515721Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.517152Z", "completed_at": "2026-02-05T21:55:00.517160Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009611845016479492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.churn_analysis", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\ncustomer_month_spine as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        m.date_month\n    from customers c\n    cross join months m\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\nwith_prev as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        lag(mrr_amount) over (partition by customer_id order by date_month) as prev_mrr_amount\n    from customer_mrr\n),\n\nmonthly as (\n    select\n        date_month,\n        customer_segment,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 then 1 else 0 end) as starting_customers,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then 1 else 0 end) as churned_customers,\n        sum(coalesce(prev_mrr_amount, 0)) as starting_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then coalesce(prev_mrr_amount, 0) else 0 end) as churned_mrr\n    from with_prev\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_month_id,\n        date_month,\n        customer_segment,\n        starting_customers,\n        churned_customers,\n        case\n            when starting_customers = 0 then 0\n            else churned_customers::double / starting_customers\n        end as customer_churn_rate,\n        starting_mrr,\n        churned_mrr,\n        case\n            when starting_mrr = 0 then 0\n            else churned_mrr / starting_mrr\n        end as revenue_churn_rate\n    from monthly\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"churn_analysis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.521500Z", "completed_at": "2026-02-05T21:55:00.527808Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.529228Z", "completed_at": "2026-02-05T21:55:00.529236Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010396003723144531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.cohort_retention", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncohorts as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        date_trunc('month', c.signup_date) as cohort_month\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\" c\n),\n\ncohort_sizes as (\n    select\n        cohort_month,\n        customer_segment,\n        count(*) as cohort_customers\n    from cohorts\n    group by 1, 2\n),\n\ncustomer_month_spine as (\n    select\n        co.customer_id,\n        co.customer_segment,\n        co.cohort_month,\n        m.date_month\n    from cohorts co\n    join months m\n        on m.date_month >= co.cohort_month\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.cohort_month,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\nactive_customers as (\n    select\n        cohort_month,\n        customer_segment,\n        date_month,\n        datediff('month', cohort_month, date_month) as months_since_signup,\n        count(distinct case when mrr_amount > 0 then customer_id end) as active_customers\n    from customer_mrr\n    group by 1, 2, 3, 4\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(a.customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(a.cohort_month as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(a.months_since_signup as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as cohort_segment_period_id,\n        a.cohort_month,\n        a.customer_segment,\n        a.months_since_signup,\n        a.date_month as active_month,\n        s.cohort_customers,\n        a.active_customers,\n        case\n            when s.cohort_customers = 0 then 0\n            else a.active_customers::double / s.cohort_customers\n        end as retention_rate\n    from active_customers a\n    join cohort_sizes s\n        on a.cohort_month = s.cohort_month\n        and a.customer_segment = s.customer_segment\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"cohort_retention\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.533514Z", "completed_at": "2026-02-05T21:55:00.539515Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.540888Z", "completed_at": "2026-02-05T21:55:00.540896Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010111331939697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.mrr_analysis", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\ncustomer_month_spine as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        m.date_month\n    from customers c\n    cross join months m\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\ncustomer_mrr_with_prev as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        lag(mrr_amount) over (partition by customer_id order by date_month) as prev_mrr_amount\n    from customer_mrr\n),\n\nclassified as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        coalesce(prev_mrr_amount, 0) as prev_mrr_amount,\n        mrr_amount - coalesce(prev_mrr_amount, 0) as mrr_change,\n        case\n            when coalesce(prev_mrr_amount, 0) = 0 and mrr_amount > 0 then 'new'\n            when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then 'churn'\n            when mrr_amount > coalesce(prev_mrr_amount, 0) and coalesce(prev_mrr_amount, 0) > 0 then 'expansion'\n            when mrr_amount < coalesce(prev_mrr_amount, 0) and mrr_amount > 0 then 'contraction'\n            else 'no_change'\n        end as mrr_movement_type\n    from customer_mrr_with_prev\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_month_id,\n        date_month,\n        customer_segment,\n        sum(mrr_amount) as total_mrr,\n        sum(case when mrr_movement_type = 'new' then mrr_amount else 0 end) as new_mrr,\n        sum(case when mrr_movement_type = 'expansion' then mrr_change else 0 end) as expansion_mrr,\n        sum(case when mrr_movement_type = 'contraction' then abs(mrr_change) else 0 end) as contraction_mrr,\n        sum(case when mrr_movement_type = 'churn' then prev_mrr_amount else 0 end) as churned_mrr,\n        sum(case when mrr_movement_type in ('new', 'expansion') then mrr_change else 0 end)\n        - sum(case when mrr_movement_type in ('contraction', 'churn') then abs(mrr_change) else 0 end) as net_new_mrr\n    from classified\n    group by 1, 2, 3\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"mrr_analysis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.545070Z", "completed_at": "2026-02-05T21:55:00.552273Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.553682Z", "completed_at": "2026-02-05T21:55:00.553690Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011247873306274414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.net_revenue_retention", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\ncustomer_month_spine as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        m.date_month\n    from customers c\n    cross join months m\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\nwith_prev as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        lag(mrr_amount) over (partition by customer_id order by date_month) as prev_mrr_amount\n    from customer_mrr\n),\n\nmovement as (\n    select\n        date_month,\n        customer_segment,\n        sum(coalesce(prev_mrr_amount, 0)) as starting_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount > coalesce(prev_mrr_amount, 0) then mrr_amount - prev_mrr_amount else 0 end) as expansion_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount > 0 and mrr_amount < coalesce(prev_mrr_amount, 0) then prev_mrr_amount - mrr_amount else 0 end) as contraction_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then prev_mrr_amount else 0 end) as churned_mrr\n    from with_prev\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_month_id,\n        date_month,\n        customer_segment,\n        starting_mrr,\n        expansion_mrr,\n        contraction_mrr,\n        churned_mrr,\n        case\n            when starting_mrr = 0 then 0\n            else (starting_mrr + expansion_mrr - contraction_mrr - churned_mrr) / starting_mrr\n        end as net_revenue_retention,\n        case\n            when starting_mrr = 0 then 0\n            else (starting_mrr - contraction_mrr - churned_mrr) / starting_mrr\n        end as gross_revenue_retention\n    from movement\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"net_revenue_retention\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.557875Z", "completed_at": "2026-02-05T21:55:00.563710Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.565135Z", "completed_at": "2026-02-05T21:55:00.565143Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00991511344909668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_fct_monthly_recurring_revenue_mrr_amount__1000000__0.30bcc21edd", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.569233Z", "completed_at": "2026-02-05T21:55:00.574187Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.575534Z", "completed_at": "2026-02-05T21:55:00.575542Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008796215057373047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_customer_id.a66423ce4f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.579604Z", "completed_at": "2026-02-05T21:55:00.584437Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.585776Z", "completed_at": "2026-02-05T21:55:00.585784Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008801698684692383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_customer_month_id.b7a062ebbc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_month_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere customer_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.589911Z", "completed_at": "2026-02-05T21:55:00.595888Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.597279Z", "completed_at": "2026-02-05T21:55:00.597287Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00984048843383789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_date_month.8089d21391", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.601336Z", "completed_at": "2026-02-05T21:55:00.606253Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.607625Z", "completed_at": "2026-02-05T21:55:00.607633Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00879359245300293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_mrr_amount.4c2963d658", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.611726Z", "completed_at": "2026-02-05T21:55:00.617528Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.618910Z", "completed_at": "2026-02-05T21:55:00.618917Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009740591049194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_fct_monthly_recurring_revenue_customer_id__customer_id__ref_dim_customers_.09138f6532", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.623017Z", "completed_at": "2026-02-05T21:55:00.627881Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.629259Z", "completed_at": "2026-02-05T21:55:00.629267Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00873255729675293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_fct_monthly_recurring_revenue_customer_month_id.a9d2287217", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere customer_month_id is not null\ngroup by customer_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.633356Z", "completed_at": "2026-02-05T21:55:00.639551Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.640916Z", "completed_at": "2026-02-05T21:55:00.640924Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010164022445678711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_fct_subscriptions_billing_cycle__monthly__annual.f19036f213", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        billing_cycle as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    group by billing_cycle\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'monthly','annual'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.645044Z", "completed_at": "2026-02-05T21:55:00.650037Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.651410Z", "completed_at": "2026-02-05T21:55:00.651418Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008880853652954102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_fct_subscriptions_status__active__paused__churned__upgraded__downgraded.15fca4795f", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','paused','churned','upgraded','downgraded'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.655537Z", "completed_at": "2026-02-05T21:55:00.661015Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.662418Z", "completed_at": "2026-02-05T21:55:00.662426Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009494781494140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_fct_subscriptions_amount__1000000__0.21af0e0ca7", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and amount >= 0 and amount <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.666601Z", "completed_at": "2026-02-05T21:55:00.672183Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.673568Z", "completed_at": "2026-02-05T21:55:00.673575Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00957179069519043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_fct_subscriptions_mrr_amount__100000__0.b7f8e4f817", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.677738Z", "completed_at": "2026-02-05T21:55:00.682594Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.683923Z", "completed_at": "2026-02-05T21:55:00.683930Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008785247802734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_amount.77f80a5332", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.688049Z", "completed_at": "2026-02-05T21:55:00.694508Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.695911Z", "completed_at": "2026-02-05T21:55:00.695923Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010510921478271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_billing_cycle.0a7a17a18b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect billing_cycle\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere billing_cycle is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.700173Z", "completed_at": "2026-02-05T21:55:00.705636Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.707043Z", "completed_at": "2026-02-05T21:55:00.707055Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009678840637207031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_customer_id.ae33a3a9d8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.711452Z", "completed_at": "2026-02-05T21:55:00.716832Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.718230Z", "completed_at": "2026-02-05T21:55:00.718241Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009400129318237305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_mrr_amount.0b5f93cb94", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.722380Z", "completed_at": "2026-02-05T21:55:00.727886Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.729291Z", "completed_at": "2026-02-05T21:55:00.729303Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009459495544433594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_plan_id.07baa591b1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.733480Z", "completed_at": "2026-02-05T21:55:00.740689Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.742107Z", "completed_at": "2026-02-05T21:55:00.742119Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011195659637451172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_status.daa1b1fe34", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.746386Z", "completed_at": "2026-02-05T21:55:00.825279Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.826690Z", "completed_at": "2026-02-05T21:55:00.826705Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08310580253601074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_subscription_id.f690e778b1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.831062Z", "completed_at": "2026-02-05T21:55:00.837650Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.839083Z", "completed_at": "2026-02-05T21:55:00.839093Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010598182678222656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_fct_subscriptions_customer_id__customer_id__ref_dim_customers_.738b2dd4ca", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.843290Z", "completed_at": "2026-02-05T21:55:00.849721Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.851150Z", "completed_at": "2026-02-05T21:55:00.851160Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010423660278320312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_fct_subscriptions_plan_id__plan_id__ref_dim_plans_.09ecb91cb5", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select plan_id as from_field\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    where plan_id is not null\n),\n\nparent as (\n    select plan_id as to_field\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.855270Z", "completed_at": "2026-02-05T21:55:00.860361Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.861704Z", "completed_at": "2026-02-05T21:55:00.861713Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008929014205932617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_fct_subscriptions_subscription_id.71386a928a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.865806Z", "completed_at": "2026-02-05T21:55:00.872415Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.873820Z", "completed_at": "2026-02-05T21:55:00.873829Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010596036911010742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_subscription_periods_mrr_amount__100000__0.32396aeab0", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.877925Z", "completed_at": "2026-02-05T21:55:00.883088Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.884480Z", "completed_at": "2026-02-05T21:55:00.884488Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009060382843017578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_subscription_periods_customer_id.33a91ad17a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.888587Z", "completed_at": "2026-02-05T21:55:00.893650Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.895048Z", "completed_at": "2026-02-05T21:55:00.895057Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00899195671081543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_subscription_periods_mrr_amount.c3d6239f36", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.899234Z", "completed_at": "2026-02-05T21:55:00.904324Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.905671Z", "completed_at": "2026-02-05T21:55:00.905680Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00903010368347168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_subscription_periods_subscription_id.228100b7db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.909771Z", "completed_at": "2026-02-05T21:55:00.915774Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.917184Z", "completed_at": "2026-02-05T21:55:00.917192Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009915351867675781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_subscription_periods_customer_id__customer_id__ref_stg_customers_.d2a65dcd76", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.921300Z", "completed_at": "2026-02-05T21:55:00.927406Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.928752Z", "completed_at": "2026-02-05T21:55:00.928760Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010020971298217773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_subscription_periods_subscription_id.213d4156ea", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.932839Z", "completed_at": "2026-02-05T21:55:00.938390Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.939784Z", "completed_at": "2026-02-05T21:55:00.939792Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009510993957519531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_customer_health_score_health_score__100__0.0fbd6b513b", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and health_score >= 0 and health_score <= 100\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.943944Z", "completed_at": "2026-02-05T21:55:00.949338Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.950741Z", "completed_at": "2026-02-05T21:55:00.950749Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009386301040649414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_customer_health_score_payment_failure_rate_last_90d__1__0.7e1e7e5f41", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and payment_failure_rate_last_90d >= 0 and payment_failure_rate_last_90d <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.954867Z", "completed_at": "2026-02-05T21:55:00.959769Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.961142Z", "completed_at": "2026-02-05T21:55:00.961150Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008768558502197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_as_of_date.36d720fd53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect as_of_date\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere as_of_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.965228Z", "completed_at": "2026-02-05T21:55:00.971113Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.972464Z", "completed_at": "2026-02-05T21:55:00.972472Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009808063507080078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_customer_id.270547872f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.976708Z", "completed_at": "2026-02-05T21:55:00.981448Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.982816Z", "completed_at": "2026-02-05T21:55:00.982823Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008817195892333984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_health_score.f383d46da2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect health_score\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere health_score is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.986903Z", "completed_at": "2026-02-05T21:55:00.992054Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:00.993432Z", "completed_at": "2026-02-05T21:55:00.993440Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009019613265991211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_payment_failure_rate_last_90d.e26d5a38c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_failure_rate_last_90d\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere payment_failure_rate_last_90d is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:00.997537Z", "completed_at": "2026-02-05T21:55:01.003475Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.004875Z", "completed_at": "2026-02-05T21:55:01.004883Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00995016098022461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_customer_health_score_customer_id__customer_id__ref_stg_customers_.fe675ec61f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.009064Z", "completed_at": "2026-02-05T21:55:01.013845Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.015215Z", "completed_at": "2026-02-05T21:55:01.015223Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008747577667236328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_customer_health_score_customer_id.d7e00c064a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.019316Z", "completed_at": "2026-02-05T21:55:01.026021Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.027390Z", "completed_at": "2026-02-05T21:55:01.027398Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010671377182006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_monthly_usage_event_count__100000000__0.7fcfb98d27", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and event_count >= 0 and event_count <= 100000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.031538Z", "completed_at": "2026-02-05T21:55:01.037055Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.038445Z", "completed_at": "2026-02-05T21:55:01.038453Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009524345397949219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_monthly_usage_total_usage_quantity__1000000000__0.a3a21278a6", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and total_usage_quantity >= 0 and total_usage_quantity <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.042602Z", "completed_at": "2026-02-05T21:55:01.047392Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.048741Z", "completed_at": "2026-02-05T21:55:01.048749Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008699417114257812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_customer_id.9f5a52035d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.052826Z", "completed_at": "2026-02-05T21:55:01.057719Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.059099Z", "completed_at": "2026-02-05T21:55:01.059107Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008756875991821289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_customer_month_id.74f34aceba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_month_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere customer_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.063170Z", "completed_at": "2026-02-05T21:55:01.069123Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.070490Z", "completed_at": "2026-02-05T21:55:01.070498Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009935617446899414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_event_count.823f19e9a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_count\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere event_count is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.074747Z", "completed_at": "2026-02-05T21:55:01.079651Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.081023Z", "completed_at": "2026-02-05T21:55:01.081031Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008865594863891602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_total_usage_quantity.9c8d7d37db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_usage_quantity\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere total_usage_quantity is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.085115Z", "completed_at": "2026-02-05T21:55:01.090094Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.091451Z", "completed_at": "2026-02-05T21:55:01.091459Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008835315704345703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_usage_month.5593c46a18", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect usage_month\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere usage_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.095593Z", "completed_at": "2026-02-05T21:55:01.101560Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.102941Z", "completed_at": "2026-02-05T21:55:01.102949Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010005474090576172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_monthly_usage_customer_id__customer_id__ref_stg_customers_.46c0ada6b9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.107048Z", "completed_at": "2026-02-05T21:55:01.111867Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.113238Z", "completed_at": "2026-02-05T21:55:01.113246Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008681535720825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_monthly_usage_customer_month_id.50e00ffb9c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere customer_month_id is not null\ngroup by customer_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.117314Z", "completed_at": "2026-02-05T21:55:01.124631Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.126056Z", "completed_at": "2026-02-05T21:55:01.126064Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011309623718261719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.customer_lifetime_value", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n    where date_month >= '2022-06-01'  -- Start after 6 months of data exists\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\nmrr as (\n    select\n        customer_id,\n        date_month,\n        mrr_amount\n    from \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\n),\n\nchurn as (\n    select\n        date_month,\n        customer_segment,\n        customer_churn_rate\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n),\n\n-- For each as_of_month, calculate ARPU using trailing 6 months\nsegment_arpu_by_month as (\n    select\n        m.date_month as as_of_month,\n        c.customer_segment,\n        avg(case when mrr.mrr_amount > 0 then mrr.mrr_amount end) as arpu\n    from months m\n    cross join customers c\n    left join mrr\n        on c.customer_id = mrr.customer_id\n        and mrr.date_month > m.date_month - interval 6 month\n        and mrr.date_month <= m.date_month\n    group by 1, 2\n),\n\n-- For each as_of_month, calculate avg churn using trailing 6 months\nsegment_churn_by_month as (\n    select\n        m.date_month as as_of_month,\n        ch.customer_segment,\n        avg(ch.customer_churn_rate) as avg_monthly_customer_churn_rate\n    from months m\n    join churn ch\n        on ch.date_month > m.date_month - interval 6 month\n        and ch.date_month <= m.date_month\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(a.as_of_month as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(coalesce(a.customer_segment, ch.customer_segment) as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_as_of_id,\n        a.as_of_month,\n        coalesce(a.customer_segment, ch.customer_segment) as customer_segment,\n        coalesce(a.arpu, 0) as arpu,\n        coalesce(ch.avg_monthly_customer_churn_rate, 0) as avg_monthly_customer_churn_rate,\n        case\n            when coalesce(ch.avg_monthly_customer_churn_rate, 0) = 0 then null\n            else least(120, 1.0 / ch.avg_monthly_customer_churn_rate)\n        end as expected_lifetime_months,\n        case\n            when coalesce(ch.avg_monthly_customer_churn_rate, 0) = 0 then null\n            else coalesce(a.arpu, 0) * least(120, 1.0 / ch.avg_monthly_customer_churn_rate)\n        end as lifetime_value\n    from segment_arpu_by_month a\n    full outer join segment_churn_by_month ch\n        on a.as_of_month = ch.as_of_month\n        and a.customer_segment = ch.customer_segment\n    where coalesce(a.as_of_month, ch.as_of_month) is not null\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"customer_lifetime_value\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.130264Z", "completed_at": "2026-02-05T21:55:01.135874Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.137301Z", "completed_at": "2026-02-05T21:55:01.137309Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009737968444824219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_churn_analysis_customer_segment__smb__mid_market__enterprise__unknown.12ff3b906a", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.141416Z", "completed_at": "2026-02-05T21:55:01.145111Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.146474Z", "completed_at": "2026-02-05T21:55:01.146481Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007621049880981445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.churn_rate_sanity", "compiled": true, "compiled_code": "\n\nselect\n    date_month,\n    customer_segment,\n    customer_churn_rate,\n    starting_customers,\n    churned_customers,\n    'Churn rate exceeds 50% - likely data issue' as failure_reason\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere customer_churn_rate > 0.50\n  and starting_customers > 10  -- Only flag if meaningful sample size", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.150570Z", "completed_at": "2026-02-05T21:55:01.156095Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.157479Z", "completed_at": "2026-02-05T21:55:01.157487Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009496688842773438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_churned_customers__1000000000__0.ecf0d4d6a8", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and churned_customers >= 0 and churned_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.161676Z", "completed_at": "2026-02-05T21:55:01.168326Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.169790Z", "completed_at": "2026-02-05T21:55:01.169799Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010629653930664062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_customer_churn_rate__1__0.a3521c9c86", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and customer_churn_rate >= 0 and customer_churn_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.173910Z", "completed_at": "2026-02-05T21:55:01.179429Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.181100Z", "completed_at": "2026-02-05T21:55:01.181108Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00977945327758789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_revenue_churn_rate__1__0.ca578782ea", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and revenue_churn_rate >= 0 and revenue_churn_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.185315Z", "completed_at": "2026-02-05T21:55:01.190825Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.192254Z", "completed_at": "2026-02-05T21:55:01.192262Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009528160095214844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_starting_customers__1000000000__0.434546e5eb", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and starting_customers >= 0 and starting_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.196462Z", "completed_at": "2026-02-05T21:55:01.201556Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.202904Z", "completed_at": "2026-02-05T21:55:01.202914Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009086132049560547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_churned_customers.8445fc5f8a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect churned_customers\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere churned_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.207044Z", "completed_at": "2026-02-05T21:55:01.213739Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.215127Z", "completed_at": "2026-02-05T21:55:01.215136Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010923147201538086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_customer_churn_rate.b2257552ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_churn_rate\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere customer_churn_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.219753Z", "completed_at": "2026-02-05T21:55:01.224983Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.226347Z", "completed_at": "2026-02-05T21:55:01.226356Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009172201156616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_customer_segment.f82e1dbd2a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.230480Z", "completed_at": "2026-02-05T21:55:01.235679Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.237088Z", "completed_at": "2026-02-05T21:55:01.237097Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009226799011230469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_date_month.aeceb24cdf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.241176Z", "completed_at": "2026-02-05T21:55:01.246256Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.247625Z", "completed_at": "2026-02-05T21:55:01.247634Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008957862854003906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_revenue_churn_rate.f68037cf43", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect revenue_churn_rate\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere revenue_churn_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.251727Z", "completed_at": "2026-02-05T21:55:01.256649Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.258018Z", "completed_at": "2026-02-05T21:55:01.258027Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00881052017211914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_segment_month_id.face7d9329", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_month_id\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere segment_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.262140Z", "completed_at": "2026-02-05T21:55:01.268502Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.269843Z", "completed_at": "2026-02-05T21:55:01.269851Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010227680206298828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_starting_customers.5eb8964198", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect starting_customers\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere starting_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.273942Z", "completed_at": "2026-02-05T21:55:01.278700Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.280080Z", "completed_at": "2026-02-05T21:55:01.280088Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008690118789672852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_churn_analysis_segment_month_id.d17ebe9d07", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere segment_month_id is not null\ngroup by segment_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.284254Z", "completed_at": "2026-02-05T21:55:01.289405Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.290771Z", "completed_at": "2026-02-05T21:55:01.290779Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009131193161010742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_cohort_retention_customer_segment__smb__mid_market__enterprise__unknown.537731c238", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.294913Z", "completed_at": "2026-02-05T21:55:01.300519Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.301902Z", "completed_at": "2026-02-05T21:55:01.301910Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009562969207763672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_active_customers__1000000000__0.c41f1ccb43", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and active_customers >= 0 and active_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.306087Z", "completed_at": "2026-02-05T21:55:01.312841Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.314216Z", "completed_at": "2026-02-05T21:55:01.314224Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010720968246459961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_cohort_customers__1000000000__0.3ded49037c", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and cohort_customers >= 0 and cohort_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.318348Z", "completed_at": "2026-02-05T21:55:01.323724Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.325223Z", "completed_at": "2026-02-05T21:55:01.325231Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009500503540039062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_months_since_signup__120__0.3abf594756", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and months_since_signup >= 0 and months_since_signup <= 120\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.329417Z", "completed_at": "2026-02-05T21:55:01.334869Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.336265Z", "completed_at": "2026-02-05T21:55:01.336273Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009380817413330078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_retention_rate__1__0.75ce1e0e47", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and retention_rate >= 0 and retention_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.340410Z", "completed_at": "2026-02-05T21:55:01.345348Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.346698Z", "completed_at": "2026-02-05T21:55:01.346706Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008917570114135742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_active_customers.f50b652fd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect active_customers\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere active_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.350794Z", "completed_at": "2026-02-05T21:55:01.355679Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.357044Z", "completed_at": "2026-02-05T21:55:01.357052Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008791923522949219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_cohort_customers.37da0ff420", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_customers\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.361119Z", "completed_at": "2026-02-05T21:55:01.367307Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.368650Z", "completed_at": "2026-02-05T21:55:01.368658Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010018110275268555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_cohort_month.0e607e02af", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_month\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.372617Z", "completed_at": "2026-02-05T21:55:01.377640Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.379080Z", "completed_at": "2026-02-05T21:55:01.379088Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008950471878051758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_cohort_segment_period_id.0d29ee4706", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_segment_period_id\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_segment_period_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.383234Z", "completed_at": "2026-02-05T21:55:01.388007Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.389356Z", "completed_at": "2026-02-05T21:55:01.389364Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008722543716430664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_customer_segment.c697b5eb0e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.393446Z", "completed_at": "2026-02-05T21:55:01.398315Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.399664Z", "completed_at": "2026-02-05T21:55:01.399673Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00878763198852539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_months_since_signup.41d00203f4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect months_since_signup\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere months_since_signup is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.403761Z", "completed_at": "2026-02-05T21:55:01.409877Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.411264Z", "completed_at": "2026-02-05T21:55:01.411272Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010058403015136719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_retention_rate.8166dc37e8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect retention_rate\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere retention_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.415351Z", "completed_at": "2026-02-05T21:55:01.420032Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.421384Z", "completed_at": "2026-02-05T21:55:01.421392Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008713006973266602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_cohort_retention_cohort_segment_period_id.5afcaa3a16", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    cohort_segment_period_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_segment_period_id is not null\ngroup by cohort_segment_period_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.425599Z", "completed_at": "2026-02-05T21:55:01.430761Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.432168Z", "completed_at": "2026-02-05T21:55:01.432177Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009103059768676758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_mrr_analysis_customer_segment__smb__mid_market__enterprise__unknown.1257e5343c", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.436339Z", "completed_at": "2026-02-05T21:55:01.441922Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.443334Z", "completed_at": "2026-02-05T21:55:01.443342Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009619712829589844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_mrr_analysis_churned_mrr__1000000000__0.5cafc45ab5", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and churned_mrr >= 0 and churned_mrr <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.447526Z", "completed_at": "2026-02-05T21:55:01.452999Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.454384Z", "completed_at": "2026-02-05T21:55:01.454392Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009498119354248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_mrr_analysis_new_mrr__1000000000__0.1d1f2a56be", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and new_mrr >= 0 and new_mrr <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.458558Z", "completed_at": "2026-02-05T21:55:01.465511Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.466900Z", "completed_at": "2026-02-05T21:55:01.466908Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010966062545776367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_mrr_analysis_total_mrr__1000000000__0.03c10ae006", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and total_mrr >= 0 and total_mrr <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.471101Z", "completed_at": "2026-02-05T21:55:01.474742Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.476118Z", "completed_at": "2026-02-05T21:55:01.476126Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007631778717041016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.mrr_month_over_month_sanity", "compiled": true, "compiled_code": "\n\nwith monthly_mrr as (\n    select\n        date_month,\n        sum(total_mrr) as total_mrr\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    group by date_month\n),\n\nmrr_changes as (\n    select\n        date_month,\n        total_mrr,\n        lag(total_mrr) over (order by date_month) as prior_month_mrr,\n        case\n            when lag(total_mrr) over (order by date_month) = 0 then 0\n            else (total_mrr - lag(total_mrr) over (order by date_month)) \n                 / lag(total_mrr) over (order by date_month)\n        end as pct_change\n    from monthly_mrr\n)\n\nselect\n    date_month,\n    total_mrr,\n    prior_month_mrr,\n    pct_change,\n    'MRR dropped more than 20% month-over-month' as failure_reason\nfrom mrr_changes\nwhere pct_change < -0.20\n  and prior_month_mrr > 0  -- Only flag if there was prior MRR to compare against", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.480193Z", "completed_at": "2026-02-05T21:55:01.485051Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.486406Z", "completed_at": "2026-02-05T21:55:01.486413Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008789300918579102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_churned_mrr.a3d399ce96", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect churned_mrr\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere churned_mrr is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.490528Z", "completed_at": "2026-02-05T21:55:01.495514Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.496860Z", "completed_at": "2026-02-05T21:55:01.496868Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008907556533813477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_customer_segment.c66caf3809", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.500926Z", "completed_at": "2026-02-05T21:55:01.505763Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.507136Z", "completed_at": "2026-02-05T21:55:01.507144Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008745908737182617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_date_month.b31589f01e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.511178Z", "completed_at": "2026-02-05T21:55:01.517443Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.518795Z", "completed_at": "2026-02-05T21:55:01.518803Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010188817977905273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_new_mrr.7bd7ba8daa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect new_mrr\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere new_mrr is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.522881Z", "completed_at": "2026-02-05T21:55:01.527796Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.529191Z", "completed_at": "2026-02-05T21:55:01.529199Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008763551712036133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_segment_month_id.96b64accac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_month_id\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere segment_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.533267Z", "completed_at": "2026-02-05T21:55:01.538114Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.539469Z", "completed_at": "2026-02-05T21:55:01.539477Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00876617431640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_total_mrr.80e9772030", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_mrr\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere total_mrr is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.543550Z", "completed_at": "2026-02-05T21:55:01.548334Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.549695Z", "completed_at": "2026-02-05T21:55:01.549711Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008710384368896484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_mrr_analysis_segment_month_id.73b748be94", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere segment_month_id is not null\ngroup by segment_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.553799Z", "completed_at": "2026-02-05T21:55:01.559991Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.561371Z", "completed_at": "2026-02-05T21:55:01.561379Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010070562362670898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_net_revenue_retention_customer_segment__smb__mid_market__enterprise__unknown.bad1f7855d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.565489Z", "completed_at": "2026-02-05T21:55:01.570826Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.572244Z", "completed_at": "2026-02-05T21:55:01.572252Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009348154067993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_net_revenue_retention_gross_revenue_retention__1__0.069667a4ae", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and gross_revenue_retention >= 0 and gross_revenue_retention <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.576514Z", "completed_at": "2026-02-05T21:55:01.581943Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.583340Z", "completed_at": "2026-02-05T21:55:01.583348Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009462118148803711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_net_revenue_retention_net_revenue_retention__5__0.02505b257b", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and net_revenue_retention >= 0 and net_revenue_retention <= 5\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.587452Z", "completed_at": "2026-02-05T21:55:01.592435Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.593797Z", "completed_at": "2026-02-05T21:55:01.593804Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00892186164855957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_customer_segment.a64b766957", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.597893Z", "completed_at": "2026-02-05T21:55:01.602764Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.604154Z", "completed_at": "2026-02-05T21:55:01.604162Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008759498596191406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_date_month.8b7a8fb0c8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.609731Z", "completed_at": "2026-02-05T21:55:01.614489Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.615838Z", "completed_at": "2026-02-05T21:55:01.615847Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010171175003051758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_gross_revenue_retention.11b3e16b67", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect gross_revenue_retention\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere gross_revenue_retention is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.619908Z", "completed_at": "2026-02-05T21:55:01.624800Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.626195Z", "completed_at": "2026-02-05T21:55:01.626204Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008771181106567383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_net_revenue_retention.8a6d154e31", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect net_revenue_retention\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere net_revenue_retention is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.630257Z", "completed_at": "2026-02-05T21:55:01.635190Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.636560Z", "completed_at": "2026-02-05T21:55:01.636568Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00886845588684082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_segment_month_id.64a6b596d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_month_id\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere segment_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.640667Z", "completed_at": "2026-02-05T21:55:01.645381Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.646715Z", "completed_at": "2026-02-05T21:55:01.646723Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008597612380981445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_net_revenue_retention_segment_month_id.cc84fd260d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere segment_month_id is not null\ngroup by segment_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.650771Z", "completed_at": "2026-02-05T21:55:01.657732Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.659137Z", "completed_at": "2026-02-05T21:55:01.659146Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01089024543762207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.unit_economics", "compiled": true, "compiled_code": "with ltv as (\n    select\n        as_of_month,\n        customer_segment,\n        arpu,\n        avg_monthly_customer_churn_rate,\n        expected_lifetime_months,\n        lifetime_value\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n),\n\nwith_cac as (\n    select\n        as_of_month,\n        customer_segment,\n        arpu,\n        avg_monthly_customer_churn_rate,\n        expected_lifetime_months,\n        lifetime_value,\n        case\n            when customer_segment = 'smb' then 600\n            when customer_segment = 'mid-market' then 2500\n            when customer_segment = 'enterprise' then 12000\n            else null\n        end as assumed_cac\n    from ltv\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(as_of_month as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_as_of_id,\n        as_of_month,\n        customer_segment,\n        arpu,\n        avg_monthly_customer_churn_rate,\n        expected_lifetime_months,\n        lifetime_value,\n        assumed_cac,\n        case\n            when assumed_cac is null or assumed_cac = 0 then null\n            else lifetime_value / assumed_cac\n        end as ltv_to_cac_ratio,\n        case\n            when arpu is null or arpu = 0 or assumed_cac is null then null\n            else assumed_cac / arpu\n        end as payback_months\n    from with_cac\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"unit_economics\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.663318Z", "completed_at": "2026-02-05T21:55:01.668539Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.670137Z", "completed_at": "2026-02-05T21:55:01.670147Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009542465209960938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_customer_lifetime_value_customer_segment__smb__mid_market__enterprise__unknown.d1b95c9570", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.674348Z", "completed_at": "2026-02-05T21:55:01.679672Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.681076Z", "completed_at": "2026-02-05T21:55:01.681084Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00934743881225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_arpu__1000000__0.149ff1813f", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and arpu >= 0 and arpu <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.685242Z", "completed_at": "2026-02-05T21:55:01.690699Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.692103Z", "completed_at": "2026-02-05T21:55:01.692112Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009401082992553711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_avg_monthly_customer_churn_rate__1__0.02204de856", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and avg_monthly_customer_churn_rate >= 0 and avg_monthly_customer_churn_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.696279Z", "completed_at": "2026-02-05T21:55:01.703355Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.704739Z", "completed_at": "2026-02-05T21:55:01.704746Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011034011840820312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_expected_lifetime_months__120__0__expected_lifetime_months_is_not_null.5d159b06eb", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and expected_lifetime_months >= 0 and expected_lifetime_months <= 120\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    where\n        expected_lifetime_months is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.708886Z", "completed_at": "2026-02-05T21:55:01.714904Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.716348Z", "completed_at": "2026-02-05T21:55:01.716356Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010059833526611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_lifetime_value__1000000000__0__lifetime_value_is_not_null.1e26703122", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and lifetime_value >= 0 and lifetime_value <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    where\n        lifetime_value is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.720517Z", "completed_at": "2026-02-05T21:55:01.725295Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.726649Z", "completed_at": "2026-02-05T21:55:01.726656Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008780241012573242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_arpu.68cf958b17", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect arpu\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere arpu is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.730817Z", "completed_at": "2026-02-05T21:55:01.735713Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.737110Z", "completed_at": "2026-02-05T21:55:01.737118Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008821725845336914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_as_of_month.2440beb6c2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect as_of_month\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere as_of_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.741226Z", "completed_at": "2026-02-05T21:55:01.746432Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.747810Z", "completed_at": "2026-02-05T21:55:01.747818Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009129762649536133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_avg_monthly_customer_churn_rate.1d3497b679", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_monthly_customer_churn_rate\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere avg_monthly_customer_churn_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.751974Z", "completed_at": "2026-02-05T21:55:01.758054Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.759403Z", "completed_at": "2026-02-05T21:55:01.759411Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010027647018432617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_customer_segment.77e1bf04e8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.763500Z", "completed_at": "2026-02-05T21:55:01.768389Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.769757Z", "completed_at": "2026-02-05T21:55:01.769765Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008835315704345703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_segment_as_of_id.6b96a69161", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_as_of_id\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere segment_as_of_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.773853Z", "completed_at": "2026-02-05T21:55:01.778578Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.779925Z", "completed_at": "2026-02-05T21:55:01.779933Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008611202239990234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_customer_lifetime_value_segment_as_of_id.c8b6e3f3fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_as_of_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere segment_as_of_id is not null\ngroup by segment_as_of_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.784044Z", "completed_at": "2026-02-05T21:55:01.789937Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.791348Z", "completed_at": "2026-02-05T21:55:01.791356Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009899139404296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_unit_economics_assumed_cac__1000000000__0__assumed_cac_is_not_null.0593deb695", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and assumed_cac >= 0 and assumed_cac <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"unit_economics\"\n    where\n        assumed_cac is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.795539Z", "completed_at": "2026-02-05T21:55:01.802635Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.804045Z", "completed_at": "2026-02-05T21:55:01.804055Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011127233505249023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_unit_economics_ltv_to_cac_ratio__1000__0__ltv_to_cac_ratio_is_not_null.d76c1f7ce7", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and ltv_to_cac_ratio >= 0 and ltv_to_cac_ratio <= 1000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"unit_economics\"\n    where\n        ltv_to_cac_ratio is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.808194Z", "completed_at": "2026-02-05T21:55:01.814325Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.815716Z", "completed_at": "2026-02-05T21:55:01.815724Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010142803192138672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_unit_economics_payback_months__120__0__payback_months_is_not_null.77c8663847", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and payback_months >= 0 and payback_months <= 120\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"unit_economics\"\n    where\n        payback_months is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.819845Z", "completed_at": "2026-02-05T21:55:01.824748Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.826183Z", "completed_at": "2026-02-05T21:55:01.826192Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008904695510864258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_unit_economics_segment_as_of_id.1d127f6ec4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_as_of_id\nfrom \"saas_analytics\".\"main_marts\".\"unit_economics\"\nwhere segment_as_of_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:55:01.830304Z", "completed_at": "2026-02-05T21:55:01.835254Z"}, {"name": "execute", "started_at": "2026-02-05T21:55:01.836599Z", "completed_at": "2026-02-05T21:55:01.836608Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00880742073059082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_unit_economics_segment_as_of_id.5d713df7b9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_as_of_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"unit_economics\"\nwhere segment_as_of_id is not null\ngroup by segment_as_of_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 2.8882904052734375, "args": {"exclude": [], "project_dir": "/home/runner/work/saas-analytics-quality/saas-analytics-quality/dbt_project", "cache_selected_only": false, "log_format_file": "debug", "populate_cache": true, "warn_error_options": {"include": [], "exclude": []}, "macro_debugging": false, "enable_legacy_logger": false, "log_file_max_bytes": 10485760, "strict_mode": false, "empty_catalog": false, "favor_state": false, "compile": true, "show_resource_report": false, "defer": false, "partial_parse": true, "print": true, "indirect_selection": "eager", "log_path": "/home/runner/work/saas-analytics-quality/saas-analytics-quality/dbt_project/logs", "invocation_command": "dbt docs generate", "send_anonymous_usage_stats": true, "log_level": "info", "printer_width": 80, "select": [], "write_json": true, "partial_parse_file_diff": true, "introspect": true, "profiles_dir": ".", "use_colors_file": true, "vars": {}, "quiet": false, "use_colors": true, "version_check": true, "static": false, "static_parser": true, "log_format": "default", "log_level_file": "debug", "which": "generate"}}