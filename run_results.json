{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.0", "generated_at": "2026-02-02T03:31:52.455478Z", "invocation_id": "5af696de-3ae3-4e0f-a081-6d6b1ae8b664", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:49.756708Z", "completed_at": "2026-02-02T03:31:49.807111Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:49.808542Z", "completed_at": "2026-02-02T03:31:49.808556Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05713486671447754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.dim_dates", "compiled": true, "compiled_code": "with date_spine as (\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 1095\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    cast('2022-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast('2024-12-31' as date)\n\n)\n\nselect * from filtered\n\n\n),\n\nfinal as (\n    select\n        cast(date_day as date) as date_day,\n        date_trunc('month', date_day) as date_month,\n        extract(year from date_day) as year,\n        extract(quarter from date_day) as quarter,\n        extract(month from date_day) as month,\n        extract(day from date_day) as day_of_month,\n        extract(dow from date_day) as day_of_week,\n        case when extract(dow from date_day) in (0, 6) then true else false end as is_weekend\n    from date_spine\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"dim_dates\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:49.815754Z", "completed_at": "2026-02-02T03:31:49.819755Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:49.821152Z", "completed_at": "2026-02-02T03:31:49.821159Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008211851119995117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_customers", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"customers\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by customer_id\n            order by updated_at desc nulls last, created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(customer_id as integer) as customer_id,\n        lower(trim(email)) as email,\n        trim(company_name) as company_name,\n        cast(signup_date as date) as signup_date,\n        cast(end_date as date) as end_date,\n        lower(trim(account_status)) as account_status,\n        trim(industry) as industry,\n        trim(company_size) as company_size,\n        trim(country) as country,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:49.825487Z", "completed_at": "2026-02-02T03:31:49.829165Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:49.830515Z", "completed_at": "2026-02-02T03:31:49.830521Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007728099822998047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_payments", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"payments\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by payment_id\n            order by created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(payment_id as integer) as payment_id,\n        cast(subscription_id as integer) as subscription_id,\n        cast(payment_date as date) as payment_date,\n        cast(amount as double) as amount,\n        lower(trim(status)) as status,\n        lower(trim(payment_method)) as payment_method,\n        cast(created_at as timestamp) as created_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_payments\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:49.834943Z", "completed_at": "2026-02-02T03:31:49.839449Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:49.840782Z", "completed_at": "2026-02-02T03:31:49.840789Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008432626724243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_plans", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"plans\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by plan_id\n            order by created_date desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(plan_id as integer) as plan_id,\n        trim(plan_name) as plan_name,\n        lower(trim(plan_tier)) as plan_tier,\n        cast(base_price_monthly as double) as base_price_monthly,\n        cast(base_price_annual as double) as base_price_annual,\n        trim(features) as features,\n        cast(max_users as integer) as max_users,\n        cast(created_date as date) as created_date\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_plans\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:49.845108Z", "completed_at": "2026-02-02T03:31:49.848803Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:49.850171Z", "completed_at": "2026-02-02T03:31:49.850178Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0075490474700927734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_subscriptions", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"subscriptions\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by subscription_id\n            order by updated_at desc nulls last, created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(subscription_id as integer) as subscription_id,\n        cast(customer_id as integer) as customer_id,\n        cast(plan_id as integer) as plan_id,\n        cast(start_date as date) as start_date,\n        cast(end_date as date) as end_date,\n        lower(trim(status)) as status,\n        cast(mrr_amount as double) as mrr_amount,\n        lower(trim(billing_cycle)) as billing_cycle,\n        cast(amount as double) as amount,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_subscriptions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:49.854599Z", "completed_at": "2026-02-02T03:31:49.858167Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:49.859525Z", "completed_at": "2026-02-02T03:31:49.859531Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0073926448822021484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_support_tickets", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"support_tickets\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by ticket_id\n            order by created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(ticket_id as integer) as ticket_id,\n        cast(customer_id as integer) as customer_id,\n        cast(created_date as date) as created_date,\n        cast(resolved_date as date) as resolved_date,\n        lower(trim(category)) as category,\n        lower(trim(priority)) as priority,\n        cast(satisfaction_score as integer) as satisfaction_score,\n        cast(created_at as timestamp) as created_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_support_tickets\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:49.863996Z", "completed_at": "2026-02-02T03:31:49.867560Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:49.868901Z", "completed_at": "2026-02-02T03:31:49.868907Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007409572601318359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_usage_events", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"usage_events\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by event_id\n            order by created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(event_id as integer) as event_id,\n        cast(customer_id as integer) as customer_id,\n        cast(event_date as date) as event_date,\n        lower(trim(event_type)) as event_type,\n        cast(usage_quantity as integer) as usage_quantity,\n        cast(created_at as timestamp) as created_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_usage_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:49.873278Z", "completed_at": "2026-02-02T03:31:49.887744Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:49.889135Z", "completed_at": "2026-02-02T03:31:49.889142Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018368005752563477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_customers_customer_id.b4eeb23995", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main\".\"customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:49.893203Z", "completed_at": "2026-02-02T03:31:49.898019Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:49.899383Z", "completed_at": "2026-02-02T03:31:49.899390Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008665084838867188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_payments_payment_id.3057b24598", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_id\nfrom \"saas_analytics\".\"main\".\"payments\"\nwhere payment_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:49.903428Z", "completed_at": "2026-02-02T03:31:49.908324Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:49.909692Z", "completed_at": "2026-02-02T03:31:49.909698Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008713483810424805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_plans_plan_id.60ea0c3f70", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main\".\"plans\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:49.913778Z", "completed_at": "2026-02-02T03:31:49.918729Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:49.920120Z", "completed_at": "2026-02-02T03:31:49.920127Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008809566497802734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_subscriptions_subscription_id.d38f0dcd3e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main\".\"subscriptions\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:49.924266Z", "completed_at": "2026-02-02T03:31:49.929153Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:49.930512Z", "completed_at": "2026-02-02T03:31:49.930518Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008829355239868164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_support_tickets_ticket_id.f5e0ca9687", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"saas_analytics\".\"main\".\"support_tickets\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:49.934622Z", "completed_at": "2026-02-02T03:31:49.940669Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:49.942064Z", "completed_at": "2026-02-02T03:31:49.942071Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009897470474243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_usage_events_event_id.6b4882f73b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"saas_analytics\".\"main\".\"usage_events\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:49.946113Z", "completed_at": "2026-02-02T03:31:49.955477Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:49.956869Z", "completed_at": "2026-02-02T03:31:49.956876Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013285398483276367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_payments_subscription_id__subscription_id__source_raw_saas_subscriptions_.eec6fd2df4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select subscription_id as from_field\n    from \"saas_analytics\".\"main\".\"payments\"\n    where subscription_id is not null\n),\n\nparent as (\n    select subscription_id as to_field\n    from \"saas_analytics\".\"main\".\"subscriptions\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:49.961019Z", "completed_at": "2026-02-02T03:31:49.967296Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:49.968653Z", "completed_at": "2026-02-02T03:31:49.968660Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010129690170288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_subscriptions_customer_id__customer_id__source_raw_saas_customers_.d9d2470757", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main\".\"subscriptions\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main\".\"customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:49.972744Z", "completed_at": "2026-02-02T03:31:49.978608Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:49.979988Z", "completed_at": "2026-02-02T03:31:49.979995Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009772300720214844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_support_tickets_customer_id__customer_id__source_raw_saas_customers_.558da46c8f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main\".\"support_tickets\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main\".\"customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:49.984083Z", "completed_at": "2026-02-02T03:31:49.991136Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:49.992519Z", "completed_at": "2026-02-02T03:31:49.992525Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010969400405883789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_usage_events_customer_id__customer_id__source_raw_saas_customers_.edd5bda594", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main\".\"usage_events\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main\".\"customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:49.996672Z", "completed_at": "2026-02-02T03:31:50.003925Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.005340Z", "completed_at": "2026-02-02T03:31:50.005348Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011171102523803711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_customers_customer_id.5e4b5bfe1e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.009536Z", "completed_at": "2026-02-02T03:31:50.014457Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.015815Z", "completed_at": "2026-02-02T03:31:50.015821Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008895397186279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_payments_payment_id.3ce97338e8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    payment_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"payments\"\nwhere payment_id is not null\ngroup by payment_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.019931Z", "completed_at": "2026-02-02T03:31:50.024731Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.026102Z", "completed_at": "2026-02-02T03:31:50.026108Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008742332458496094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_plans_plan_id.1874d4258c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    plan_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"plans\"\nwhere plan_id is not null\ngroup by plan_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.030337Z", "completed_at": "2026-02-02T03:31:50.035131Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.036504Z", "completed_at": "2026-02-02T03:31:50.036510Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008795022964477539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_subscriptions_subscription_id.f107c8e56a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"subscriptions\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.040730Z", "completed_at": "2026-02-02T03:31:50.046736Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.048169Z", "completed_at": "2026-02-02T03:31:50.048176Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009968996047973633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_support_tickets_ticket_id.590438c9f6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"support_tickets\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.052304Z", "completed_at": "2026-02-02T03:31:50.057144Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.058511Z", "completed_at": "2026-02-02T03:31:50.058519Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008739233016967773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_usage_events_event_id.e76df55de9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"usage_events\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.062633Z", "completed_at": "2026-02-02T03:31:50.067637Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.069049Z", "completed_at": "2026-02-02T03:31:50.069056Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008904695510864258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_dates_date_day.1717af99fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"saas_analytics\".\"main_marts\".\"dim_dates\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.073195Z", "completed_at": "2026-02-02T03:31:50.078132Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.079528Z", "completed_at": "2026-02-02T03:31:50.079534Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008925437927246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_dates_date_month.8043b8f3cb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"dim_dates\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.083685Z", "completed_at": "2026-02-02T03:31:50.088437Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.089798Z", "completed_at": "2026-02-02T03:31:50.089805Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008675098419189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_dim_dates_date_day.5e9dfa95c7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_day as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"dim_dates\"\nwhere date_day is not null\ngroup by date_day\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.093872Z", "completed_at": "2026-02-02T03:31:50.098741Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.100149Z", "completed_at": "2026-02-02T03:31:50.100155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008748769760131836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.dim_customers", "compiled": true, "compiled_code": "with customers as (\n    select\n        customer_id,\n        email,\n        company_name,\n        industry,\n        company_size,\n        country,\n        signup_date,\n        end_date,\n        account_status\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n),\n\nfinal as (\n    select\n        customer_id,\n        email,\n        company_name,\n        industry,\n        company_size,\n        case\n            when lower(company_size) = 'small' then 'smb'\n            when lower(company_size) = 'medium' then 'mid-market'\n            when lower(company_size) = 'large' then 'enterprise'\n            else 'unknown'\n        end as customer_segment,\n        country,\n        signup_date,\n        end_date as churn_date,\n        account_status,\n        case when account_status = 'active' then true else false end as is_active\n    from customers\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"dim_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.104463Z", "completed_at": "2026-02-02T03:31:50.107942Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.109331Z", "completed_at": "2026-02-02T03:31:50.109337Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0076558589935302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_customer_cohorts", "compiled": true, "compiled_code": "with customers as (\n    select\n        customer_id,\n        signup_date\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n),\n\nfinal as (\n    select\n        customer_id,\n        date_trunc('month', signup_date) as cohort_month\n    from customers\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.113594Z", "completed_at": "2026-02-02T03:31:50.123306Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.124700Z", "completed_at": "2026-02-02T03:31:50.124707Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013636112213134766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_customers_account_status__active__churned.4ba2500c79", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        account_status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n    group by account_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','churned'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.128906Z", "completed_at": "2026-02-02T03:31:50.147798Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.149254Z", "completed_at": "2026-02-02T03:31:50.149261Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02288961410522461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_match_regex_stg_customers_email___a_zA_Z0_9__a_zA_Z0_9_a_zA_Z0_9_.796c35c3c5", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \n\nregexp_matches(email, '^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$', '')\n\n\n > 0\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.153443Z", "completed_at": "2026-02-02T03:31:50.159287Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.160665Z", "completed_at": "2026-02-02T03:31:50.160672Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009831905364990234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_account_status.d9b1d833ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_status\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere account_status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.164836Z", "completed_at": "2026-02-02T03:31:50.169748Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.171159Z", "completed_at": "2026-02-02T03:31:50.171166Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008828401565551758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.175303Z", "completed_at": "2026-02-02T03:31:50.180101Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.181477Z", "completed_at": "2026-02-02T03:31:50.181485Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008769035339355469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_email.d7cf761533", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere email is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.185732Z", "completed_at": "2026-02-02T03:31:50.190479Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.191841Z", "completed_at": "2026-02-02T03:31:50.191848Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008814573287963867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_signup_date.ef12d9c335", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect signup_date\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere signup_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.196005Z", "completed_at": "2026-02-02T03:31:50.201775Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.203153Z", "completed_at": "2026-02-02T03:31:50.203159Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00974130630493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_customers_customer_id.c7614daada", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.207222Z", "completed_at": "2026-02-02T03:31:50.223808Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.225222Z", "completed_at": "2026-02-02T03:31:50.225229Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02051401138305664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_payment_history", "compiled": true, "compiled_code": "with payments as (\n    select\n        subscription_id,\n        date_trunc('month', payment_date) as payment_month,\n        status,\n        amount\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n),\n\nmonthly_payments as (\n    select\n        subscription_id,\n        payment_month,\n        count(*) as payment_count,\n        sum(case when status = 'success' then 1 else 0 end) as successful_payments,\n        sum(case when status = 'failed' then 1 else 0 end) as failed_payments,\n        sum(case when status = 'refunded' then 1 else 0 end) as refunded_payments,\n        sum(amount) as net_amount\n    from payments\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(subscription_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(payment_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as subscription_month_id,\n        subscription_id,\n        payment_month,\n        payment_count,\n        successful_payments,\n        failed_payments,\n        refunded_payments,\n        net_amount\n    from monthly_payments\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_payment_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.229690Z", "completed_at": "2026-02-02T03:31:50.236366Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.237758Z", "completed_at": "2026-02-02T03:31:50.237765Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010967731475830078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_payments_payment_method__credit_card__bank_transfer__paypal.9a9e2818f7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        payment_method as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n    group by payment_method\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'credit_card','bank_transfer','paypal'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.241936Z", "completed_at": "2026-02-02T03:31:50.248408Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.249836Z", "completed_at": "2026-02-02T03:31:50.249842Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010464191436767578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_payments_status__success__failed__refunded.f3ae67bf94", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'success','failed','refunded'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.253937Z", "completed_at": "2026-02-02T03:31:50.258806Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.260181Z", "completed_at": "2026-02-02T03:31:50.260188Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008707046508789062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_payment_id.c19cc50075", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere payment_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.265494Z", "completed_at": "2026-02-02T03:31:50.327159Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.328552Z", "completed_at": "2026-02-02T03:31:50.328562Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0668172836303711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_payment_method.dad6ff229d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_method\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere payment_method is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.332737Z", "completed_at": "2026-02-02T03:31:50.337670Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.339056Z", "completed_at": "2026-02-02T03:31:50.339062Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009064912796020508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_status.dec3c85699", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.343464Z", "completed_at": "2026-02-02T03:31:50.348456Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.349845Z", "completed_at": "2026-02-02T03:31:50.349852Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009025812149047852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_subscription_id.182bae4263", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.354038Z", "completed_at": "2026-02-02T03:31:50.358794Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.360183Z", "completed_at": "2026-02-02T03:31:50.360190Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008771896362304688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_payments_payment_id.3744510712", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    payment_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere payment_id is not null\ngroup by payment_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.364467Z", "completed_at": "2026-02-02T03:31:50.368930Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.370306Z", "completed_at": "2026-02-02T03:31:50.370312Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00856781005859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.dim_plans", "compiled": true, "compiled_code": "with plans as (\n    select\n        plan_id,\n        plan_name,\n        plan_tier,\n        base_price_monthly,\n        base_price_annual,\n        features,\n        max_users,\n        created_date\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n),\n\nfinal as (\n    select\n        plan_id,\n        plan_name,\n        plan_tier,\n        base_price_monthly,\n        base_price_annual,\n        max_users,\n        features,\n        created_date\n    from plans\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"dim_plans\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.374684Z", "completed_at": "2026-02-02T03:31:50.381287Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.382687Z", "completed_at": "2026-02-02T03:31:50.382694Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010756254196166992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_plans_plan_tier__starter__professional__enterprise.6627a5bb68", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        plan_tier as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n    group by plan_tier\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'starter','professional','enterprise'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.386839Z", "completed_at": "2026-02-02T03:31:50.398760Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.400201Z", "completed_at": "2026-02-02T03:31:50.400209Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015868186950683594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_plans_base_price_annual__1000000__0.90f48edeea", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_annual >= 0 and base_price_annual <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.404381Z", "completed_at": "2026-02-02T03:31:50.409868Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.411287Z", "completed_at": "2026-02-02T03:31:50.411294Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00951385498046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_plans_base_price_monthly__100000__0.29dde2c990", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_monthly >= 0 and base_price_monthly <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.415493Z", "completed_at": "2026-02-02T03:31:50.420380Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.421746Z", "completed_at": "2026-02-02T03:31:50.421753Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00879979133605957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_base_price_annual.7ff22b0352", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_annual\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere base_price_annual is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.425858Z", "completed_at": "2026-02-02T03:31:50.432048Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.433470Z", "completed_at": "2026-02-02T03:31:50.433477Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010094881057739258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_base_price_monthly.768fac3224", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_monthly\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere base_price_monthly is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.437509Z", "completed_at": "2026-02-02T03:31:50.442278Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.443644Z", "completed_at": "2026-02-02T03:31:50.443650Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008604764938354492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_plan_id.97197e92e3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.447901Z", "completed_at": "2026-02-02T03:31:50.452660Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.454060Z", "completed_at": "2026-02-02T03:31:50.454066Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008647680282592773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_plan_tier.eba3d0c0c9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_tier\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere plan_tier is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.458107Z", "completed_at": "2026-02-02T03:31:50.462857Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.464246Z", "completed_at": "2026-02-02T03:31:50.464253Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008602619171142578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_plans_plan_id.b3adbcbaf7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    plan_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere plan_id is not null\ngroup by plan_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.468292Z", "completed_at": "2026-02-02T03:31:50.475907Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.477305Z", "completed_at": "2026-02-02T03:31:50.477312Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011522769927978516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.fct_monthly_recurring_revenue", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\nsubscriptions as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        billing_cycle,\n        amount,\n        -- Normalize MRR from amount + billing_cycle (more robust than trusting raw mrr_amount)\n        \n    case\n        when billing_cycle = 'annual' then amount / 12.0\n        when billing_cycle = 'monthly' then amount\n        else 0\n    end\n as normalized_mrr_amount\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n),\n\nsubscription_months as (\n    select\n        s.customer_id,\n        s.subscription_id,\n        s.plan_id,\n        m.date_month,\n        s.status,\n        s.billing_cycle,\n        s.amount,\n        case\n            when s.status = 'paused' then 0\n            else s.normalized_mrr_amount\n        end as mrr_amount\n    from subscriptions s\n    join months m\n        on m.date_month >= date_trunc('month', s.start_date)\n        and (\n            s.end_date is null\n            or m.date_month <= date_trunc('month', s.end_date)\n        )\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_month_id,\n        customer_id,\n        date_month,\n        sum(mrr_amount) as mrr_amount,\n        count(distinct subscription_id) as subscription_count\n    from subscription_months\n    group by 1, 2, 3\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.481523Z", "completed_at": "2026-02-02T03:31:50.485322Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.486692Z", "completed_at": "2026-02-02T03:31:50.486699Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00780034065246582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.fct_subscriptions", "compiled": true, "compiled_code": "with subscriptions as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        billing_cycle,\n        amount,\n        mrr_amount\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n),\n\nfinal as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        billing_cycle,\n        amount,\n        mrr_amount,\n        case\n            when status = 'active' then true\n            else false\n        end as is_currently_active\n    from subscriptions\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"fct_subscriptions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.491097Z", "completed_at": "2026-02-02T03:31:50.494712Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.496128Z", "completed_at": "2026-02-02T03:31:50.496135Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0077877044677734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_subscription_periods", "compiled": true, "compiled_code": "with subscriptions as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        mrr_amount,\n        billing_cycle,\n        amount\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n),\n\nfinal as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        mrr_amount,\n        billing_cycle,\n        amount\n    from subscriptions\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.500464Z", "completed_at": "2026-02-02T03:31:50.506496Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.507882Z", "completed_at": "2026-02-02T03:31:50.507889Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009974241256713867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_subscriptions_billing_cycle__monthly__annual.373ee04739", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        billing_cycle as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    group by billing_cycle\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'monthly','annual'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.512070Z", "completed_at": "2026-02-02T03:31:50.519701Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.521115Z", "completed_at": "2026-02-02T03:31:50.521122Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01157832145690918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_subscriptions_status__active__paused__churned__upgraded__downgraded.2ca9adef65", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','paused','churned','upgraded','downgraded'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.525255Z", "completed_at": "2026-02-02T03:31:50.530565Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.531975Z", "completed_at": "2026-02-02T03:31:50.531982Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009322643280029297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_subscriptions_amount__1000000__0.0aec0f7ac5", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and amount >= 0 and amount <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.536177Z", "completed_at": "2026-02-02T03:31:50.541632Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.543069Z", "completed_at": "2026-02-02T03:31:50.543076Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009506940841674805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_subscriptions_mrr_amount__100000__0.1f718c7d2b", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.547274Z", "completed_at": "2026-02-02T03:31:50.552134Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.553488Z", "completed_at": "2026-02-02T03:31:50.553495Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008768320083618164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_amount.d2bc105990", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.557555Z", "completed_at": "2026-02-02T03:31:50.562396Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.563746Z", "completed_at": "2026-02-02T03:31:50.563752Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008673429489135742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_billing_cycle.a5cc3f107d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect billing_cycle\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere billing_cycle is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.567815Z", "completed_at": "2026-02-02T03:31:50.573875Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.575256Z", "completed_at": "2026-02-02T03:31:50.575263Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009881734848022461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_customer_id.2baac6ebd7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.579310Z", "completed_at": "2026-02-02T03:31:50.584277Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.585646Z", "completed_at": "2026-02-02T03:31:50.585652Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008840799331665039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_mrr_amount.9940a0b6a0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.589766Z", "completed_at": "2026-02-02T03:31:50.594513Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.595867Z", "completed_at": "2026-02-02T03:31:50.595873Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008567571640014648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_plan_id.ebc4c7e103", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.599936Z", "completed_at": "2026-02-02T03:31:50.604832Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.606234Z", "completed_at": "2026-02-02T03:31:50.606241Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008827447891235352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_start_date.aae12535b8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_date\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere start_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.610242Z", "completed_at": "2026-02-02T03:31:50.616302Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.617680Z", "completed_at": "2026-02-02T03:31:50.617686Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009928464889526367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_status.e945ee07e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.621774Z", "completed_at": "2026-02-02T03:31:50.626520Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.627894Z", "completed_at": "2026-02-02T03:31:50.627901Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008604764938354492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_subscription_id.68a3edda91", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.631998Z", "completed_at": "2026-02-02T03:31:50.637848Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.639233Z", "completed_at": "2026-02-02T03:31:50.639240Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009724855422973633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_payments_subscription_id__subscription_id__ref_stg_subscriptions_.0ab4d26fa6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select subscription_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n    where subscription_id is not null\n),\n\nparent as (\n    select subscription_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.643363Z", "completed_at": "2026-02-02T03:31:50.649234Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.650646Z", "completed_at": "2026-02-02T03:31:50.650653Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009912252426147461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_subscriptions_customer_id__customer_id__ref_stg_customers_.3a4746f98e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.654817Z", "completed_at": "2026-02-02T03:31:50.661064Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.662425Z", "completed_at": "2026-02-02T03:31:50.662431Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010114669799804688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_subscriptions_plan_id__plan_id__ref_stg_plans_.9e3939335e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select plan_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    where plan_id is not null\n),\n\nparent as (\n    select plan_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.666585Z", "completed_at": "2026-02-02T03:31:50.672520Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.673891Z", "completed_at": "2026-02-02T03:31:50.673897Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009815692901611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_subscriptions_subscription_id.d45e893a6e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.678008Z", "completed_at": "2026-02-02T03:31:50.685104Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.686502Z", "completed_at": "2026-02-02T03:31:50.686509Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011018753051757812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_support_tickets_category__billing__technical__feature_request__other.2da1083ca7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        category as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    group by category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'billing','technical','feature_request','other'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.690648Z", "completed_at": "2026-02-02T03:31:50.697587Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.698969Z", "completed_at": "2026-02-02T03:31:50.698976Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010891199111938477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_support_tickets_priority__low__medium__high__urgent.63d517161e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        priority as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    group by priority\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'low','medium','high','urgent'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.703134Z", "completed_at": "2026-02-02T03:31:50.709051Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.710458Z", "completed_at": "2026-02-02T03:31:50.710465Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009892702102661133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_support_tickets_satisfaction_score__5__1__satisfaction_score_is_not_null.ea8ac41f35", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and satisfaction_score >= 1 and satisfaction_score <= 5\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    where\n        satisfaction_score is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.714596Z", "completed_at": "2026-02-02T03:31:50.720475Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.721836Z", "completed_at": "2026-02-02T03:31:50.721843Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009805679321289062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_category.28b0c1060c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere category is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.725930Z", "completed_at": "2026-02-02T03:31:50.730761Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.732144Z", "completed_at": "2026-02-02T03:31:50.732150Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008748292922973633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_customer_id.1a8e520036", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.736248Z", "completed_at": "2026-02-02T03:31:50.741086Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.742456Z", "completed_at": "2026-02-02T03:31:50.742463Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008765459060668945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_priority.beb363395f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect priority\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere priority is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.746704Z", "completed_at": "2026-02-02T03:31:50.751605Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.752986Z", "completed_at": "2026-02-02T03:31:50.752993Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008773326873779297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_ticket_id.7830ecbac2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.757088Z", "completed_at": "2026-02-02T03:31:50.762890Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.764286Z", "completed_at": "2026-02-02T03:31:50.764292Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009769439697265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_support_tickets_customer_id__customer_id__ref_stg_customers_.be9984b1c6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.768409Z", "completed_at": "2026-02-02T03:31:50.774368Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.775742Z", "completed_at": "2026-02-02T03:31:50.775748Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009920120239257812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_support_tickets_ticket_id.eed19dcb0a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.779839Z", "completed_at": "2026-02-02T03:31:50.785243Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.786629Z", "completed_at": "2026-02-02T03:31:50.786635Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009343862533569336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_customer_health_score", "compiled": true, "compiled_code": "with customers as (\n    select\n        customer_id\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n),\n\nas_of as (\n    select\n        greatest(\n            coalesce((select max(event_date) from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"), date '1900-01-01'),\n            coalesce((select max(payment_date) from \"saas_analytics\".\"main_staging\".\"stg_payments\"), date '1900-01-01'),\n            coalesce((select max(created_date) from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"), date '1900-01-01')\n        ) as as_of_date\n),\n\nusage_last_30d as (\n    select\n        ue.customer_id,\n        count(*) as events_last_30d,\n        sum(ue.usage_quantity) as usage_quantity_last_30d\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\" ue\n    cross join as_of a\n    where ue.event_date > a.as_of_date - interval 30 day\n      and ue.event_date <= a.as_of_date\n    group by 1\n),\n\ntickets_last_90d as (\n    select\n        t.customer_id,\n        count(*) as tickets_created_last_90d,\n        sum(case when t.resolved_date is null then 1 else 0 end) as open_tickets\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\" t\n    cross join as_of a\n    where t.created_date > a.as_of_date - interval 90 day\n      and t.created_date <= a.as_of_date\n    group by 1\n),\n\npayment_failures_last_90d as (\n    select\n        s.customer_id,\n        count(*) as payment_events_last_90d,\n        sum(case when p.status = 'failed' then 1 else 0 end) as failed_payments_last_90d\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\" p\n    join \"saas_analytics\".\"main_staging\".\"stg_subscriptions\" s\n        on p.subscription_id = s.subscription_id\n    cross join as_of a\n    where p.payment_date > a.as_of_date - interval 90 day\n      and p.payment_date <= a.as_of_date\n    group by 1\n),\n\nscored as (\n    select\n        c.customer_id,\n        a.as_of_date,\n        coalesce(u.events_last_30d, 0) as events_last_30d,\n        coalesce(u.usage_quantity_last_30d, 0) as usage_quantity_last_30d,\n        coalesce(t.tickets_created_last_90d, 0) as tickets_created_last_90d,\n        coalesce(t.open_tickets, 0) as open_tickets,\n        coalesce(p.payment_events_last_90d, 0) as payment_events_last_90d,\n        coalesce(p.failed_payments_last_90d, 0) as failed_payments_last_90d,\n        case\n            when coalesce(p.payment_events_last_90d, 0) = 0 then 0\n            else coalesce(p.failed_payments_last_90d, 0)::double / p.payment_events_last_90d\n        end as payment_failure_rate_last_90d\n    from customers c\n    cross join as_of a\n    left join usage_last_30d u\n        on c.customer_id = u.customer_id\n    left join tickets_last_90d t\n        on c.customer_id = t.customer_id\n    left join payment_failures_last_90d p\n        on c.customer_id = p.customer_id\n),\n\nfinal as (\n    select\n        customer_id,\n        as_of_date,\n        events_last_30d,\n        usage_quantity_last_30d,\n        tickets_created_last_90d,\n        open_tickets,\n        payment_events_last_90d,\n        failed_payments_last_90d,\n        payment_failure_rate_last_90d,\n        least(\n            100,\n            greatest(\n                0,\n                70\n                + least(30, events_last_30d)::integer\n                - least(40, open_tickets * 10)::integer\n                - least(40, (payment_failure_rate_last_90d * 100)::integer)\n            )\n        ) as health_score\n    from scored\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.791027Z", "completed_at": "2026-02-02T03:31:50.796393Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.797770Z", "completed_at": "2026-02-02T03:31:50.797777Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009629249572753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_monthly_usage", "compiled": true, "compiled_code": "with usage_events as (\n    select\n        customer_id,\n        date_trunc('month', event_date) as usage_month,\n        event_type,\n        usage_quantity\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n),\n\nmonthly_usage as (\n    select\n        customer_id,\n        usage_month,\n        count(*) as event_count,\n        sum(usage_quantity) as total_usage_quantity,\n        sum(case when event_type = 'login' then 1 else 0 end) as login_events,\n        sum(case when event_type = 'feature_usage' then 1 else 0 end) as feature_usage_events,\n        sum(case when event_type = 'export' then 1 else 0 end) as export_events,\n        sum(case when event_type = 'api_call' then 1 else 0 end) as api_call_events\n    from usage_events\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(usage_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_month_id,\n        customer_id,\n        usage_month,\n        event_count,\n        total_usage_quantity,\n        login_events,\n        feature_usage_events,\n        export_events,\n        api_call_events\n    from monthly_usage\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.802354Z", "completed_at": "2026-02-02T03:31:50.809480Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.810848Z", "completed_at": "2026-02-02T03:31:50.810856Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011138439178466797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_usage_events_event_type__login__feature_usage__export__api_call.9e239b4047", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        event_type as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n    group by event_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'login','feature_usage','export','api_call'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.815025Z", "completed_at": "2026-02-02T03:31:50.821478Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.822884Z", "completed_at": "2026-02-02T03:31:50.822891Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010405540466308594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_usage_events_usage_quantity__1000000__0.a19ac32495", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and usage_quantity >= 0 and usage_quantity <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.827043Z", "completed_at": "2026-02-02T03:31:50.831852Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.833227Z", "completed_at": "2026-02-02T03:31:50.833234Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008765697479248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_customer_id.424cb78bfc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.837326Z", "completed_at": "2026-02-02T03:31:50.842176Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.843537Z", "completed_at": "2026-02-02T03:31:50.843544Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008718252182006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_event_id.2c1891cce4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.847662Z", "completed_at": "2026-02-02T03:31:50.852624Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.854013Z", "completed_at": "2026-02-02T03:31:50.854019Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008902549743652344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_event_type.b865685b11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_type\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere event_type is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.858106Z", "completed_at": "2026-02-02T03:31:50.862997Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.864363Z", "completed_at": "2026-02-02T03:31:50.864370Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008811712265014648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_usage_quantity.8fafec8a69", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect usage_quantity\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere usage_quantity is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.868467Z", "completed_at": "2026-02-02T03:31:50.875437Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.877078Z", "completed_at": "2026-02-02T03:31:50.877085Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011162281036376953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_usage_events_customer_id__customer_id__ref_stg_customers_.33deb2f692", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.881169Z", "completed_at": "2026-02-02T03:31:50.885917Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.887280Z", "completed_at": "2026-02-02T03:31:50.887287Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008690118789672852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_usage_events_event_id.8f4005aa34", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.891463Z", "completed_at": "2026-02-02T03:31:50.897871Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.899280Z", "completed_at": "2026-02-02T03:31:50.899287Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010348081588745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_dim_customers_customer_segment__smb__mid_market__enterprise__unknown.59f6eba2cc", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.903396Z", "completed_at": "2026-02-02T03:31:50.908349Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.909706Z", "completed_at": "2026-02-02T03:31:50.909712Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00882267951965332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_customer_id.dd91cd1c8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.913806Z", "completed_at": "2026-02-02T03:31:50.919850Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.921236Z", "completed_at": "2026-02-02T03:31:50.921243Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00992274284362793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_customer_segment.bc342ee8ba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.925316Z", "completed_at": "2026-02-02T03:31:50.930066Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.931421Z", "completed_at": "2026-02-02T03:31:50.931428Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008594989776611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_email.ed68b54d1a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere email is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.935450Z", "completed_at": "2026-02-02T03:31:50.940345Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.941730Z", "completed_at": "2026-02-02T03:31:50.941736Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008783817291259766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_signup_date.7f7d0227dd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect signup_date\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere signup_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.945838Z", "completed_at": "2026-02-02T03:31:50.950574Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.952008Z", "completed_at": "2026-02-02T03:31:50.952015Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008718252182006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_dim_customers_customer_id.15c9f1e2fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.956257Z", "completed_at": "2026-02-02T03:31:50.961086Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.962447Z", "completed_at": "2026-02-02T03:31:50.962453Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008869171142578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_cohorts_cohort_month.5f7f1ecfb6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_month\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\"\nwhere cohort_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.966545Z", "completed_at": "2026-02-02T03:31:50.972574Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.973915Z", "completed_at": "2026-02-02T03:31:50.973922Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009858846664428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_cohorts_customer_id.a75833fcff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.978005Z", "completed_at": "2026-02-02T03:31:50.982707Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.984098Z", "completed_at": "2026-02-02T03:31:50.984105Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008592367172241211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_customer_cohorts_customer_id.279a739d39", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.988238Z", "completed_at": "2026-02-02T03:31:50.993757Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:50.995246Z", "completed_at": "2026-02-02T03:31:50.995254Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00962209701538086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_payment_history_net_amount__1000000000___1000000000.297926e2b5", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and net_amount >= -1000000000 and net_amount <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:50.999455Z", "completed_at": "2026-02-02T03:31:51.005021Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.006423Z", "completed_at": "2026-02-02T03:31:51.006431Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009631872177124023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_payment_history_payment_count__100000000__0.41e5b20a2f", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and payment_count >= 0 and payment_count <= 100000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.010672Z", "completed_at": "2026-02-02T03:31:51.015612Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.016989Z", "completed_at": "2026-02-02T03:31:51.016997Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008859634399414062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_net_amount.c0b496bbc8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect net_amount\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere net_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.021117Z", "completed_at": "2026-02-02T03:31:51.027421Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.028798Z", "completed_at": "2026-02-02T03:31:51.028805Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010298967361450195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_payment_count.c9d746fa8b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_count\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere payment_count is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.032932Z", "completed_at": "2026-02-02T03:31:51.037897Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.039314Z", "completed_at": "2026-02-02T03:31:51.039321Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008864641189575195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_payment_month.218496379c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_month\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere payment_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.043434Z", "completed_at": "2026-02-02T03:31:51.048231Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.049576Z", "completed_at": "2026-02-02T03:31:51.049584Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008737325668334961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_subscription_id.f530bb3c51", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.053653Z", "completed_at": "2026-02-02T03:31:51.058495Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.059856Z", "completed_at": "2026-02-02T03:31:51.059862Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008699417114257812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_subscription_month_id.ea8c983f61", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_month_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere subscription_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.064036Z", "completed_at": "2026-02-02T03:31:51.071086Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.072483Z", "completed_at": "2026-02-02T03:31:51.072490Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011093854904174805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_payment_history_subscription_id__subscription_id__ref_stg_subscriptions_.c2dc1d48a4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select subscription_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\n    where subscription_id is not null\n),\n\nparent as (\n    select subscription_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.076652Z", "completed_at": "2026-02-02T03:31:51.081345Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.082715Z", "completed_at": "2026-02-02T03:31:51.082722Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008606910705566406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_payment_history_subscription_month_id.d1f891bb75", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere subscription_month_id is not null\ngroup by subscription_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.086802Z", "completed_at": "2026-02-02T03:31:51.091866Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.093273Z", "completed_at": "2026-02-02T03:31:51.093280Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008955240249633789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_dim_plans_plan_tier__starter__professional__enterprise.951b43f83d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        plan_tier as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n    group by plan_tier\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'starter','professional','enterprise'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.097443Z", "completed_at": "2026-02-02T03:31:51.102967Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.104378Z", "completed_at": "2026-02-02T03:31:51.104384Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009571552276611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_dim_plans_base_price_annual__1000000__0.3da0c08240", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_annual >= 0 and base_price_annual <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.108582Z", "completed_at": "2026-02-02T03:31:51.114012Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.115393Z", "completed_at": "2026-02-02T03:31:51.115399Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009433269500732422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_dim_plans_base_price_monthly__100000__0.80491e18f9", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_monthly >= 0 and base_price_monthly <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.119524Z", "completed_at": "2026-02-02T03:31:51.125544Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.126910Z", "completed_at": "2026-02-02T03:31:51.126917Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009966135025024414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_base_price_annual.eee138969b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_annual\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere base_price_annual is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.131033Z", "completed_at": "2026-02-02T03:31:51.135933Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.137311Z", "completed_at": "2026-02-02T03:31:51.137318Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008777379989624023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_base_price_monthly.0aa94d6b4b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_monthly\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere base_price_monthly is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.141439Z", "completed_at": "2026-02-02T03:31:51.146190Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.147541Z", "completed_at": "2026-02-02T03:31:51.147548Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008681297302246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_plan_id.78a937462a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.151673Z", "completed_at": "2026-02-02T03:31:51.156499Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.157839Z", "completed_at": "2026-02-02T03:31:51.157845Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008632659912109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_plan_tier.154dd327a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_tier\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere plan_tier is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.161915Z", "completed_at": "2026-02-02T03:31:51.167681Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.169055Z", "completed_at": "2026-02-02T03:31:51.169062Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009606361389160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_dim_plans_plan_id.27d8cecd0f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    plan_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere plan_id is not null\ngroup by plan_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.173092Z", "completed_at": "2026-02-02T03:31:51.179699Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.181086Z", "completed_at": "2026-02-02T03:31:51.181093Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010453224182128906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.churn_analysis", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\ncustomer_month_spine as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        m.date_month\n    from customers c\n    cross join months m\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\nwith_prev as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        lag(mrr_amount) over (partition by customer_id order by date_month) as prev_mrr_amount\n    from customer_mrr\n),\n\nmonthly as (\n    select\n        date_month,\n        customer_segment,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 then 1 else 0 end) as starting_customers,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then 1 else 0 end) as churned_customers,\n        sum(coalesce(prev_mrr_amount, 0)) as starting_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then coalesce(prev_mrr_amount, 0) else 0 end) as churned_mrr\n    from with_prev\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_month_id,\n        date_month,\n        customer_segment,\n        starting_customers,\n        churned_customers,\n        case\n            when starting_customers = 0 then 0\n            else churned_customers::double / starting_customers\n        end as customer_churn_rate,\n        starting_mrr,\n        churned_mrr,\n        case\n            when starting_mrr = 0 then 0\n            else churned_mrr / starting_mrr\n        end as revenue_churn_rate\n    from monthly\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"churn_analysis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.185515Z", "completed_at": "2026-02-02T03:31:51.191302Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.192670Z", "completed_at": "2026-02-02T03:31:51.192676Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010065317153930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.cohort_retention", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncohorts as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        date_trunc('month', c.signup_date) as cohort_month\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\" c\n),\n\ncohort_sizes as (\n    select\n        cohort_month,\n        customer_segment,\n        count(*) as cohort_customers\n    from cohorts\n    group by 1, 2\n),\n\ncustomer_month_spine as (\n    select\n        co.customer_id,\n        co.customer_segment,\n        co.cohort_month,\n        m.date_month\n    from cohorts co\n    join months m\n        on m.date_month >= co.cohort_month\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.cohort_month,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\nactive_customers as (\n    select\n        cohort_month,\n        customer_segment,\n        date_month,\n        datediff('month', cohort_month, date_month) as months_since_signup,\n        count(distinct case when mrr_amount > 0 then customer_id end) as active_customers\n    from customer_mrr\n    group by 1, 2, 3, 4\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(a.customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(a.cohort_month as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(a.months_since_signup as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as cohort_segment_period_id,\n        a.cohort_month,\n        a.customer_segment,\n        a.months_since_signup,\n        a.date_month as active_month,\n        s.cohort_customers,\n        a.active_customers,\n        case\n            when s.cohort_customers = 0 then 0\n            else a.active_customers::double / s.cohort_customers\n        end as retention_rate\n    from active_customers a\n    join cohort_sizes s\n        on a.cohort_month = s.cohort_month\n        and a.customer_segment = s.customer_segment\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"cohort_retention\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.197086Z", "completed_at": "2026-02-02T03:31:51.202696Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.204051Z", "completed_at": "2026-02-02T03:31:51.204058Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009474754333496094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.mrr_analysis", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\ncustomer_month_spine as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        m.date_month\n    from customers c\n    cross join months m\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\ncustomer_mrr_with_prev as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        lag(mrr_amount) over (partition by customer_id order by date_month) as prev_mrr_amount\n    from customer_mrr\n),\n\nclassified as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        coalesce(prev_mrr_amount, 0) as prev_mrr_amount,\n        mrr_amount - coalesce(prev_mrr_amount, 0) as mrr_change,\n        case\n            when coalesce(prev_mrr_amount, 0) = 0 and mrr_amount > 0 then 'new'\n            when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then 'churn'\n            when mrr_amount > coalesce(prev_mrr_amount, 0) and coalesce(prev_mrr_amount, 0) > 0 then 'expansion'\n            when mrr_amount < coalesce(prev_mrr_amount, 0) and mrr_amount > 0 then 'contraction'\n            else 'no_change'\n        end as mrr_movement_type\n    from customer_mrr_with_prev\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_month_id,\n        date_month,\n        customer_segment,\n        sum(mrr_amount) as total_mrr,\n        sum(case when mrr_movement_type = 'new' then mrr_amount else 0 end) as new_mrr,\n        sum(case when mrr_movement_type = 'expansion' then mrr_change else 0 end) as expansion_mrr,\n        sum(case when mrr_movement_type = 'contraction' then abs(mrr_change) else 0 end) as contraction_mrr,\n        sum(case when mrr_movement_type = 'churn' then prev_mrr_amount else 0 end) as churned_mrr,\n        sum(case when mrr_movement_type in ('new', 'expansion') then mrr_change else 0 end)\n        - sum(case when mrr_movement_type in ('contraction', 'churn') then abs(mrr_change) else 0 end) as net_new_mrr\n    from classified\n    group by 1, 2, 3\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"mrr_analysis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.208410Z", "completed_at": "2026-02-02T03:31:51.214979Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.216392Z", "completed_at": "2026-02-02T03:31:51.216399Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010810136795043945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.net_revenue_retention", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\ncustomer_month_spine as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        m.date_month\n    from customers c\n    cross join months m\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\nwith_prev as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        lag(mrr_amount) over (partition by customer_id order by date_month) as prev_mrr_amount\n    from customer_mrr\n),\n\nmovement as (\n    select\n        date_month,\n        customer_segment,\n        sum(coalesce(prev_mrr_amount, 0)) as starting_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount > coalesce(prev_mrr_amount, 0) then mrr_amount - prev_mrr_amount else 0 end) as expansion_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount > 0 and mrr_amount < coalesce(prev_mrr_amount, 0) then prev_mrr_amount - mrr_amount else 0 end) as contraction_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then prev_mrr_amount else 0 end) as churned_mrr\n    from with_prev\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_month_id,\n        date_month,\n        customer_segment,\n        starting_mrr,\n        expansion_mrr,\n        contraction_mrr,\n        churned_mrr,\n        case\n            when starting_mrr = 0 then 0\n            else (starting_mrr + expansion_mrr - contraction_mrr - churned_mrr) / starting_mrr\n        end as net_revenue_retention,\n        case\n            when starting_mrr = 0 then 0\n            else (starting_mrr - contraction_mrr - churned_mrr) / starting_mrr\n        end as gross_revenue_retention\n    from movement\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"net_revenue_retention\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.220692Z", "completed_at": "2026-02-02T03:31:51.226333Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.227713Z", "completed_at": "2026-02-02T03:31:51.227722Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009531497955322266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_fct_monthly_recurring_revenue_mrr_amount__1000000__0.30bcc21edd", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.231845Z", "completed_at": "2026-02-02T03:31:51.236731Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.238103Z", "completed_at": "2026-02-02T03:31:51.238110Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008802175521850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_customer_id.a66423ce4f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.242216Z", "completed_at": "2026-02-02T03:31:51.247237Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.248577Z", "completed_at": "2026-02-02T03:31:51.248584Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008857011795043945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_customer_month_id.b7a062ebbc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_month_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere customer_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.252626Z", "completed_at": "2026-02-02T03:31:51.257540Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.258893Z", "completed_at": "2026-02-02T03:31:51.258900Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008729219436645508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_date_month.8089d21391", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.262960Z", "completed_at": "2026-02-02T03:31:51.268974Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.270357Z", "completed_at": "2026-02-02T03:31:51.270363Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009921550750732422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_mrr_amount.4c2963d658", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.274445Z", "completed_at": "2026-02-02T03:31:51.280242Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.281600Z", "completed_at": "2026-02-02T03:31:51.281607Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009618043899536133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_fct_monthly_recurring_revenue_customer_id__customer_id__ref_dim_customers_.09138f6532", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.285631Z", "completed_at": "2026-02-02T03:31:51.290417Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.291772Z", "completed_at": "2026-02-02T03:31:51.291779Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008594512939453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_fct_monthly_recurring_revenue_customer_month_id.a9d2287217", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere customer_month_id is not null\ngroup by customer_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.295814Z", "completed_at": "2026-02-02T03:31:51.300808Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.302198Z", "completed_at": "2026-02-02T03:31:51.302205Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008828878402709961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_fct_subscriptions_billing_cycle__monthly__annual.f19036f213", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        billing_cycle as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    group by billing_cycle\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'monthly','annual'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.306258Z", "completed_at": "2026-02-02T03:31:51.312259Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.313616Z", "completed_at": "2026-02-02T03:31:51.313622Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009843587875366211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_fct_subscriptions_status__active__paused__churned__upgraded__downgraded.15fca4795f", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','paused','churned','upgraded','downgraded'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.317648Z", "completed_at": "2026-02-02T03:31:51.323244Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.324662Z", "completed_at": "2026-02-02T03:31:51.324669Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009551286697387695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_fct_subscriptions_amount__1000000__0.21af0e0ca7", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and amount >= 0 and amount <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.328846Z", "completed_at": "2026-02-02T03:31:51.334165Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.335534Z", "completed_at": "2026-02-02T03:31:51.335540Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009191751480102539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_fct_subscriptions_mrr_amount__100000__0.b7f8e4f817", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.339595Z", "completed_at": "2026-02-02T03:31:51.344575Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.345982Z", "completed_at": "2026-02-02T03:31:51.345989Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008883237838745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_amount.77f80a5332", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.350046Z", "completed_at": "2026-02-02T03:31:51.355045Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.356443Z", "completed_at": "2026-02-02T03:31:51.356450Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008944988250732422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_billing_cycle.0a7a17a18b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect billing_cycle\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere billing_cycle is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.360529Z", "completed_at": "2026-02-02T03:31:51.366479Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.367840Z", "completed_at": "2026-02-02T03:31:51.367846Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009848833084106445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_customer_id.ae33a3a9d8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.371921Z", "completed_at": "2026-02-02T03:31:51.376813Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.378174Z", "completed_at": "2026-02-02T03:31:51.378181Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008794307708740234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_mrr_amount.0b5f93cb94", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.382325Z", "completed_at": "2026-02-02T03:31:51.387147Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.388521Z", "completed_at": "2026-02-02T03:31:51.388527Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008787155151367188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_plan_id.07baa591b1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.392645Z", "completed_at": "2026-02-02T03:31:51.397542Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.398874Z", "completed_at": "2026-02-02T03:31:51.398881Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008697032928466797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_status.daa1b1fe34", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.402970Z", "completed_at": "2026-02-02T03:31:51.408885Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.410247Z", "completed_at": "2026-02-02T03:31:51.410254Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009751319885253906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_subscription_id.f690e778b1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.414408Z", "completed_at": "2026-02-02T03:31:51.479703Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.481116Z", "completed_at": "2026-02-02T03:31:51.481127Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06934261322021484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_fct_subscriptions_customer_id__customer_id__ref_dim_customers_.738b2dd4ca", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.485415Z", "completed_at": "2026-02-02T03:31:51.491165Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.492553Z", "completed_at": "2026-02-02T03:31:51.492559Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009795188903808594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_fct_subscriptions_plan_id__plan_id__ref_dim_plans_.09ecb91cb5", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select plan_id as from_field\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    where plan_id is not null\n),\n\nparent as (\n    select plan_id as to_field\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.496703Z", "completed_at": "2026-02-02T03:31:51.501430Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.502770Z", "completed_at": "2026-02-02T03:31:51.502776Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008582353591918945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_fct_subscriptions_subscription_id.71386a928a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.506897Z", "completed_at": "2026-02-02T03:31:51.512312Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.513701Z", "completed_at": "2026-02-02T03:31:51.513707Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009377002716064453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_subscription_periods_mrr_amount__100000__0.32396aeab0", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.517853Z", "completed_at": "2026-02-02T03:31:51.523470Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.524808Z", "completed_at": "2026-02-02T03:31:51.524815Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009418010711669922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_subscription_periods_customer_id.33a91ad17a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.528876Z", "completed_at": "2026-02-02T03:31:51.533648Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.535034Z", "completed_at": "2026-02-02T03:31:51.535040Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008617639541625977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_subscription_periods_mrr_amount.c3d6239f36", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.539151Z", "completed_at": "2026-02-02T03:31:51.543976Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.545333Z", "completed_at": "2026-02-02T03:31:51.545340Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008690595626831055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_subscription_periods_subscription_id.228100b7db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.549586Z", "completed_at": "2026-02-02T03:31:51.555357Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.556734Z", "completed_at": "2026-02-02T03:31:51.556741Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009755134582519531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_subscription_periods_customer_id__customer_id__ref_stg_customers_.d2a65dcd76", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.561067Z", "completed_at": "2026-02-02T03:31:51.565672Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.567033Z", "completed_at": "2026-02-02T03:31:51.567040Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008713006973266602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_subscription_periods_subscription_id.213d4156ea", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.571191Z", "completed_at": "2026-02-02T03:31:51.577759Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.579164Z", "completed_at": "2026-02-02T03:31:51.579172Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01051640510559082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_customer_health_score_health_score__100__0.0fbd6b513b", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and health_score >= 0 and health_score <= 100\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.583330Z", "completed_at": "2026-02-02T03:31:51.588859Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.590264Z", "completed_at": "2026-02-02T03:31:51.590271Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009526252746582031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_customer_health_score_payment_failure_rate_last_90d__1__0.7e1e7e5f41", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and payment_failure_rate_last_90d >= 0 and payment_failure_rate_last_90d <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.594451Z", "completed_at": "2026-02-02T03:31:51.599269Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.600646Z", "completed_at": "2026-02-02T03:31:51.600653Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008764505386352539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_as_of_date.36d720fd53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect as_of_date\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere as_of_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.604769Z", "completed_at": "2026-02-02T03:31:51.609646Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.611034Z", "completed_at": "2026-02-02T03:31:51.611041Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008795976638793945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_customer_id.270547872f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.615173Z", "completed_at": "2026-02-02T03:31:51.620942Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.622302Z", "completed_at": "2026-02-02T03:31:51.622309Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00972437858581543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_health_score.f383d46da2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect health_score\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere health_score is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.626483Z", "completed_at": "2026-02-02T03:31:51.631643Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.633056Z", "completed_at": "2026-02-02T03:31:51.633063Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009204387664794922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_payment_failure_rate_last_90d.e26d5a38c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_failure_rate_last_90d\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere payment_failure_rate_last_90d is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.637227Z", "completed_at": "2026-02-02T03:31:51.643256Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.644634Z", "completed_at": "2026-02-02T03:31:51.644641Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010015249252319336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_customer_health_score_customer_id__customer_id__ref_stg_customers_.fe675ec61f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.648774Z", "completed_at": "2026-02-02T03:31:51.653482Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.654828Z", "completed_at": "2026-02-02T03:31:51.654835Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00852823257446289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_customer_health_score_customer_id.d7e00c064a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.658930Z", "completed_at": "2026-02-02T03:31:51.664440Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.665856Z", "completed_at": "2026-02-02T03:31:51.665863Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009473085403442383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_monthly_usage_event_count__100000000__0.7fcfb98d27", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and event_count >= 0 and event_count <= 100000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.670064Z", "completed_at": "2026-02-02T03:31:51.676663Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.678080Z", "completed_at": "2026-02-02T03:31:51.678087Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010542631149291992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_monthly_usage_total_usage_quantity__1000000000__0.a3a21278a6", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and total_usage_quantity >= 0 and total_usage_quantity <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.682179Z", "completed_at": "2026-02-02T03:31:51.686907Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.688275Z", "completed_at": "2026-02-02T03:31:51.688282Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008561372756958008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_customer_id.9f5a52035d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.692345Z", "completed_at": "2026-02-02T03:31:51.697168Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.698519Z", "completed_at": "2026-02-02T03:31:51.698526Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00864553451538086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_customer_month_id.74f34aceba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_month_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere customer_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.702628Z", "completed_at": "2026-02-02T03:31:51.707515Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.708914Z", "completed_at": "2026-02-02T03:31:51.708922Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008779525756835938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_event_count.823f19e9a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_count\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere event_count is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.713080Z", "completed_at": "2026-02-02T03:31:51.718968Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.720331Z", "completed_at": "2026-02-02T03:31:51.720338Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009804487228393555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_total_usage_quantity.9c8d7d37db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_usage_quantity\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere total_usage_quantity is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.724442Z", "completed_at": "2026-02-02T03:31:51.729293Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.730628Z", "completed_at": "2026-02-02T03:31:51.730635Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008760690689086914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_usage_month.5593c46a18", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect usage_month\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere usage_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.734710Z", "completed_at": "2026-02-02T03:31:51.740516Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.741864Z", "completed_at": "2026-02-02T03:31:51.741871Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009682416915893555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_monthly_usage_customer_id__customer_id__ref_stg_customers_.46c0ada6b9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.746150Z", "completed_at": "2026-02-02T03:31:51.750999Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.752372Z", "completed_at": "2026-02-02T03:31:51.752379Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00882720947265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_monthly_usage_customer_month_id.50e00ffb9c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere customer_month_id is not null\ngroup by customer_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.756466Z", "completed_at": "2026-02-02T03:31:51.762400Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.763787Z", "completed_at": "2026-02-02T03:31:51.763794Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009797811508178711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.customer_lifetime_value", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\nas_of as (\n    select\n        max(date_month) as as_of_month\n    from months\n),\n\nrecent_months as (\n    select\n        m.date_month\n    from months m\n    cross join as_of a\n    where m.date_month > a.as_of_month - interval 6 month\n      and m.date_month <= a.as_of_month\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\ncustomer_mrr as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        rm.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customers c\n    cross join recent_months rm\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on c.customer_id = f.customer_id\n        and rm.date_month = f.date_month\n),\n\nsegment_arpu as (\n    select\n        customer_segment,\n        avg(case when mrr_amount > 0 then mrr_amount end) as arpu\n    from customer_mrr\n    group by 1\n),\n\nsegment_churn as (\n    select\n        customer_segment,\n        avg(customer_churn_rate) as avg_monthly_customer_churn_rate\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    where date_month in (select date_month from recent_months)\n    group by 1\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(a.as_of_month as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(coalesce(ar.customer_segment, ch.customer_segment) as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_as_of_id,\n        a.as_of_month,\n        coalesce(ar.customer_segment, ch.customer_segment) as customer_segment,\n        coalesce(ar.arpu, 0) as arpu,\n        coalesce(ch.avg_monthly_customer_churn_rate, 0) as avg_monthly_customer_churn_rate,\n        case\n            when coalesce(ch.avg_monthly_customer_churn_rate, 0) = 0 then null\n            else least(120, 1.0 / ch.avg_monthly_customer_churn_rate)\n        end as expected_lifetime_months,\n        case\n            when coalesce(ch.avg_monthly_customer_churn_rate, 0) = 0 then null\n            else coalesce(ar.arpu, 0) * least(120, 1.0 / ch.avg_monthly_customer_churn_rate)\n        end as lifetime_value\n    from as_of a\n    full outer join segment_arpu ar\n        on 1 = 1\n    full outer join segment_churn ch\n        on ar.customer_segment = ch.customer_segment\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"customer_lifetime_value\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.768032Z", "completed_at": "2026-02-02T03:31:51.774894Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.776281Z", "completed_at": "2026-02-02T03:31:51.776294Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010860443115234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_churn_analysis_customer_segment__smb__mid_market__enterprise__unknown.12ff3b906a", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.780384Z", "completed_at": "2026-02-02T03:31:51.785873Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.787295Z", "completed_at": "2026-02-02T03:31:51.787301Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009479284286499023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_churned_customers__1000000000__0.ecf0d4d6a8", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and churned_customers >= 0 and churned_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.791504Z", "completed_at": "2026-02-02T03:31:51.796860Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.798282Z", "completed_at": "2026-02-02T03:31:51.798290Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009380817413330078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_customer_churn_rate__1__0.a3521c9c86", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and customer_churn_rate >= 0 and customer_churn_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.802508Z", "completed_at": "2026-02-02T03:31:51.807910Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.809319Z", "completed_at": "2026-02-02T03:31:51.809326Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009468317031860352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_revenue_churn_rate__1__0.ca578782ea", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and revenue_churn_rate >= 0 and revenue_churn_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.813574Z", "completed_at": "2026-02-02T03:31:51.820105Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.821754Z", "completed_at": "2026-02-02T03:31:51.821760Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010889053344726562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_starting_customers__1000000000__0.434546e5eb", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and starting_customers >= 0 and starting_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.825969Z", "completed_at": "2026-02-02T03:31:51.830769Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.832141Z", "completed_at": "2026-02-02T03:31:51.832148Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008708715438842773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_churned_customers.8445fc5f8a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect churned_customers\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere churned_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.836303Z", "completed_at": "2026-02-02T03:31:51.841273Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.842645Z", "completed_at": "2026-02-02T03:31:51.842652Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008907079696655273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_customer_churn_rate.b2257552ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_churn_rate\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere customer_churn_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.846775Z", "completed_at": "2026-02-02T03:31:51.851749Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.853172Z", "completed_at": "2026-02-02T03:31:51.853179Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008921384811401367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_customer_segment.f82e1dbd2a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.857367Z", "completed_at": "2026-02-02T03:31:51.862249Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.863593Z", "completed_at": "2026-02-02T03:31:51.863600Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008794069290161133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_date_month.aeceb24cdf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.867707Z", "completed_at": "2026-02-02T03:31:51.874059Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.875400Z", "completed_at": "2026-02-02T03:31:51.875407Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01024937629699707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_revenue_churn_rate.f68037cf43", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect revenue_churn_rate\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere revenue_churn_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.879913Z", "completed_at": "2026-02-02T03:31:51.884809Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.886250Z", "completed_at": "2026-02-02T03:31:51.886257Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008924245834350586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_segment_month_id.face7d9329", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_month_id\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere segment_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.890474Z", "completed_at": "2026-02-02T03:31:51.895208Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.896592Z", "completed_at": "2026-02-02T03:31:51.896599Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008738279342651367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_starting_customers.5eb8964198", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect starting_customers\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere starting_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.900711Z", "completed_at": "2026-02-02T03:31:51.905587Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.906961Z", "completed_at": "2026-02-02T03:31:51.906969Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008767366409301758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_churn_analysis_segment_month_id.d17ebe9d07", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere segment_month_id is not null\ngroup by segment_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.911058Z", "completed_at": "2026-02-02T03:31:51.917126Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.918494Z", "completed_at": "2026-02-02T03:31:51.918500Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00993800163269043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_cohort_retention_customer_segment__smb__mid_market__enterprise__unknown.537731c238", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.922633Z", "completed_at": "2026-02-02T03:31:51.928027Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.929419Z", "completed_at": "2026-02-02T03:31:51.929425Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00928807258605957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_active_customers__1000000000__0.c41f1ccb43", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and active_customers >= 0 and active_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.933603Z", "completed_at": "2026-02-02T03:31:51.939114Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.940537Z", "completed_at": "2026-02-02T03:31:51.940544Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009505987167358398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_cohort_customers__1000000000__0.3ded49037c", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and cohort_customers >= 0 and cohort_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.944673Z", "completed_at": "2026-02-02T03:31:51.950160Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.951591Z", "completed_at": "2026-02-02T03:31:51.951598Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009418010711669922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_months_since_signup__120__0.3abf594756", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and months_since_signup >= 0 and months_since_signup <= 120\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.955750Z", "completed_at": "2026-02-02T03:31:51.961204Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.962574Z", "completed_at": "2026-02-02T03:31:51.962581Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009378433227539062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_retention_rate__1__0.75ce1e0e47", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and retention_rate >= 0 and retention_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.966770Z", "completed_at": "2026-02-02T03:31:51.972878Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.974262Z", "completed_at": "2026-02-02T03:31:51.974280Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010009050369262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_active_customers.f50b652fd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect active_customers\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere active_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.978356Z", "completed_at": "2026-02-02T03:31:51.983319Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.984703Z", "completed_at": "2026-02-02T03:31:51.984710Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008907079696655273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_cohort_customers.37da0ff420", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_customers\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.988830Z", "completed_at": "2026-02-02T03:31:51.993539Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:51.994877Z", "completed_at": "2026-02-02T03:31:51.994884Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008594512939453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_cohort_month.0e607e02af", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_month\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:51.999115Z", "completed_at": "2026-02-02T03:31:52.003985Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.005354Z", "completed_at": "2026-02-02T03:31:52.005361Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008844614028930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_cohort_segment_period_id.0d29ee4706", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_segment_period_id\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_segment_period_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.009448Z", "completed_at": "2026-02-02T03:31:52.015353Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.016709Z", "completed_at": "2026-02-02T03:31:52.016716Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009798288345336914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_customer_segment.c697b5eb0e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.020805Z", "completed_at": "2026-02-02T03:31:52.025721Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.027110Z", "completed_at": "2026-02-02T03:31:52.027116Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00884556770324707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_months_since_signup.41d00203f4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect months_since_signup\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere months_since_signup is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.031206Z", "completed_at": "2026-02-02T03:31:52.036119Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.037467Z", "completed_at": "2026-02-02T03:31:52.037474Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008782386779785156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_retention_rate.8166dc37e8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect retention_rate\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere retention_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.041673Z", "completed_at": "2026-02-02T03:31:52.046455Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.047884Z", "completed_at": "2026-02-02T03:31:52.047890Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008771181106567383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_cohort_retention_cohort_segment_period_id.5afcaa3a16", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    cohort_segment_period_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_segment_period_id is not null\ngroup by cohort_segment_period_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.052063Z", "completed_at": "2026-02-02T03:31:52.057120Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.058475Z", "completed_at": "2026-02-02T03:31:52.058482Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008988618850708008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_mrr_analysis_customer_segment__smb__mid_market__enterprise__unknown.1257e5343c", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.062623Z", "completed_at": "2026-02-02T03:31:52.069707Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.071119Z", "completed_at": "2026-02-02T03:31:52.071129Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010975122451782227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_mrr_analysis_churned_mrr__1000000000__0.5cafc45ab5", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and churned_mrr >= 0 and churned_mrr <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.075374Z", "completed_at": "2026-02-02T03:31:52.080775Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.082154Z", "completed_at": "2026-02-02T03:31:52.082161Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009432554244995117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_mrr_analysis_new_mrr__1000000000__0.1d1f2a56be", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and new_mrr >= 0 and new_mrr <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.086344Z", "completed_at": "2026-02-02T03:31:52.091755Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.093142Z", "completed_at": "2026-02-02T03:31:52.093150Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00940847396850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_mrr_analysis_total_mrr__1000000000__0.03c10ae006", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and total_mrr >= 0 and total_mrr <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.097218Z", "completed_at": "2026-02-02T03:31:52.102100Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.103438Z", "completed_at": "2026-02-02T03:31:52.103445Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008704900741577148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_churned_mrr.a3d399ce96", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect churned_mrr\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere churned_mrr is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.107517Z", "completed_at": "2026-02-02T03:31:52.113333Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.114677Z", "completed_at": "2026-02-02T03:31:52.114684Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009602785110473633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_customer_segment.c66caf3809", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.118762Z", "completed_at": "2026-02-02T03:31:52.123819Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.125178Z", "completed_at": "2026-02-02T03:31:52.125185Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008959531784057617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_date_month.b31589f01e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.129316Z", "completed_at": "2026-02-02T03:31:52.134105Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.135434Z", "completed_at": "2026-02-02T03:31:52.135441Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008681058883666992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_new_mrr.7bd7ba8daa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect new_mrr\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere new_mrr is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.139535Z", "completed_at": "2026-02-02T03:31:52.144531Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.145913Z", "completed_at": "2026-02-02T03:31:52.145920Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008924484252929688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_segment_month_id.96b64accac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_month_id\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere segment_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.150019Z", "completed_at": "2026-02-02T03:31:52.154902Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.156246Z", "completed_at": "2026-02-02T03:31:52.156253Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008706092834472656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_total_mrr.80e9772030", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_mrr\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere total_mrr is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.160294Z", "completed_at": "2026-02-02T03:31:52.166316Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.167654Z", "completed_at": "2026-02-02T03:31:52.167661Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009873390197753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_mrr_analysis_segment_month_id.73b748be94", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere segment_month_id is not null\ngroup by segment_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.171716Z", "completed_at": "2026-02-02T03:31:52.176716Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.178083Z", "completed_at": "2026-02-02T03:31:52.178090Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008821249008178711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_net_revenue_retention_customer_segment__smb__mid_market__enterprise__unknown.bad1f7855d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.182261Z", "completed_at": "2026-02-02T03:31:52.187675Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.189074Z", "completed_at": "2026-02-02T03:31:52.189081Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009425640106201172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_net_revenue_retention_gross_revenue_retention__1__0.069667a4ae", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and gross_revenue_retention >= 0 and gross_revenue_retention <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.193217Z", "completed_at": "2026-02-02T03:31:52.198548Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.199967Z", "completed_at": "2026-02-02T03:31:52.199974Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009339094161987305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_net_revenue_retention_net_revenue_retention__5__0.02505b257b", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and net_revenue_retention >= 0 and net_revenue_retention <= 5\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.204110Z", "completed_at": "2026-02-02T03:31:52.209942Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.211310Z", "completed_at": "2026-02-02T03:31:52.211317Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009694576263427734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_customer_segment.a64b766957", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.215389Z", "completed_at": "2026-02-02T03:31:52.220231Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.221593Z", "completed_at": "2026-02-02T03:31:52.221600Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00873875617980957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_date_month.8b7a8fb0c8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.225823Z", "completed_at": "2026-02-02T03:31:52.230563Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.231912Z", "completed_at": "2026-02-02T03:31:52.231919Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00876164436340332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_gross_revenue_retention.11b3e16b67", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect gross_revenue_retention\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere gross_revenue_retention is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.236004Z", "completed_at": "2026-02-02T03:31:52.240873Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.242267Z", "completed_at": "2026-02-02T03:31:52.242274Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008808135986328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_net_revenue_retention.8a6d154e31", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect net_revenue_retention\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere net_revenue_retention is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.246410Z", "completed_at": "2026-02-02T03:31:52.251234Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.252562Z", "completed_at": "2026-02-02T03:31:52.252569Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008700132369995117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_segment_month_id.64a6b596d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_month_id\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere segment_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.256749Z", "completed_at": "2026-02-02T03:31:52.262533Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.263864Z", "completed_at": "2026-02-02T03:31:52.263871Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00957489013671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_net_revenue_retention_segment_month_id.cc84fd260d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere segment_month_id is not null\ngroup by segment_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.267937Z", "completed_at": "2026-02-02T03:31:52.273565Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.274919Z", "completed_at": "2026-02-02T03:31:52.274925Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009492158889770508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.unit_economics", "compiled": true, "compiled_code": "with ltv as (\n    select\n        as_of_month,\n        customer_segment,\n        arpu,\n        avg_monthly_customer_churn_rate,\n        expected_lifetime_months,\n        lifetime_value\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n),\n\nwith_cac as (\n    select\n        as_of_month,\n        customer_segment,\n        arpu,\n        avg_monthly_customer_churn_rate,\n        expected_lifetime_months,\n        lifetime_value,\n        case\n            when customer_segment = 'smb' then 600\n            when customer_segment = 'mid-market' then 2500\n            when customer_segment = 'enterprise' then 12000\n            else null\n        end as assumed_cac\n    from ltv\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(as_of_month as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_as_of_id,\n        as_of_month,\n        customer_segment,\n        arpu,\n        avg_monthly_customer_churn_rate,\n        expected_lifetime_months,\n        lifetime_value,\n        assumed_cac,\n        case\n            when assumed_cac is null or assumed_cac = 0 then null\n            else lifetime_value / assumed_cac\n        end as ltv_to_cac_ratio,\n        case\n            when arpu is null or arpu = 0 or assumed_cac is null then null\n            else assumed_cac / arpu\n        end as payback_months\n    from with_cac\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"unit_economics\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.279322Z", "completed_at": "2026-02-02T03:31:52.284416Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.285773Z", "completed_at": "2026-02-02T03:31:52.285780Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009008646011352539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_customer_lifetime_value_customer_segment__smb__mid_market__enterprise__unknown.d1b95c9570", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.289921Z", "completed_at": "2026-02-02T03:31:52.295262Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.296642Z", "completed_at": "2026-02-02T03:31:52.296648Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009297609329223633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_arpu__1000000__0.149ff1813f", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and arpu >= 0 and arpu <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.300842Z", "completed_at": "2026-02-02T03:31:52.307233Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.308594Z", "completed_at": "2026-02-02T03:31:52.308601Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010261774063110352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_avg_monthly_customer_churn_rate__1__0.02204de856", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and avg_monthly_customer_churn_rate >= 0 and avg_monthly_customer_churn_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.312701Z", "completed_at": "2026-02-02T03:31:52.318692Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.320097Z", "completed_at": "2026-02-02T03:31:52.320104Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009901762008666992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_expected_lifetime_months__120__0__expected_lifetime_months_is_not_null.5d159b06eb", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and expected_lifetime_months >= 0 and expected_lifetime_months <= 120\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    where\n        expected_lifetime_months is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.324340Z", "completed_at": "2026-02-02T03:31:52.330186Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.331576Z", "completed_at": "2026-02-02T03:31:52.331583Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009930133819580078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_lifetime_value__1000000000__0__lifetime_value_is_not_null.1e26703122", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and lifetime_value >= 0 and lifetime_value <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    where\n        lifetime_value is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.335745Z", "completed_at": "2026-02-02T03:31:52.340678Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.342073Z", "completed_at": "2026-02-02T03:31:52.342080Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008847951889038086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_arpu.68cf958b17", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect arpu\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere arpu is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.346176Z", "completed_at": "2026-02-02T03:31:52.351054Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.352381Z", "completed_at": "2026-02-02T03:31:52.352388Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00876474380493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_as_of_month.2440beb6c2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect as_of_month\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere as_of_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.356480Z", "completed_at": "2026-02-02T03:31:52.362721Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.364099Z", "completed_at": "2026-02-02T03:31:52.364106Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01010894775390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_avg_monthly_customer_churn_rate.1d3497b679", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_monthly_customer_churn_rate\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere avg_monthly_customer_churn_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.368234Z", "completed_at": "2026-02-02T03:31:52.373062Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.374403Z", "completed_at": "2026-02-02T03:31:52.374410Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008755922317504883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_customer_segment.77e1bf04e8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.378599Z", "completed_at": "2026-02-02T03:31:52.383487Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.384859Z", "completed_at": "2026-02-02T03:31:52.384865Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008857011795043945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_segment_as_of_id.6b96a69161", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_as_of_id\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere segment_as_of_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.389059Z", "completed_at": "2026-02-02T03:31:52.393729Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.395093Z", "completed_at": "2026-02-02T03:31:52.395099Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008606195449829102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_customer_lifetime_value_segment_as_of_id.c8b6e3f3fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_as_of_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere segment_as_of_id is not null\ngroup by segment_as_of_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.399205Z", "completed_at": "2026-02-02T03:31:52.406172Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.407591Z", "completed_at": "2026-02-02T03:31:52.407598Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011003732681274414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_unit_economics_assumed_cac__1000000000__0__assumed_cac_is_not_null.0593deb695", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and assumed_cac >= 0 and assumed_cac <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"unit_economics\"\n    where\n        assumed_cac is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.411887Z", "completed_at": "2026-02-02T03:31:52.417978Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.419394Z", "completed_at": "2026-02-02T03:31:52.419401Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010191679000854492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_unit_economics_ltv_to_cac_ratio__1000__0__ltv_to_cac_ratio_is_not_null.d76c1f7ce7", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and ltv_to_cac_ratio >= 0 and ltv_to_cac_ratio <= 1000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"unit_economics\"\n    where\n        ltv_to_cac_ratio is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.423558Z", "completed_at": "2026-02-02T03:31:52.429414Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.430795Z", "completed_at": "2026-02-02T03:31:52.430802Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009769201278686523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_unit_economics_payback_months__120__0__payback_months_is_not_null.77c8663847", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and payback_months >= 0 and payback_months <= 120\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"unit_economics\"\n    where\n        payback_months is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.435006Z", "completed_at": "2026-02-02T03:31:52.439914Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.441289Z", "completed_at": "2026-02-02T03:31:52.441296Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00886845588684082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_unit_economics_segment_as_of_id.1d127f6ec4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_as_of_id\nfrom \"saas_analytics\".\"main_marts\".\"unit_economics\"\nwhere segment_as_of_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-02T03:31:52.445351Z", "completed_at": "2026-02-02T03:31:52.450147Z"}, {"name": "execute", "started_at": "2026-02-02T03:31:52.451567Z", "completed_at": "2026-02-02T03:31:52.451574Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008722782135009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_unit_economics_segment_as_of_id.5d713df7b9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_as_of_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"unit_economics\"\nwhere segment_as_of_id is not null\ngroup by segment_as_of_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 2.821218967437744, "args": {"profiles_dir": ".", "favor_state": false, "defer": false, "project_dir": "/home/runner/work/saas-analytics-quality/saas-analytics-quality/dbt_project", "select": [], "exclude": [], "write_json": true, "quiet": false, "log_format_file": "debug", "partial_parse_file_diff": true, "use_colors": true, "invocation_command": "dbt docs generate", "indirect_selection": "eager", "partial_parse": true, "populate_cache": true, "version_check": true, "which": "generate", "introspect": true, "log_file_max_bytes": 10485760, "cache_selected_only": false, "strict_mode": false, "enable_legacy_logger": false, "send_anonymous_usage_stats": true, "macro_debugging": false, "print": true, "show_resource_report": false, "compile": true, "log_path": "/home/runner/work/saas-analytics-quality/saas-analytics-quality/dbt_project/logs", "log_level": "info", "log_level_file": "debug", "vars": {}, "warn_error_options": {"include": [], "exclude": []}, "empty_catalog": false, "static": false, "printer_width": 80, "static_parser": true, "log_format": "default", "use_colors_file": true}}