{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.0", "generated_at": "2026-02-05T21:43:09.588169Z", "invocation_id": "9ff3142e-a9aa-46e4-af20-1f75d2ee6b54", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:06.912048Z", "completed_at": "2026-02-05T21:43:06.961773Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:06.963206Z", "completed_at": "2026-02-05T21:43:06.963219Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05649876594543457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.dim_dates", "compiled": true, "compiled_code": "with date_spine as (\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 1095\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    cast('2022-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast('2024-12-31' as date)\n\n)\n\nselect * from filtered\n\n\n),\n\nfinal as (\n    select\n        cast(date_day as date) as date_day,\n        date_trunc('month', date_day) as date_month,\n        extract(year from date_day) as year,\n        extract(quarter from date_day) as quarter,\n        extract(month from date_day) as month,\n        extract(day from date_day) as day_of_month,\n        extract(dow from date_day) as day_of_week,\n        case when extract(dow from date_day) in (0, 6) then true else false end as is_weekend\n    from date_spine\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"dim_dates\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:06.970405Z", "completed_at": "2026-02-05T21:43:06.974342Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:06.975718Z", "completed_at": "2026-02-05T21:43:06.975725Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00800323486328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_customers", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"customers\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by customer_id\n            order by updated_at desc nulls last, created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(customer_id as integer) as customer_id,\n        lower(trim(email)) as email,\n        trim(company_name) as company_name,\n        cast(signup_date as date) as signup_date,\n        cast(end_date as date) as end_date,\n        lower(trim(account_status)) as account_status,\n        trim(industry) as industry,\n        trim(company_size) as company_size,\n        trim(country) as country,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:06.979885Z", "completed_at": "2026-02-05T21:43:06.983997Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:06.985557Z", "completed_at": "2026-02-05T21:43:06.985564Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008314847946166992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_payments", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"payments\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by payment_id\n            order by created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(payment_id as integer) as payment_id,\n        cast(subscription_id as integer) as subscription_id,\n        cast(payment_date as date) as payment_date,\n        cast(amount as double) as amount,\n        lower(trim(status)) as status,\n        lower(trim(payment_method)) as payment_method,\n        cast(created_at as timestamp) as created_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_payments\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:06.990024Z", "completed_at": "2026-02-05T21:43:06.994678Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:06.996056Z", "completed_at": "2026-02-05T21:43:06.996063Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008765697479248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_plans", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"plans\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by plan_id\n            order by created_date desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(plan_id as integer) as plan_id,\n        trim(plan_name) as plan_name,\n        lower(trim(plan_tier)) as plan_tier,\n        cast(base_price_monthly as double) as base_price_monthly,\n        cast(base_price_annual as double) as base_price_annual,\n        trim(features) as features,\n        cast(max_users as integer) as max_users,\n        cast(created_date as date) as created_date\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_plans\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.000449Z", "completed_at": "2026-02-05T21:43:07.004161Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.005511Z", "completed_at": "2026-02-05T21:43:07.005518Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00787806510925293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_subscriptions", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"subscriptions\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by subscription_id\n            order by updated_at desc nulls last, created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(subscription_id as integer) as subscription_id,\n        cast(customer_id as integer) as customer_id,\n        cast(plan_id as integer) as plan_id,\n        cast(start_date as date) as start_date,\n        cast(end_date as date) as end_date,\n        lower(trim(status)) as status,\n        cast(mrr_amount as double) as mrr_amount,\n        lower(trim(billing_cycle)) as billing_cycle,\n        cast(amount as double) as amount,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_subscriptions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.009645Z", "completed_at": "2026-02-05T21:43:07.013762Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.015180Z", "completed_at": "2026-02-05T21:43:07.015187Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008095026016235352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_support_tickets", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"support_tickets\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by ticket_id\n            order by created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(ticket_id as integer) as ticket_id,\n        cast(customer_id as integer) as customer_id,\n        cast(created_date as date) as created_date,\n        cast(resolved_date as date) as resolved_date,\n        lower(trim(category)) as category,\n        lower(trim(priority)) as priority,\n        cast(satisfaction_score as integer) as satisfaction_score,\n        cast(created_at as timestamp) as created_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_support_tickets\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.019320Z", "completed_at": "2026-02-05T21:43:07.023308Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.024699Z", "completed_at": "2026-02-05T21:43:07.024705Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007948160171508789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_usage_events", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"usage_events\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by event_id\n            order by created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(event_id as integer) as event_id,\n        cast(customer_id as integer) as customer_id,\n        cast(event_date as date) as event_date,\n        lower(trim(event_type)) as event_type,\n        cast(usage_quantity as integer) as usage_quantity,\n        cast(created_at as timestamp) as created_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_usage_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.029177Z", "completed_at": "2026-02-05T21:43:07.043595Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.044999Z", "completed_at": "2026-02-05T21:43:07.045007Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018712997436523438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_customers_customer_id.b4eeb23995", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main\".\"customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.049129Z", "completed_at": "2026-02-05T21:43:07.054033Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.055439Z", "completed_at": "2026-02-05T21:43:07.055446Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008880376815795898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_payments_payment_id.3057b24598", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_id\nfrom \"saas_analytics\".\"main\".\"payments\"\nwhere payment_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.059571Z", "completed_at": "2026-02-05T21:43:07.064496Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.065948Z", "completed_at": "2026-02-05T21:43:07.065955Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008855581283569336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_plans_plan_id.60ea0c3f70", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main\".\"plans\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.070143Z", "completed_at": "2026-02-05T21:43:07.075007Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.076368Z", "completed_at": "2026-02-05T21:43:07.076375Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008941411972045898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_subscriptions_subscription_id.d38f0dcd3e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main\".\"subscriptions\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.080657Z", "completed_at": "2026-02-05T21:43:07.085585Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.086989Z", "completed_at": "2026-02-05T21:43:07.086996Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00890040397644043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_support_tickets_ticket_id.f5e0ca9687", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"saas_analytics\".\"main\".\"support_tickets\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.091161Z", "completed_at": "2026-02-05T21:43:07.097357Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.098715Z", "completed_at": "2026-02-05T21:43:07.098722Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010125398635864258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_usage_events_event_id.6b4882f73b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"saas_analytics\".\"main\".\"usage_events\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.102784Z", "completed_at": "2026-02-05T21:43:07.112116Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.113519Z", "completed_at": "2026-02-05T21:43:07.113527Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013227224349975586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_payments_subscription_id__subscription_id__source_raw_saas_subscriptions_.eec6fd2df4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select subscription_id as from_field\n    from \"saas_analytics\".\"main\".\"payments\"\n    where subscription_id is not null\n),\n\nparent as (\n    select subscription_id as to_field\n    from \"saas_analytics\".\"main\".\"subscriptions\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.117676Z", "completed_at": "2026-02-05T21:43:07.124007Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.125388Z", "completed_at": "2026-02-05T21:43:07.125395Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010227203369140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_subscriptions_customer_id__customer_id__source_raw_saas_customers_.d9d2470757", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main\".\"subscriptions\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main\".\"customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.129484Z", "completed_at": "2026-02-05T21:43:07.135424Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.136799Z", "completed_at": "2026-02-05T21:43:07.136806Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009806394577026367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_support_tickets_customer_id__customer_id__source_raw_saas_customers_.558da46c8f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main\".\"support_tickets\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main\".\"customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.140933Z", "completed_at": "2026-02-05T21:43:07.147923Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.149306Z", "completed_at": "2026-02-05T21:43:07.149314Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010899782180786133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_usage_events_customer_id__customer_id__source_raw_saas_customers_.edd5bda594", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main\".\"usage_events\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main\".\"customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.153399Z", "completed_at": "2026-02-05T21:43:07.160607Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.162028Z", "completed_at": "2026-02-05T21:43:07.162035Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011150598526000977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_customers_customer_id.5e4b5bfe1e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.166133Z", "completed_at": "2026-02-05T21:43:07.170974Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.172357Z", "completed_at": "2026-02-05T21:43:07.172364Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008718252182006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_payments_payment_id.3ce97338e8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    payment_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"payments\"\nwhere payment_id is not null\ngroup by payment_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.176427Z", "completed_at": "2026-02-05T21:43:07.181222Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.182568Z", "completed_at": "2026-02-05T21:43:07.182575Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00872182846069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_plans_plan_id.1874d4258c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    plan_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"plans\"\nwhere plan_id is not null\ngroup by plan_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.186774Z", "completed_at": "2026-02-05T21:43:07.191592Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.192965Z", "completed_at": "2026-02-05T21:43:07.192973Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008676290512084961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_subscriptions_subscription_id.f107c8e56a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"subscriptions\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.197052Z", "completed_at": "2026-02-05T21:43:07.202985Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.204365Z", "completed_at": "2026-02-05T21:43:07.204373Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009836912155151367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_support_tickets_ticket_id.590438c9f6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"support_tickets\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.208426Z", "completed_at": "2026-02-05T21:43:07.213199Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.214565Z", "completed_at": "2026-02-05T21:43:07.214572Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00860738754272461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_usage_events_event_id.e76df55de9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"usage_events\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.218653Z", "completed_at": "2026-02-05T21:43:07.223565Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.224940Z", "completed_at": "2026-02-05T21:43:07.224947Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008845329284667969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_dates_date_day.1717af99fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"saas_analytics\".\"main_marts\".\"dim_dates\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.229052Z", "completed_at": "2026-02-05T21:43:07.234021Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.235386Z", "completed_at": "2026-02-05T21:43:07.235394Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008919239044189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_dates_date_month.8043b8f3cb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"dim_dates\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.239480Z", "completed_at": "2026-02-05T21:43:07.244197Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.245544Z", "completed_at": "2026-02-05T21:43:07.245551Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008545637130737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_dim_dates_date_day.5e9dfa95c7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_day as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"dim_dates\"\nwhere date_day is not null\ngroup by date_day\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.249591Z", "completed_at": "2026-02-05T21:43:07.254396Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.255744Z", "completed_at": "2026-02-05T21:43:07.255750Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00860738754272461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.dim_customers", "compiled": true, "compiled_code": "with customers as (\n    select\n        customer_id,\n        email,\n        company_name,\n        industry,\n        company_size,\n        country,\n        signup_date,\n        end_date,\n        account_status\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n),\n\nfinal as (\n    select\n        customer_id,\n        email,\n        company_name,\n        industry,\n        company_size,\n        case\n            when lower(company_size) = 'small' then 'smb'\n            when lower(company_size) = 'medium' then 'mid-market'\n            when lower(company_size) = 'large' then 'enterprise'\n            else 'unknown'\n        end as customer_segment,\n        country,\n        signup_date,\n        end_date as churn_date,\n        account_status,\n        case when account_status = 'active' then true else false end as is_active\n    from customers\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"dim_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.259893Z", "completed_at": "2026-02-05T21:43:07.263612Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.264992Z", "completed_at": "2026-02-05T21:43:07.264999Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00769495964050293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_customer_cohorts", "compiled": true, "compiled_code": "with customers as (\n    select\n        customer_id,\n        signup_date\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n),\n\nfinal as (\n    select\n        customer_id,\n        date_trunc('month', signup_date) as cohort_month\n    from customers\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.269222Z", "completed_at": "2026-02-05T21:43:07.278745Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.280153Z", "completed_at": "2026-02-05T21:43:07.280160Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013457298278808594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_customers_account_status__active__churned.4ba2500c79", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        account_status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n    group by account_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','churned'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.284279Z", "completed_at": "2026-02-05T21:43:07.303030Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.304435Z", "completed_at": "2026-02-05T21:43:07.304443Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022690534591674805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_match_regex_stg_customers_email___a_zA_Z0_9__a_zA_Z0_9_a_zA_Z0_9_.796c35c3c5", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \n\nregexp_matches(email, '^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$', '')\n\n\n > 0\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.308583Z", "completed_at": "2026-02-05T21:43:07.314425Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.315806Z", "completed_at": "2026-02-05T21:43:07.315813Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009733915328979492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_account_status.d9b1d833ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_status\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere account_status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.319954Z", "completed_at": "2026-02-05T21:43:07.324799Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.326176Z", "completed_at": "2026-02-05T21:43:07.326183Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008733749389648438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.330239Z", "completed_at": "2026-02-05T21:43:07.335044Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.336392Z", "completed_at": "2026-02-05T21:43:07.336400Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008716344833374023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_email.d7cf761533", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere email is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.340628Z", "completed_at": "2026-02-05T21:43:07.345363Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.346706Z", "completed_at": "2026-02-05T21:43:07.346713Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008792877197265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_signup_date.ef12d9c335", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect signup_date\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere signup_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.350792Z", "completed_at": "2026-02-05T21:43:07.356661Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.358053Z", "completed_at": "2026-02-05T21:43:07.358060Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009747028350830078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_customers_customer_id.c7614daada", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.362110Z", "completed_at": "2026-02-05T21:43:07.378544Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.379946Z", "completed_at": "2026-02-05T21:43:07.379954Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.020324230194091797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_payment_history", "compiled": true, "compiled_code": "with payments as (\n    select\n        subscription_id,\n        date_trunc('month', payment_date) as payment_month,\n        status,\n        amount\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n),\n\nmonthly_payments as (\n    select\n        subscription_id,\n        payment_month,\n        count(*) as payment_count,\n        sum(case when status = 'success' then 1 else 0 end) as successful_payments,\n        sum(case when status = 'failed' then 1 else 0 end) as failed_payments,\n        sum(case when status = 'refunded' then 1 else 0 end) as refunded_payments,\n        sum(amount) as net_amount\n    from payments\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(subscription_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(payment_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as subscription_month_id,\n        subscription_id,\n        payment_month,\n        payment_count,\n        successful_payments,\n        failed_payments,\n        refunded_payments,\n        net_amount\n    from monthly_payments\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_payment_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.384388Z", "completed_at": "2026-02-05T21:43:07.391080Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.392478Z", "completed_at": "2026-02-05T21:43:07.392485Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01096653938293457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_payments_payment_method__credit_card__bank_transfer__paypal.9a9e2818f7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        payment_method as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n    group by payment_method\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'credit_card','bank_transfer','paypal'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.396589Z", "completed_at": "2026-02-05T21:43:07.403384Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.404740Z", "completed_at": "2026-02-05T21:43:07.404747Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010636091232299805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_payments_status__success__failed__refunded.f3ae67bf94", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'success','failed','refunded'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.408849Z", "completed_at": "2026-02-05T21:43:07.413714Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.415073Z", "completed_at": "2026-02-05T21:43:07.415080Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008753538131713867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_payment_id.c19cc50075", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere payment_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.420343Z", "completed_at": "2026-02-05T21:43:07.478244Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.479625Z", "completed_at": "2026-02-05T21:43:07.479634Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06304097175598145, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_payment_method.dad6ff229d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_method\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere payment_method is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.483748Z", "completed_at": "2026-02-05T21:43:07.488590Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.489951Z", "completed_at": "2026-02-05T21:43:07.489958Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00874185562133789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_status.dec3c85699", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.494013Z", "completed_at": "2026-02-05T21:43:07.498877Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.500245Z", "completed_at": "2026-02-05T21:43:07.500252Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008721351623535156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_subscription_id.182bae4263", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.504315Z", "completed_at": "2026-02-05T21:43:07.509028Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.510367Z", "completed_at": "2026-02-05T21:43:07.510374Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008593559265136719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_payments_payment_id.3744510712", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    payment_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere payment_id is not null\ngroup by payment_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.514556Z", "completed_at": "2026-02-05T21:43:07.519250Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.520576Z", "completed_at": "2026-02-05T21:43:07.520583Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008713722229003906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.dim_plans", "compiled": true, "compiled_code": "with plans as (\n    select\n        plan_id,\n        plan_name,\n        plan_tier,\n        base_price_monthly,\n        base_price_annual,\n        features,\n        max_users,\n        created_date\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n),\n\nfinal as (\n    select\n        plan_id,\n        plan_name,\n        plan_tier,\n        base_price_monthly,\n        base_price_annual,\n        max_users,\n        features,\n        created_date\n    from plans\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"dim_plans\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.524948Z", "completed_at": "2026-02-05T21:43:07.531431Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.532786Z", "completed_at": "2026-02-05T21:43:07.532793Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010358572006225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_plans_plan_tier__starter__professional__enterprise.6627a5bb68", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        plan_tier as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n    group by plan_tier\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'starter','professional','enterprise'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.536833Z", "completed_at": "2026-02-05T21:43:07.548653Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.550048Z", "completed_at": "2026-02-05T21:43:07.550055Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015686988830566406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_plans_base_price_annual__1000000__0.90f48edeea", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_annual >= 0 and base_price_annual <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.554132Z", "completed_at": "2026-02-05T21:43:07.559530Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.560919Z", "completed_at": "2026-02-05T21:43:07.560927Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009276628494262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_plans_base_price_monthly__100000__0.29dde2c990", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_monthly >= 0 and base_price_monthly <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.564991Z", "completed_at": "2026-02-05T21:43:07.569686Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.571038Z", "completed_at": "2026-02-05T21:43:07.571045Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008511066436767578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_base_price_annual.7ff22b0352", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_annual\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere base_price_annual is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.575021Z", "completed_at": "2026-02-05T21:43:07.581094Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.582431Z", "completed_at": "2026-02-05T21:43:07.582437Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00986623764038086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_base_price_monthly.768fac3224", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_monthly\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere base_price_monthly is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.586420Z", "completed_at": "2026-02-05T21:43:07.591155Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.592504Z", "completed_at": "2026-02-05T21:43:07.592511Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008518457412719727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_plan_id.97197e92e3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.596699Z", "completed_at": "2026-02-05T21:43:07.601390Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.602746Z", "completed_at": "2026-02-05T21:43:07.602753Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008529424667358398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_plan_tier.eba3d0c0c9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_tier\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere plan_tier is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.606771Z", "completed_at": "2026-02-05T21:43:07.611536Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.612880Z", "completed_at": "2026-02-05T21:43:07.612887Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008595705032348633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_plans_plan_id.b3adbcbaf7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    plan_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere plan_id is not null\ngroup by plan_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.616877Z", "completed_at": "2026-02-05T21:43:07.624471Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.625838Z", "completed_at": "2026-02-05T21:43:07.625845Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011391162872314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.fct_monthly_recurring_revenue", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\nsubscriptions as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        billing_cycle,\n        amount,\n        -- Normalize MRR from amount + billing_cycle (more robust than trusting raw mrr_amount)\n        \n    case\n        when billing_cycle = 'annual' then amount / 12.0\n        when billing_cycle = 'monthly' then amount\n        else 0\n    end\n as normalized_mrr_amount\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n),\n\nsubscription_months as (\n    select\n        s.customer_id,\n        s.subscription_id,\n        s.plan_id,\n        m.date_month,\n        s.status,\n        s.billing_cycle,\n        s.amount,\n        case\n            when s.status = 'paused' then 0\n            else s.normalized_mrr_amount\n        end as mrr_amount\n    from subscriptions s\n    join months m\n        on m.date_month >= date_trunc('month', s.start_date)\n        and (\n            s.end_date is null\n            or m.date_month <= date_trunc('month', s.end_date)\n        )\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_month_id,\n        customer_id,\n        date_month,\n        sum(mrr_amount) as mrr_amount,\n        count(distinct subscription_id) as subscription_count\n    from subscription_months\n    group by 1, 2, 3\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.630190Z", "completed_at": "2026-02-05T21:43:07.633677Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.635055Z", "completed_at": "2026-02-05T21:43:07.635062Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00735926628112793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.fct_subscriptions", "compiled": true, "compiled_code": "with subscriptions as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        billing_cycle,\n        amount,\n        mrr_amount\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n),\n\nfinal as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        billing_cycle,\n        amount,\n        mrr_amount,\n        case\n            when status = 'active' then true\n            else false\n        end as is_currently_active\n    from subscriptions\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"fct_subscriptions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.639373Z", "completed_at": "2026-02-05T21:43:07.642951Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.644302Z", "completed_at": "2026-02-05T21:43:07.644309Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007641315460205078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_subscription_periods", "compiled": true, "compiled_code": "with subscriptions as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        mrr_amount,\n        billing_cycle,\n        amount\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n),\n\nfinal as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        mrr_amount,\n        billing_cycle,\n        amount\n    from subscriptions\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.648386Z", "completed_at": "2026-02-05T21:43:07.654579Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.655951Z", "completed_at": "2026-02-05T21:43:07.655958Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01006937026977539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_subscriptions_billing_cycle__monthly__annual.373ee04739", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        billing_cycle as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    group by billing_cycle\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'monthly','annual'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.660013Z", "completed_at": "2026-02-05T21:43:07.667626Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.669018Z", "completed_at": "2026-02-05T21:43:07.669025Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011497259140014648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_subscriptions_status__active__paused__churned__upgraded__downgraded.2ca9adef65", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','paused','churned','upgraded','downgraded'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.673015Z", "completed_at": "2026-02-05T21:43:07.678413Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.679786Z", "completed_at": "2026-02-05T21:43:07.679793Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009241580963134766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_subscriptions_amount__1000000__0.0aec0f7ac5", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and amount >= 0 and amount <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.683884Z", "completed_at": "2026-02-05T21:43:07.689130Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.690523Z", "completed_at": "2026-02-05T21:43:07.690530Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009151220321655273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_subscriptions_mrr_amount__100000__0.1f718c7d2b", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.694674Z", "completed_at": "2026-02-05T21:43:07.699501Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.700832Z", "completed_at": "2026-02-05T21:43:07.700839Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008705377578735352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_amount.d2bc105990", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.704861Z", "completed_at": "2026-02-05T21:43:07.709760Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.711139Z", "completed_at": "2026-02-05T21:43:07.711146Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00872492790222168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_billing_cycle.a5cc3f107d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect billing_cycle\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere billing_cycle is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.715182Z", "completed_at": "2026-02-05T21:43:07.721118Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.722485Z", "completed_at": "2026-02-05T21:43:07.722492Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00976419448852539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_customer_id.2baac6ebd7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.726554Z", "completed_at": "2026-02-05T21:43:07.731395Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.732778Z", "completed_at": "2026-02-05T21:43:07.732786Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008751153945922852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_mrr_amount.9940a0b6a0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.736868Z", "completed_at": "2026-02-05T21:43:07.741619Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.742975Z", "completed_at": "2026-02-05T21:43:07.742983Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008554458618164062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_plan_id.ebc4c7e103", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.746980Z", "completed_at": "2026-02-05T21:43:07.751790Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.753170Z", "completed_at": "2026-02-05T21:43:07.753178Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008701086044311523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_start_date.aae12535b8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_date\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere start_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.757222Z", "completed_at": "2026-02-05T21:43:07.763127Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.764467Z", "completed_at": "2026-02-05T21:43:07.764474Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009796380996704102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_status.e945ee07e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.768493Z", "completed_at": "2026-02-05T21:43:07.773245Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.774572Z", "completed_at": "2026-02-05T21:43:07.774579Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008514404296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_subscription_id.68a3edda91", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.778575Z", "completed_at": "2026-02-05T21:43:07.784362Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.785703Z", "completed_at": "2026-02-05T21:43:07.785710Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009649991989135742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_payments_subscription_id__subscription_id__ref_stg_subscriptions_.0ab4d26fa6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select subscription_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n    where subscription_id is not null\n),\n\nparent as (\n    select subscription_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.789774Z", "completed_at": "2026-02-05T21:43:07.795626Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.797004Z", "completed_at": "2026-02-05T21:43:07.797011Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009756803512573242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_subscriptions_customer_id__customer_id__ref_stg_customers_.3a4746f98e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.801064Z", "completed_at": "2026-02-05T21:43:07.807237Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.808569Z", "completed_at": "2026-02-05T21:43:07.808576Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010043859481811523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_subscriptions_plan_id__plan_id__ref_stg_plans_.9e3939335e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select plan_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    where plan_id is not null\n),\n\nparent as (\n    select plan_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.812591Z", "completed_at": "2026-02-05T21:43:07.818705Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.820060Z", "completed_at": "2026-02-05T21:43:07.820068Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009968757629394531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_subscriptions_subscription_id.d45e893a6e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.824105Z", "completed_at": "2026-02-05T21:43:07.831133Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.832498Z", "completed_at": "2026-02-05T21:43:07.832506Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010893821716308594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_support_tickets_category__billing__technical__feature_request__other.2da1083ca7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        category as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    group by category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'billing','technical','feature_request','other'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.836697Z", "completed_at": "2026-02-05T21:43:07.843698Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.845089Z", "completed_at": "2026-02-05T21:43:07.845098Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01092839241027832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_support_tickets_priority__low__medium__high__urgent.63d517161e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        priority as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    group by priority\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'low','medium','high','urgent'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.849366Z", "completed_at": "2026-02-05T21:43:07.855182Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.856553Z", "completed_at": "2026-02-05T21:43:07.856560Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009786367416381836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_support_tickets_satisfaction_score__5__1__satisfaction_score_is_not_null.ea8ac41f35", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and satisfaction_score >= 1 and satisfaction_score <= 5\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    where\n        satisfaction_score is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.860636Z", "completed_at": "2026-02-05T21:43:07.866573Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.867926Z", "completed_at": "2026-02-05T21:43:07.867933Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009737730026245117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_category.28b0c1060c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere category is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.871962Z", "completed_at": "2026-02-05T21:43:07.876854Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.878282Z", "completed_at": "2026-02-05T21:43:07.878289Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008861541748046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_customer_id.1a8e520036", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.882355Z", "completed_at": "2026-02-05T21:43:07.887133Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.888472Z", "completed_at": "2026-02-05T21:43:07.888479Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008649110794067383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_priority.beb363395f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect priority\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere priority is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.892482Z", "completed_at": "2026-02-05T21:43:07.897345Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.898678Z", "completed_at": "2026-02-05T21:43:07.898685Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008629798889160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_ticket_id.7830ecbac2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.902755Z", "completed_at": "2026-02-05T21:43:07.908651Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.910053Z", "completed_at": "2026-02-05T21:43:07.910060Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009767293930053711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_support_tickets_customer_id__customer_id__ref_stg_customers_.be9984b1c6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.914133Z", "completed_at": "2026-02-05T21:43:07.920108Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.921447Z", "completed_at": "2026-02-05T21:43:07.921454Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009790182113647461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_support_tickets_ticket_id.eed19dcb0a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.925501Z", "completed_at": "2026-02-05T21:43:07.930991Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.932367Z", "completed_at": "2026-02-05T21:43:07.932373Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009407520294189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_customer_health_score", "compiled": true, "compiled_code": "with customers as (\n    select\n        customer_id\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n),\n\nas_of as (\n    select\n        greatest(\n            coalesce((select max(event_date) from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"), date '1900-01-01'),\n            coalesce((select max(payment_date) from \"saas_analytics\".\"main_staging\".\"stg_payments\"), date '1900-01-01'),\n            coalesce((select max(created_date) from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"), date '1900-01-01')\n        ) as as_of_date\n),\n\nusage_last_30d as (\n    select\n        ue.customer_id,\n        count(*) as events_last_30d,\n        sum(ue.usage_quantity) as usage_quantity_last_30d\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\" ue\n    cross join as_of a\n    where ue.event_date > a.as_of_date - interval 30 day\n      and ue.event_date <= a.as_of_date\n    group by 1\n),\n\ntickets_last_90d as (\n    select\n        t.customer_id,\n        count(*) as tickets_created_last_90d,\n        sum(case when t.resolved_date is null then 1 else 0 end) as open_tickets\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\" t\n    cross join as_of a\n    where t.created_date > a.as_of_date - interval 90 day\n      and t.created_date <= a.as_of_date\n    group by 1\n),\n\npayment_failures_last_90d as (\n    select\n        s.customer_id,\n        count(*) as payment_events_last_90d,\n        sum(case when p.status = 'failed' then 1 else 0 end) as failed_payments_last_90d\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\" p\n    join \"saas_analytics\".\"main_staging\".\"stg_subscriptions\" s\n        on p.subscription_id = s.subscription_id\n    cross join as_of a\n    where p.payment_date > a.as_of_date - interval 90 day\n      and p.payment_date <= a.as_of_date\n    group by 1\n),\n\nscored as (\n    select\n        c.customer_id,\n        a.as_of_date,\n        coalesce(u.events_last_30d, 0) as events_last_30d,\n        coalesce(u.usage_quantity_last_30d, 0) as usage_quantity_last_30d,\n        coalesce(t.tickets_created_last_90d, 0) as tickets_created_last_90d,\n        coalesce(t.open_tickets, 0) as open_tickets,\n        coalesce(p.payment_events_last_90d, 0) as payment_events_last_90d,\n        coalesce(p.failed_payments_last_90d, 0) as failed_payments_last_90d,\n        case\n            when coalesce(p.payment_events_last_90d, 0) = 0 then 0\n            else coalesce(p.failed_payments_last_90d, 0)::double / p.payment_events_last_90d\n        end as payment_failure_rate_last_90d\n    from customers c\n    cross join as_of a\n    left join usage_last_30d u\n        on c.customer_id = u.customer_id\n    left join tickets_last_90d t\n        on c.customer_id = t.customer_id\n    left join payment_failures_last_90d p\n        on c.customer_id = p.customer_id\n),\n\nfinal as (\n    select\n        customer_id,\n        as_of_date,\n        events_last_30d,\n        usage_quantity_last_30d,\n        tickets_created_last_90d,\n        open_tickets,\n        payment_events_last_90d,\n        failed_payments_last_90d,\n        payment_failure_rate_last_90d,\n        least(\n            100,\n            greatest(\n                0,\n                70\n                + least(30, events_last_30d)::integer\n                - least(40, open_tickets * 10)::integer\n                - least(40, (payment_failure_rate_last_90d * 100)::integer)\n            )\n        ) as health_score\n    from scored\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.936701Z", "completed_at": "2026-02-05T21:43:07.942074Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.943423Z", "completed_at": "2026-02-05T21:43:07.943430Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009596586227416992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_monthly_usage", "compiled": true, "compiled_code": "with usage_events as (\n    select\n        customer_id,\n        date_trunc('month', event_date) as usage_month,\n        event_type,\n        usage_quantity\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n),\n\nmonthly_usage as (\n    select\n        customer_id,\n        usage_month,\n        count(*) as event_count,\n        sum(usage_quantity) as total_usage_quantity,\n        sum(case when event_type = 'login' then 1 else 0 end) as login_events,\n        sum(case when event_type = 'feature_usage' then 1 else 0 end) as feature_usage_events,\n        sum(case when event_type = 'export' then 1 else 0 end) as export_events,\n        sum(case when event_type = 'api_call' then 1 else 0 end) as api_call_events\n    from usage_events\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(usage_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_month_id,\n        customer_id,\n        usage_month,\n        event_count,\n        total_usage_quantity,\n        login_events,\n        feature_usage_events,\n        export_events,\n        api_call_events\n    from monthly_usage\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.947828Z", "completed_at": "2026-02-05T21:43:07.955043Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.956422Z", "completed_at": "2026-02-05T21:43:07.956430Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011317729949951172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_usage_events_event_type__login__feature_usage__export__api_call.9e239b4047", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        event_type as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n    group by event_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'login','feature_usage','export','api_call'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.960593Z", "completed_at": "2026-02-05T21:43:07.967153Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.968519Z", "completed_at": "2026-02-05T21:43:07.968526Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010483264923095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_usage_events_usage_quantity__1000000__0.a19ac32495", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and usage_quantity >= 0 and usage_quantity <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.972592Z", "completed_at": "2026-02-05T21:43:07.977511Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.978859Z", "completed_at": "2026-02-05T21:43:07.978866Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008729219436645508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_customer_id.424cb78bfc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.982901Z", "completed_at": "2026-02-05T21:43:07.987744Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.989116Z", "completed_at": "2026-02-05T21:43:07.989123Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00867605209350586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_event_id.2c1891cce4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:07.993271Z", "completed_at": "2026-02-05T21:43:07.998002Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:07.999343Z", "completed_at": "2026-02-05T21:43:07.999350Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00868844985961914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_event_type.b865685b11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_type\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere event_type is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.003418Z", "completed_at": "2026-02-05T21:43:08.008357Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.009692Z", "completed_at": "2026-02-05T21:43:08.009699Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008841514587402344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_usage_quantity.8fafec8a69", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect usage_quantity\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere usage_quantity is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.013780Z", "completed_at": "2026-02-05T21:43:08.020735Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.022128Z", "completed_at": "2026-02-05T21:43:08.022135Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010969877243041992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_usage_events_customer_id__customer_id__ref_stg_customers_.33deb2f692", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.026374Z", "completed_at": "2026-02-05T21:43:08.031021Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.032359Z", "completed_at": "2026-02-05T21:43:08.032366Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008554458618164062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_usage_events_event_id.8f4005aa34", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.036433Z", "completed_at": "2026-02-05T21:43:08.043017Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.044459Z", "completed_at": "2026-02-05T21:43:08.044466Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010616302490234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_dim_customers_customer_segment__smb__mid_market__enterprise__unknown.59f6eba2cc", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.048568Z", "completed_at": "2026-02-05T21:43:08.053506Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.054858Z", "completed_at": "2026-02-05T21:43:08.054866Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008772611618041992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_customer_id.dd91cd1c8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.058996Z", "completed_at": "2026-02-05T21:43:08.064929Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.066273Z", "completed_at": "2026-02-05T21:43:08.066280Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009909391403198242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_customer_segment.bc342ee8ba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.070384Z", "completed_at": "2026-02-05T21:43:08.075273Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.076642Z", "completed_at": "2026-02-05T21:43:08.076649Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008739471435546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_email.ed68b54d1a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere email is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.080734Z", "completed_at": "2026-02-05T21:43:08.085540Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.086887Z", "completed_at": "2026-02-05T21:43:08.086894Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008620738983154297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_signup_date.7f7d0227dd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect signup_date\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere signup_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.090982Z", "completed_at": "2026-02-05T21:43:08.095815Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.097228Z", "completed_at": "2026-02-05T21:43:08.097235Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008744001388549805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_dim_customers_customer_id.15c9f1e2fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.101362Z", "completed_at": "2026-02-05T21:43:08.106423Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.107786Z", "completed_at": "2026-02-05T21:43:08.107793Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009000301361083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_cohorts_cohort_month.5f7f1ecfb6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_month\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\"\nwhere cohort_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.111883Z", "completed_at": "2026-02-05T21:43:08.117917Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.119306Z", "completed_at": "2026-02-05T21:43:08.119313Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009996414184570312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_cohorts_customer_id.a75833fcff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.123411Z", "completed_at": "2026-02-05T21:43:08.128205Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.129566Z", "completed_at": "2026-02-05T21:43:08.129573Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008734941482543945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_customer_cohorts_customer_id.279a739d39", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.133673Z", "completed_at": "2026-02-05T21:43:08.139199Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.140592Z", "completed_at": "2026-02-05T21:43:08.140599Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009489297866821289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_payment_history_net_amount__1000000000___1000000000.297926e2b5", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and net_amount >= -1000000000 and net_amount <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.144722Z", "completed_at": "2026-02-05T21:43:08.150106Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.151472Z", "completed_at": "2026-02-05T21:43:08.151479Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0092620849609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_payment_history_payment_count__100000000__0.41e5b20a2f", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and payment_count >= 0 and payment_count <= 100000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.155622Z", "completed_at": "2026-02-05T21:43:08.161555Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.162897Z", "completed_at": "2026-02-05T21:43:08.162919Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009841203689575195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_net_amount.c0b496bbc8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect net_amount\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere net_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.166963Z", "completed_at": "2026-02-05T21:43:08.171743Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.173121Z", "completed_at": "2026-02-05T21:43:08.173128Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008696317672729492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_payment_count.c9d746fa8b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_count\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere payment_count is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.177170Z", "completed_at": "2026-02-05T21:43:08.182012Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.183347Z", "completed_at": "2026-02-05T21:43:08.183354Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008642911911010742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_payment_month.218496379c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_month\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere payment_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.187371Z", "completed_at": "2026-02-05T21:43:08.192305Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.193646Z", "completed_at": "2026-02-05T21:43:08.193652Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008748531341552734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_subscription_id.f530bb3c51", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.197674Z", "completed_at": "2026-02-05T21:43:08.202541Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.203888Z", "completed_at": "2026-02-05T21:43:08.203895Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008672237396240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_subscription_month_id.ea8c983f61", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_month_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere subscription_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.208035Z", "completed_at": "2026-02-05T21:43:08.215090Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.216451Z", "completed_at": "2026-02-05T21:43:08.216458Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011020421981811523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_payment_history_subscription_id__subscription_id__ref_stg_subscriptions_.c2dc1d48a4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select subscription_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\n    where subscription_id is not null\n),\n\nparent as (\n    select subscription_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.220543Z", "completed_at": "2026-02-05T21:43:08.225351Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.226708Z", "completed_at": "2026-02-05T21:43:08.226715Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008696317672729492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_payment_history_subscription_month_id.d1f891bb75", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere subscription_month_id is not null\ngroup by subscription_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.230749Z", "completed_at": "2026-02-05T21:43:08.235759Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.237139Z", "completed_at": "2026-02-05T21:43:08.237147Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008841753005981445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_dim_plans_plan_tier__starter__professional__enterprise.951b43f83d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        plan_tier as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n    group by plan_tier\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'starter','professional','enterprise'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.241201Z", "completed_at": "2026-02-05T21:43:08.246685Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.248099Z", "completed_at": "2026-02-05T21:43:08.248106Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00940704345703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_dim_plans_base_price_annual__1000000__0.3da0c08240", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_annual >= 0 and base_price_annual <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.252245Z", "completed_at": "2026-02-05T21:43:08.258820Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.260205Z", "completed_at": "2026-02-05T21:43:08.260212Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010566473007202148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_dim_plans_base_price_monthly__100000__0.80491e18f9", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_monthly >= 0 and base_price_monthly <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.264285Z", "completed_at": "2026-02-05T21:43:08.269059Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.270398Z", "completed_at": "2026-02-05T21:43:08.270405Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008604049682617188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_base_price_annual.eee138969b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_annual\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere base_price_annual is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.274454Z", "completed_at": "2026-02-05T21:43:08.279344Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.280690Z", "completed_at": "2026-02-05T21:43:08.280697Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008694887161254883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_base_price_monthly.0aa94d6b4b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_monthly\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere base_price_monthly is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.284674Z", "completed_at": "2026-02-05T21:43:08.289689Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.291111Z", "completed_at": "2026-02-05T21:43:08.291118Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00889897346496582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_plan_id.78a937462a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.295254Z", "completed_at": "2026-02-05T21:43:08.300134Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.301462Z", "completed_at": "2026-02-05T21:43:08.301469Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008811712265014648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_plan_tier.154dd327a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_tier\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere plan_tier is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.305515Z", "completed_at": "2026-02-05T21:43:08.311657Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.313035Z", "completed_at": "2026-02-05T21:43:08.313043Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009986162185668945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_dim_plans_plan_id.27d8cecd0f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    plan_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere plan_id is not null\ngroup by plan_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.317086Z", "completed_at": "2026-02-05T21:43:08.322728Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.324116Z", "completed_at": "2026-02-05T21:43:08.324123Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009523153305053711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.churn_analysis", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\ncustomer_month_spine as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        m.date_month\n    from customers c\n    cross join months m\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\nwith_prev as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        lag(mrr_amount) over (partition by customer_id order by date_month) as prev_mrr_amount\n    from customer_mrr\n),\n\nmonthly as (\n    select\n        date_month,\n        customer_segment,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 then 1 else 0 end) as starting_customers,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then 1 else 0 end) as churned_customers,\n        sum(coalesce(prev_mrr_amount, 0)) as starting_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then coalesce(prev_mrr_amount, 0) else 0 end) as churned_mrr\n    from with_prev\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_month_id,\n        date_month,\n        customer_segment,\n        starting_customers,\n        churned_customers,\n        case\n            when starting_customers = 0 then 0\n            else churned_customers::double / starting_customers\n        end as customer_churn_rate,\n        starting_mrr,\n        churned_mrr,\n        case\n            when starting_mrr = 0 then 0\n            else churned_mrr / starting_mrr\n        end as revenue_churn_rate\n    from monthly\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"churn_analysis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.328600Z", "completed_at": "2026-02-05T21:43:08.334384Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.335742Z", "completed_at": "2026-02-05T21:43:08.335749Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00993800163269043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.cohort_retention", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncohorts as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        date_trunc('month', c.signup_date) as cohort_month\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\" c\n),\n\ncohort_sizes as (\n    select\n        cohort_month,\n        customer_segment,\n        count(*) as cohort_customers\n    from cohorts\n    group by 1, 2\n),\n\ncustomer_month_spine as (\n    select\n        co.customer_id,\n        co.customer_segment,\n        co.cohort_month,\n        m.date_month\n    from cohorts co\n    join months m\n        on m.date_month >= co.cohort_month\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.cohort_month,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\nactive_customers as (\n    select\n        cohort_month,\n        customer_segment,\n        date_month,\n        datediff('month', cohort_month, date_month) as months_since_signup,\n        count(distinct case when mrr_amount > 0 then customer_id end) as active_customers\n    from customer_mrr\n    group by 1, 2, 3, 4\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(a.customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(a.cohort_month as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(a.months_since_signup as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as cohort_segment_period_id,\n        a.cohort_month,\n        a.customer_segment,\n        a.months_since_signup,\n        a.date_month as active_month,\n        s.cohort_customers,\n        a.active_customers,\n        case\n            when s.cohort_customers = 0 then 0\n            else a.active_customers::double / s.cohort_customers\n        end as retention_rate\n    from active_customers a\n    join cohort_sizes s\n        on a.cohort_month = s.cohort_month\n        and a.customer_segment = s.customer_segment\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"cohort_retention\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.340203Z", "completed_at": "2026-02-05T21:43:08.345829Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.347194Z", "completed_at": "2026-02-05T21:43:08.347201Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00953364372253418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.mrr_analysis", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\ncustomer_month_spine as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        m.date_month\n    from customers c\n    cross join months m\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\ncustomer_mrr_with_prev as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        lag(mrr_amount) over (partition by customer_id order by date_month) as prev_mrr_amount\n    from customer_mrr\n),\n\nclassified as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        coalesce(prev_mrr_amount, 0) as prev_mrr_amount,\n        mrr_amount - coalesce(prev_mrr_amount, 0) as mrr_change,\n        case\n            when coalesce(prev_mrr_amount, 0) = 0 and mrr_amount > 0 then 'new'\n            when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then 'churn'\n            when mrr_amount > coalesce(prev_mrr_amount, 0) and coalesce(prev_mrr_amount, 0) > 0 then 'expansion'\n            when mrr_amount < coalesce(prev_mrr_amount, 0) and mrr_amount > 0 then 'contraction'\n            else 'no_change'\n        end as mrr_movement_type\n    from customer_mrr_with_prev\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_month_id,\n        date_month,\n        customer_segment,\n        sum(mrr_amount) as total_mrr,\n        sum(case when mrr_movement_type = 'new' then mrr_amount else 0 end) as new_mrr,\n        sum(case when mrr_movement_type = 'expansion' then mrr_change else 0 end) as expansion_mrr,\n        sum(case when mrr_movement_type = 'contraction' then abs(mrr_change) else 0 end) as contraction_mrr,\n        sum(case when mrr_movement_type = 'churn' then prev_mrr_amount else 0 end) as churned_mrr,\n        sum(case when mrr_movement_type in ('new', 'expansion') then mrr_change else 0 end)\n        - sum(case when mrr_movement_type in ('contraction', 'churn') then abs(mrr_change) else 0 end) as net_new_mrr\n    from classified\n    group by 1, 2, 3\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"mrr_analysis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.351551Z", "completed_at": "2026-02-05T21:43:08.358359Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.359725Z", "completed_at": "2026-02-05T21:43:08.359732Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01067662239074707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.net_revenue_retention", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\ncustomer_month_spine as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        m.date_month\n    from customers c\n    cross join months m\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\nwith_prev as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        lag(mrr_amount) over (partition by customer_id order by date_month) as prev_mrr_amount\n    from customer_mrr\n),\n\nmovement as (\n    select\n        date_month,\n        customer_segment,\n        sum(coalesce(prev_mrr_amount, 0)) as starting_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount > coalesce(prev_mrr_amount, 0) then mrr_amount - prev_mrr_amount else 0 end) as expansion_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount > 0 and mrr_amount < coalesce(prev_mrr_amount, 0) then prev_mrr_amount - mrr_amount else 0 end) as contraction_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then prev_mrr_amount else 0 end) as churned_mrr\n    from with_prev\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_month_id,\n        date_month,\n        customer_segment,\n        starting_mrr,\n        expansion_mrr,\n        contraction_mrr,\n        churned_mrr,\n        case\n            when starting_mrr = 0 then 0\n            else (starting_mrr + expansion_mrr - contraction_mrr - churned_mrr) / starting_mrr\n        end as net_revenue_retention,\n        case\n            when starting_mrr = 0 then 0\n            else (starting_mrr - contraction_mrr - churned_mrr) / starting_mrr\n        end as gross_revenue_retention\n    from movement\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"net_revenue_retention\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.364106Z", "completed_at": "2026-02-05T21:43:08.369578Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.370969Z", "completed_at": "2026-02-05T21:43:08.370976Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009401798248291016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_fct_monthly_recurring_revenue_mrr_amount__1000000__0.30bcc21edd", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.375041Z", "completed_at": "2026-02-05T21:43:08.379783Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.381146Z", "completed_at": "2026-02-05T21:43:08.381152Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00858616828918457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_customer_id.a66423ce4f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.385172Z", "completed_at": "2026-02-05T21:43:08.390085Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.391415Z", "completed_at": "2026-02-05T21:43:08.391422Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008753061294555664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_customer_month_id.b7a062ebbc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_month_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere customer_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.395511Z", "completed_at": "2026-02-05T21:43:08.401710Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.403082Z", "completed_at": "2026-02-05T21:43:08.403089Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010020732879638672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_date_month.8089d21391", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.407087Z", "completed_at": "2026-02-05T21:43:08.411826Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.413195Z", "completed_at": "2026-02-05T21:43:08.413202Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008577585220336914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_mrr_amount.4c2963d658", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.417267Z", "completed_at": "2026-02-05T21:43:08.423152Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.424506Z", "completed_at": "2026-02-05T21:43:08.424514Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009759902954101562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_fct_monthly_recurring_revenue_customer_id__customer_id__ref_dim_customers_.09138f6532", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.428540Z", "completed_at": "2026-02-05T21:43:08.433243Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.434577Z", "completed_at": "2026-02-05T21:43:08.434584Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008534669876098633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_fct_monthly_recurring_revenue_customer_month_id.a9d2287217", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere customer_month_id is not null\ngroup by customer_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.438613Z", "completed_at": "2026-02-05T21:43:08.443719Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.445088Z", "completed_at": "2026-02-05T21:43:08.445095Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009028911590576172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_fct_subscriptions_billing_cycle__monthly__annual.f19036f213", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        billing_cycle as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    group by billing_cycle\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'monthly','annual'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.449240Z", "completed_at": "2026-02-05T21:43:08.455599Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.456980Z", "completed_at": "2026-02-05T21:43:08.456992Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010283470153808594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_fct_subscriptions_status__active__paused__churned__upgraded__downgraded.15fca4795f", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','paused','churned','upgraded','downgraded'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.461039Z", "completed_at": "2026-02-05T21:43:08.466367Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.467735Z", "completed_at": "2026-02-05T21:43:08.467742Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00919485092163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_fct_subscriptions_amount__1000000__0.21af0e0ca7", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and amount >= 0 and amount <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.471815Z", "completed_at": "2026-02-05T21:43:08.477257Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.478631Z", "completed_at": "2026-02-05T21:43:08.478639Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009305238723754883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_fct_subscriptions_mrr_amount__100000__0.b7f8e4f817", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.482737Z", "completed_at": "2026-02-05T21:43:08.487655Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.489011Z", "completed_at": "2026-02-05T21:43:08.489019Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008748054504394531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_amount.77f80a5332", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.493047Z", "completed_at": "2026-02-05T21:43:08.497868Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.499219Z", "completed_at": "2026-02-05T21:43:08.499227Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008710622787475586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_billing_cycle.0a7a17a18b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect billing_cycle\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere billing_cycle is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.503263Z", "completed_at": "2026-02-05T21:43:08.509356Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.510693Z", "completed_at": "2026-02-05T21:43:08.510700Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009988784790039062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_customer_id.ae33a3a9d8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.514713Z", "completed_at": "2026-02-05T21:43:08.519715Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.521082Z", "completed_at": "2026-02-05T21:43:08.521089Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008817434310913086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_mrr_amount.0b5f93cb94", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.525099Z", "completed_at": "2026-02-05T21:43:08.529848Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.531198Z", "completed_at": "2026-02-05T21:43:08.531206Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008554697036743164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_plan_id.07baa591b1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.535196Z", "completed_at": "2026-02-05T21:43:08.540068Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.541411Z", "completed_at": "2026-02-05T21:43:08.541419Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008686304092407227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_status.daa1b1fe34", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.545493Z", "completed_at": "2026-02-05T21:43:08.614111Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.615473Z", "completed_at": "2026-02-05T21:43:08.615484Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07254886627197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_subscription_id.f690e778b1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.619599Z", "completed_at": "2026-02-05T21:43:08.625488Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.626812Z", "completed_at": "2026-02-05T21:43:08.626819Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00974416732788086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_fct_subscriptions_customer_id__customer_id__ref_dim_customers_.738b2dd4ca", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.630947Z", "completed_at": "2026-02-05T21:43:08.636534Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.637879Z", "completed_at": "2026-02-05T21:43:08.637889Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009389638900756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_fct_subscriptions_plan_id__plan_id__ref_dim_plans_.09ecb91cb5", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select plan_id as from_field\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    where plan_id is not null\n),\n\nparent as (\n    select plan_id as to_field\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.641970Z", "completed_at": "2026-02-05T21:43:08.646643Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.647992Z", "completed_at": "2026-02-05T21:43:08.647999Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008522987365722656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_fct_subscriptions_subscription_id.71386a928a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.651949Z", "completed_at": "2026-02-05T21:43:08.657347Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.658715Z", "completed_at": "2026-02-05T21:43:08.658723Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009231090545654297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_subscription_periods_mrr_amount__100000__0.32396aeab0", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.662772Z", "completed_at": "2026-02-05T21:43:08.668531Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.669856Z", "completed_at": "2026-02-05T21:43:08.669863Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009545326232910156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_subscription_periods_customer_id.33a91ad17a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.673886Z", "completed_at": "2026-02-05T21:43:08.678696Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.680069Z", "completed_at": "2026-02-05T21:43:08.680076Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008702754974365234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_subscription_periods_mrr_amount.c3d6239f36", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.684093Z", "completed_at": "2026-02-05T21:43:08.688960Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.690338Z", "completed_at": "2026-02-05T21:43:08.690345Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008706331253051758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_subscription_periods_subscription_id.228100b7db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.694383Z", "completed_at": "2026-02-05T21:43:08.700023Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.701373Z", "completed_at": "2026-02-05T21:43:08.701380Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009538412094116211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_subscription_periods_customer_id__customer_id__ref_stg_customers_.d2a65dcd76", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.705442Z", "completed_at": "2026-02-05T21:43:08.711060Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.712390Z", "completed_at": "2026-02-05T21:43:08.712397Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009480953216552734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_subscription_periods_subscription_id.213d4156ea", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.716389Z", "completed_at": "2026-02-05T21:43:08.721753Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.723130Z", "completed_at": "2026-02-05T21:43:08.723137Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009275197982788086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_customer_health_score_health_score__100__0.0fbd6b513b", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and health_score >= 0 and health_score <= 100\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.727174Z", "completed_at": "2026-02-05T21:43:08.732436Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.733801Z", "completed_at": "2026-02-05T21:43:08.733807Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009113550186157227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_customer_health_score_payment_failure_rate_last_90d__1__0.7e1e7e5f41", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and payment_failure_rate_last_90d >= 0 and payment_failure_rate_last_90d <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.737882Z", "completed_at": "2026-02-05T21:43:08.742727Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.744091Z", "completed_at": "2026-02-05T21:43:08.744098Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008742570877075195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_as_of_date.36d720fd53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect as_of_date\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere as_of_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.748132Z", "completed_at": "2026-02-05T21:43:08.753028Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.754381Z", "completed_at": "2026-02-05T21:43:08.754388Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008717536926269531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_customer_id.270547872f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.758451Z", "completed_at": "2026-02-05T21:43:08.764312Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.765668Z", "completed_at": "2026-02-05T21:43:08.765675Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009760856628417969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_health_score.f383d46da2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect health_score\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere health_score is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.769666Z", "completed_at": "2026-02-05T21:43:08.774750Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.776123Z", "completed_at": "2026-02-05T21:43:08.776130Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008952856063842773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_payment_failure_rate_last_90d.e26d5a38c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_failure_rate_last_90d\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere payment_failure_rate_last_90d is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.780172Z", "completed_at": "2026-02-05T21:43:08.785831Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.787201Z", "completed_at": "2026-02-05T21:43:08.787208Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009580850601196289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_customer_health_score_customer_id__customer_id__ref_stg_customers_.fe675ec61f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.791401Z", "completed_at": "2026-02-05T21:43:08.795969Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.797303Z", "completed_at": "2026-02-05T21:43:08.797310Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008536577224731445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_customer_health_score_customer_id.d7e00c064a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.801333Z", "completed_at": "2026-02-05T21:43:08.807658Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.809044Z", "completed_at": "2026-02-05T21:43:08.809051Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010185718536376953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_monthly_usage_event_count__100000000__0.7fcfb98d27", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and event_count >= 0 and event_count <= 100000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.813121Z", "completed_at": "2026-02-05T21:43:08.818552Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.819959Z", "completed_at": "2026-02-05T21:43:08.819966Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009397268295288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_monthly_usage_total_usage_quantity__1000000000__0.a3a21278a6", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and total_usage_quantity >= 0 and total_usage_quantity <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.824057Z", "completed_at": "2026-02-05T21:43:08.828751Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.830102Z", "completed_at": "2026-02-05T21:43:08.830109Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00861358642578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_customer_id.9f5a52035d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.834153Z", "completed_at": "2026-02-05T21:43:08.839061Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.840416Z", "completed_at": "2026-02-05T21:43:08.840423Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008800983428955078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_customer_month_id.74f34aceba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_month_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere customer_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.844524Z", "completed_at": "2026-02-05T21:43:08.849397Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.850731Z", "completed_at": "2026-02-05T21:43:08.850737Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008762359619140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_event_count.823f19e9a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_count\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere event_count is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.854717Z", "completed_at": "2026-02-05T21:43:08.860731Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.862086Z", "completed_at": "2026-02-05T21:43:08.862093Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009800195693969727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_total_usage_quantity.9c8d7d37db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_usage_quantity\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere total_usage_quantity is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.866077Z", "completed_at": "2026-02-05T21:43:08.870946Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.872289Z", "completed_at": "2026-02-05T21:43:08.872296Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00873255729675293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_usage_month.5593c46a18", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect usage_month\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere usage_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.876332Z", "completed_at": "2026-02-05T21:43:08.882059Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.883447Z", "completed_at": "2026-02-05T21:43:08.883455Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009676694869995117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_monthly_usage_customer_id__customer_id__ref_stg_customers_.46c0ada6b9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.887476Z", "completed_at": "2026-02-05T21:43:08.892197Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.893524Z", "completed_at": "2026-02-05T21:43:08.893531Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008478641510009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_monthly_usage_customer_month_id.50e00ffb9c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere customer_month_id is not null\ngroup by customer_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.897503Z", "completed_at": "2026-02-05T21:43:08.904268Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.905614Z", "completed_at": "2026-02-05T21:43:08.905621Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010538578033447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.customer_lifetime_value", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n    where date_month >= '2022-06-01'  -- Start after 6 months of data exists\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\nmrr as (\n    select\n        customer_id,\n        date_month,\n        mrr_amount\n    from \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\n),\n\nchurn as (\n    select\n        date_month,\n        customer_segment,\n        customer_churn_rate\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n),\n\n-- For each as_of_month, calculate ARPU using trailing 6 months\nsegment_arpu_by_month as (\n    select\n        m.date_month as as_of_month,\n        c.customer_segment,\n        avg(case when mrr.mrr_amount > 0 then mrr.mrr_amount end) as arpu\n    from months m\n    cross join customers c\n    left join mrr\n        on c.customer_id = mrr.customer_id\n        and mrr.date_month > m.date_month - interval 6 month\n        and mrr.date_month <= m.date_month\n    group by 1, 2\n),\n\n-- For each as_of_month, calculate avg churn using trailing 6 months\nsegment_churn_by_month as (\n    select\n        m.date_month as as_of_month,\n        ch.customer_segment,\n        avg(ch.customer_churn_rate) as avg_monthly_customer_churn_rate\n    from months m\n    join churn ch\n        on ch.date_month > m.date_month - interval 6 month\n        and ch.date_month <= m.date_month\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(a.as_of_month as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(coalesce(a.customer_segment, ch.customer_segment) as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_as_of_id,\n        a.as_of_month,\n        coalesce(a.customer_segment, ch.customer_segment) as customer_segment,\n        coalesce(a.arpu, 0) as arpu,\n        coalesce(ch.avg_monthly_customer_churn_rate, 0) as avg_monthly_customer_churn_rate,\n        case\n            when coalesce(ch.avg_monthly_customer_churn_rate, 0) = 0 then null\n            else least(120, 1.0 / ch.avg_monthly_customer_churn_rate)\n        end as expected_lifetime_months,\n        case\n            when coalesce(ch.avg_monthly_customer_churn_rate, 0) = 0 then null\n            else coalesce(a.arpu, 0) * least(120, 1.0 / ch.avg_monthly_customer_churn_rate)\n        end as lifetime_value\n    from segment_arpu_by_month a\n    full outer join segment_churn_by_month ch\n        on a.as_of_month = ch.as_of_month\n        and a.customer_segment = ch.customer_segment\n    where coalesce(a.as_of_month, ch.as_of_month) is not null\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"customer_lifetime_value\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.909998Z", "completed_at": "2026-02-05T21:43:08.915117Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.916487Z", "completed_at": "2026-02-05T21:43:08.916494Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009241342544555664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_churn_analysis_customer_segment__smb__mid_market__enterprise__unknown.12ff3b906a", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.920548Z", "completed_at": "2026-02-05T21:43:08.925805Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.927226Z", "completed_at": "2026-02-05T21:43:08.927233Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009156465530395508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_churned_customers__1000000000__0.ecf0d4d6a8", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and churned_customers >= 0 and churned_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.931322Z", "completed_at": "2026-02-05T21:43:08.936727Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.938101Z", "completed_at": "2026-02-05T21:43:08.938108Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009282827377319336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_customer_churn_rate__1__0.a3521c9c86", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and customer_churn_rate >= 0 and customer_churn_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.942170Z", "completed_at": "2026-02-05T21:43:08.947615Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.949012Z", "completed_at": "2026-02-05T21:43:08.949019Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009398937225341797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_revenue_churn_rate__1__0.ca578782ea", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and revenue_churn_rate >= 0 and revenue_churn_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.953112Z", "completed_at": "2026-02-05T21:43:08.959737Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.961399Z", "completed_at": "2026-02-05T21:43:08.961407Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010852813720703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_starting_customers__1000000000__0.434546e5eb", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and starting_customers >= 0 and starting_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.965556Z", "completed_at": "2026-02-05T21:43:08.970380Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.971716Z", "completed_at": "2026-02-05T21:43:08.971723Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00873112678527832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_churned_customers.8445fc5f8a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect churned_customers\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere churned_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.975786Z", "completed_at": "2026-02-05T21:43:08.980645Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.982023Z", "completed_at": "2026-02-05T21:43:08.982031Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008728265762329102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_customer_churn_rate.b2257552ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_churn_rate\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere customer_churn_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.986135Z", "completed_at": "2026-02-05T21:43:08.990889Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:08.992231Z", "completed_at": "2026-02-05T21:43:08.992238Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008774518966674805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_customer_segment.f82e1dbd2a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:08.996439Z", "completed_at": "2026-02-05T21:43:09.002266Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.003602Z", "completed_at": "2026-02-05T21:43:09.003609Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009735345840454102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_date_month.aeceb24cdf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.007622Z", "completed_at": "2026-02-05T21:43:09.012485Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.013820Z", "completed_at": "2026-02-05T21:43:09.013827Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008635282516479492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_revenue_churn_rate.f68037cf43", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect revenue_churn_rate\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere revenue_churn_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.017842Z", "completed_at": "2026-02-05T21:43:09.022579Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.023933Z", "completed_at": "2026-02-05T21:43:09.023941Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008512258529663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_segment_month_id.face7d9329", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_month_id\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere segment_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.027959Z", "completed_at": "2026-02-05T21:43:09.032797Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.034148Z", "completed_at": "2026-02-05T21:43:09.034155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00871586799621582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_starting_customers.5eb8964198", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect starting_customers\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere starting_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.038134Z", "completed_at": "2026-02-05T21:43:09.042967Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.044303Z", "completed_at": "2026-02-05T21:43:09.044310Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008737802505493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_churn_analysis_segment_month_id.d17ebe9d07", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere segment_month_id is not null\ngroup by segment_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.048402Z", "completed_at": "2026-02-05T21:43:09.054603Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.055980Z", "completed_at": "2026-02-05T21:43:09.055988Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010046958923339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_cohort_retention_customer_segment__smb__mid_market__enterprise__unknown.537731c238", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.060060Z", "completed_at": "2026-02-05T21:43:09.065433Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.066812Z", "completed_at": "2026-02-05T21:43:09.066819Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009332895278930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_active_customers__1000000000__0.c41f1ccb43", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and active_customers >= 0 and active_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.070936Z", "completed_at": "2026-02-05T21:43:09.076341Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.077708Z", "completed_at": "2026-02-05T21:43:09.077715Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00930023193359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_cohort_customers__1000000000__0.3ded49037c", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and cohort_customers >= 0 and cohort_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.081834Z", "completed_at": "2026-02-05T21:43:09.087319Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.088692Z", "completed_at": "2026-02-05T21:43:09.088699Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009368419647216797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_months_since_signup__120__0.3abf594756", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and months_since_signup >= 0 and months_since_signup <= 120\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.092832Z", "completed_at": "2026-02-05T21:43:09.099204Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.100574Z", "completed_at": "2026-02-05T21:43:09.100581Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010254383087158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_retention_rate__1__0.75ce1e0e47", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and retention_rate >= 0 and retention_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.104676Z", "completed_at": "2026-02-05T21:43:09.109574Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.110924Z", "completed_at": "2026-02-05T21:43:09.110931Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008749723434448242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_active_customers.f50b652fd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect active_customers\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere active_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.114952Z", "completed_at": "2026-02-05T21:43:09.119725Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.121077Z", "completed_at": "2026-02-05T21:43:09.121084Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008593559265136719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_cohort_customers.37da0ff420", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_customers\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.125072Z", "completed_at": "2026-02-05T21:43:09.129961Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.131298Z", "completed_at": "2026-02-05T21:43:09.131305Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008683919906616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_cohort_month.0e607e02af", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_month\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.135394Z", "completed_at": "2026-02-05T21:43:09.140264Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.141593Z", "completed_at": "2026-02-05T21:43:09.141600Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008788585662841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_cohort_segment_period_id.0d29ee4706", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_segment_period_id\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_segment_period_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.145614Z", "completed_at": "2026-02-05T21:43:09.151637Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.152983Z", "completed_at": "2026-02-05T21:43:09.152990Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00987553596496582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_customer_segment.c697b5eb0e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.156965Z", "completed_at": "2026-02-05T21:43:09.161758Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.163126Z", "completed_at": "2026-02-05T21:43:09.163133Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008626222610473633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_months_since_signup.41d00203f4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect months_since_signup\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere months_since_signup is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.167187Z", "completed_at": "2026-02-05T21:43:09.172039Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.173366Z", "completed_at": "2026-02-05T21:43:09.173373Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008657217025756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_retention_rate.8166dc37e8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect retention_rate\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere retention_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.177373Z", "completed_at": "2026-02-05T21:43:09.182047Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.183390Z", "completed_at": "2026-02-05T21:43:09.183397Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008550643920898438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_cohort_retention_cohort_segment_period_id.5afcaa3a16", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    cohort_segment_period_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_segment_period_id is not null\ngroup by cohort_segment_period_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.187422Z", "completed_at": "2026-02-05T21:43:09.193427Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.194794Z", "completed_at": "2026-02-05T21:43:09.194802Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009919404983520508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_mrr_analysis_customer_segment__smb__mid_market__enterprise__unknown.1257e5343c", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.198847Z", "completed_at": "2026-02-05T21:43:09.204314Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.205721Z", "completed_at": "2026-02-05T21:43:09.205728Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00942373275756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_mrr_analysis_churned_mrr__1000000000__0.5cafc45ab5", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and churned_mrr >= 0 and churned_mrr <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.209873Z", "completed_at": "2026-02-05T21:43:09.215290Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.216660Z", "completed_at": "2026-02-05T21:43:09.216669Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009363651275634766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_mrr_analysis_new_mrr__1000000000__0.1d1f2a56be", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and new_mrr >= 0 and new_mrr <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.220862Z", "completed_at": "2026-02-05T21:43:09.226306Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.227677Z", "completed_at": "2026-02-05T21:43:09.227685Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009433269500732422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_mrr_analysis_total_mrr__1000000000__0.03c10ae006", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and total_mrr >= 0 and total_mrr <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.231827Z", "completed_at": "2026-02-05T21:43:09.236760Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.238128Z", "completed_at": "2026-02-05T21:43:09.238136Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008850812911987305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_churned_mrr.a3d399ce96", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect churned_mrr\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere churned_mrr is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.242168Z", "completed_at": "2026-02-05T21:43:09.248172Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.249527Z", "completed_at": "2026-02-05T21:43:09.249534Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009851455688476562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_customer_segment.c66caf3809", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.253582Z", "completed_at": "2026-02-05T21:43:09.258404Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.259728Z", "completed_at": "2026-02-05T21:43:09.259735Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008599042892456055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_date_month.b31589f01e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.263750Z", "completed_at": "2026-02-05T21:43:09.268671Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.270071Z", "completed_at": "2026-02-05T21:43:09.270079Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008833646774291992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_new_mrr.7bd7ba8daa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect new_mrr\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere new_mrr is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.274135Z", "completed_at": "2026-02-05T21:43:09.278821Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.280197Z", "completed_at": "2026-02-05T21:43:09.280204Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008542776107788086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_segment_month_id.96b64accac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_month_id\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere segment_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.284218Z", "completed_at": "2026-02-05T21:43:09.290131Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.291477Z", "completed_at": "2026-02-05T21:43:09.291484Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009711027145385742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_total_mrr.80e9772030", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_mrr\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere total_mrr is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.295564Z", "completed_at": "2026-02-05T21:43:09.300261Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.301594Z", "completed_at": "2026-02-05T21:43:09.301601Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008594036102294922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_mrr_analysis_segment_month_id.73b748be94", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere segment_month_id is not null\ngroup by segment_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.305601Z", "completed_at": "2026-02-05T21:43:09.310742Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.312165Z", "completed_at": "2026-02-05T21:43:09.312172Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009053468704223633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_net_revenue_retention_customer_segment__smb__mid_market__enterprise__unknown.bad1f7855d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.316257Z", "completed_at": "2026-02-05T21:43:09.321699Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.323096Z", "completed_at": "2026-02-05T21:43:09.323103Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009351491928100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_net_revenue_retention_gross_revenue_retention__1__0.069667a4ae", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and gross_revenue_retention >= 0 and gross_revenue_retention <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.327202Z", "completed_at": "2026-02-05T21:43:09.332553Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.333961Z", "completed_at": "2026-02-05T21:43:09.333968Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00933218002319336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_net_revenue_retention_net_revenue_retention__5__0.02505b257b", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and net_revenue_retention >= 0 and net_revenue_retention <= 5\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.338088Z", "completed_at": "2026-02-05T21:43:09.344127Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.345466Z", "completed_at": "2026-02-05T21:43:09.345473Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009954214096069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_customer_segment.a64b766957", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.349465Z", "completed_at": "2026-02-05T21:43:09.354358Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.355705Z", "completed_at": "2026-02-05T21:43:09.355712Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008767127990722656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_date_month.8b7a8fb0c8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.359801Z", "completed_at": "2026-02-05T21:43:09.364515Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.365842Z", "completed_at": "2026-02-05T21:43:09.365849Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008581161499023438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_gross_revenue_retention.11b3e16b67", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect gross_revenue_retention\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere gross_revenue_retention is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.369856Z", "completed_at": "2026-02-05T21:43:09.374710Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.376084Z", "completed_at": "2026-02-05T21:43:09.376091Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008729696273803711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_net_revenue_retention.8a6d154e31", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect net_revenue_retention\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere net_revenue_retention is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.380150Z", "completed_at": "2026-02-05T21:43:09.386129Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.387465Z", "completed_at": "2026-02-05T21:43:09.387472Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00992441177368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_segment_month_id.64a6b596d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_month_id\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere segment_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.391546Z", "completed_at": "2026-02-05T21:43:09.396169Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.397532Z", "completed_at": "2026-02-05T21:43:09.397539Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008443117141723633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_net_revenue_retention_segment_month_id.cc84fd260d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere segment_month_id is not null\ngroup by segment_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.401552Z", "completed_at": "2026-02-05T21:43:09.407192Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.408531Z", "completed_at": "2026-02-05T21:43:09.408538Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00942540168762207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.unit_economics", "compiled": true, "compiled_code": "with ltv as (\n    select\n        as_of_month,\n        customer_segment,\n        arpu,\n        avg_monthly_customer_churn_rate,\n        expected_lifetime_months,\n        lifetime_value\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n),\n\nwith_cac as (\n    select\n        as_of_month,\n        customer_segment,\n        arpu,\n        avg_monthly_customer_churn_rate,\n        expected_lifetime_months,\n        lifetime_value,\n        case\n            when customer_segment = 'smb' then 600\n            when customer_segment = 'mid-market' then 2500\n            when customer_segment = 'enterprise' then 12000\n            else null\n        end as assumed_cac\n    from ltv\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(as_of_month as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_as_of_id,\n        as_of_month,\n        customer_segment,\n        arpu,\n        avg_monthly_customer_churn_rate,\n        expected_lifetime_months,\n        lifetime_value,\n        assumed_cac,\n        case\n            when assumed_cac is null or assumed_cac = 0 then null\n            else lifetime_value / assumed_cac\n        end as ltv_to_cac_ratio,\n        case\n            when arpu is null or arpu = 0 or assumed_cac is null then null\n            else assumed_cac / arpu\n        end as payback_months\n    from with_cac\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"unit_economics\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.412886Z", "completed_at": "2026-02-05T21:43:09.417966Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.419330Z", "completed_at": "2026-02-05T21:43:09.419338Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009145736694335938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_customer_lifetime_value_customer_segment__smb__mid_market__enterprise__unknown.d1b95c9570", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.423384Z", "completed_at": "2026-02-05T21:43:09.428801Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.430207Z", "completed_at": "2026-02-05T21:43:09.430215Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009311914443969727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_arpu__1000000__0.149ff1813f", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and arpu >= 0 and arpu <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.434302Z", "completed_at": "2026-02-05T21:43:09.440796Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.442184Z", "completed_at": "2026-02-05T21:43:09.442191Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010418176651000977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_avg_monthly_customer_churn_rate__1__0.02204de856", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and avg_monthly_customer_churn_rate >= 0 and avg_monthly_customer_churn_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.446289Z", "completed_at": "2026-02-05T21:43:09.452216Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.453586Z", "completed_at": "2026-02-05T21:43:09.453593Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009804725646972656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_expected_lifetime_months__120__0__expected_lifetime_months_is_not_null.5d159b06eb", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and expected_lifetime_months >= 0 and expected_lifetime_months <= 120\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    where\n        expected_lifetime_months is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.457688Z", "completed_at": "2026-02-05T21:43:09.463691Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.465092Z", "completed_at": "2026-02-05T21:43:09.465099Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009907722473144531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_lifetime_value__1000000000__0__lifetime_value_is_not_null.1e26703122", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and lifetime_value >= 0 and lifetime_value <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    where\n        lifetime_value is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.469202Z", "completed_at": "2026-02-05T21:43:09.473963Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.475313Z", "completed_at": "2026-02-05T21:43:09.475320Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00867772102355957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_arpu.68cf958b17", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect arpu\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere arpu is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.479351Z", "completed_at": "2026-02-05T21:43:09.485169Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.486509Z", "completed_at": "2026-02-05T21:43:09.486516Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009608030319213867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_as_of_month.2440beb6c2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect as_of_month\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere as_of_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.490529Z", "completed_at": "2026-02-05T21:43:09.495537Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.496869Z", "completed_at": "2026-02-05T21:43:09.496876Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008841753005981445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_avg_monthly_customer_churn_rate.1d3497b679", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_monthly_customer_churn_rate\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere avg_monthly_customer_churn_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.500881Z", "completed_at": "2026-02-05T21:43:09.505670Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.507027Z", "completed_at": "2026-02-05T21:43:09.507034Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008646488189697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_customer_segment.77e1bf04e8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.511057Z", "completed_at": "2026-02-05T21:43:09.515883Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.517456Z", "completed_at": "2026-02-05T21:43:09.517463Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008926153182983398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_segment_as_of_id.6b96a69161", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_as_of_id\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere segment_as_of_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.521471Z", "completed_at": "2026-02-05T21:43:09.526130Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.527457Z", "completed_at": "2026-02-05T21:43:09.527464Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008417129516601562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_customer_lifetime_value_segment_as_of_id.c8b6e3f3fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_as_of_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere segment_as_of_id is not null\ngroup by segment_as_of_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.531517Z", "completed_at": "2026-02-05T21:43:09.538570Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.539978Z", "completed_at": "2026-02-05T21:43:09.539985Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01098489761352539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_unit_economics_assumed_cac__1000000000__0__assumed_cac_is_not_null.0593deb695", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and assumed_cac >= 0 and assumed_cac <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"unit_economics\"\n    where\n        assumed_cac is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.544086Z", "completed_at": "2026-02-05T21:43:09.550098Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.551477Z", "completed_at": "2026-02-05T21:43:09.551484Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009916305541992188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_unit_economics_ltv_to_cac_ratio__1000__0__ltv_to_cac_ratio_is_not_null.d76c1f7ce7", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and ltv_to_cac_ratio >= 0 and ltv_to_cac_ratio <= 1000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"unit_economics\"\n    where\n        ltv_to_cac_ratio is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.555565Z", "completed_at": "2026-02-05T21:43:09.561530Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.562927Z", "completed_at": "2026-02-05T21:43:09.562934Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009867191314697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_unit_economics_payback_months__120__0__payback_months_is_not_null.77c8663847", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and payback_months >= 0 and payback_months <= 120\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"unit_economics\"\n    where\n        payback_months is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.566990Z", "completed_at": "2026-02-05T21:43:09.571734Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.573086Z", "completed_at": "2026-02-05T21:43:09.573093Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00856328010559082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_unit_economics_segment_as_of_id.1d127f6ec4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_as_of_id\nfrom \"saas_analytics\".\"main_marts\".\"unit_economics\"\nwhere segment_as_of_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:43:09.577087Z", "completed_at": "2026-02-05T21:43:09.582851Z"}, {"name": "execute", "started_at": "2026-02-05T21:43:09.584205Z", "completed_at": "2026-02-05T21:43:09.584212Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009633779525756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_unit_economics_segment_as_of_id.5d713df7b9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_as_of_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"unit_economics\"\nwhere segment_as_of_id is not null\ngroup by segment_as_of_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 2.795534133911133, "args": {"static_parser": true, "strict_mode": false, "use_colors_file": true, "write_json": true, "cache_selected_only": false, "log_path": "/home/runner/work/saas-analytics-quality/saas-analytics-quality/dbt_project/logs", "static": false, "use_colors": true, "log_level_file": "debug", "invocation_command": "dbt docs generate", "enable_legacy_logger": false, "project_dir": "/home/runner/work/saas-analytics-quality/saas-analytics-quality/dbt_project", "vars": {}, "favor_state": false, "show_resource_report": false, "version_check": true, "macro_debugging": false, "empty_catalog": false, "defer": false, "print": true, "partial_parse_file_diff": true, "log_level": "info", "quiet": false, "log_format": "default", "send_anonymous_usage_stats": true, "which": "generate", "log_format_file": "debug", "select": [], "indirect_selection": "eager", "compile": true, "printer_width": 80, "warn_error_options": {"include": [], "exclude": []}, "log_file_max_bytes": 10485760, "partial_parse": true, "populate_cache": true, "introspect": true, "exclude": [], "profiles_dir": "."}}