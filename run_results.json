{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.0", "generated_at": "2026-02-05T20:13:42.583211Z", "invocation_id": "a3879152-d37c-4258-89c2-e1d91a3a00ce", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:39.819271Z", "completed_at": "2026-02-05T20:13:39.869629Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:39.871134Z", "completed_at": "2026-02-05T20:13:39.871151Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05753350257873535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.dim_dates", "compiled": true, "compiled_code": "with date_spine as (\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 1095\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    cast('2022-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast('2024-12-31' as date)\n\n)\n\nselect * from filtered\n\n\n),\n\nfinal as (\n    select\n        cast(date_day as date) as date_day,\n        date_trunc('month', date_day) as date_month,\n        extract(year from date_day) as year,\n        extract(quarter from date_day) as quarter,\n        extract(month from date_day) as month,\n        extract(day from date_day) as day_of_month,\n        extract(dow from date_day) as day_of_week,\n        case when extract(dow from date_day) in (0, 6) then true else false end as is_weekend\n    from date_spine\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"dim_dates\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:39.878869Z", "completed_at": "2026-02-05T20:13:39.883278Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:39.884698Z", "completed_at": "2026-02-05T20:13:39.884725Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008632183074951172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_customers", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"customers\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by customer_id\n            order by updated_at desc nulls last, created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(customer_id as integer) as customer_id,\n        lower(trim(email)) as email,\n        trim(company_name) as company_name,\n        cast(signup_date as date) as signup_date,\n        cast(end_date as date) as end_date,\n        lower(trim(account_status)) as account_status,\n        trim(industry) as industry,\n        trim(company_size) as company_size,\n        trim(country) as country,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:39.889198Z", "completed_at": "2026-02-05T20:13:39.893160Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:39.894544Z", "completed_at": "2026-02-05T20:13:39.894553Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00813150405883789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_payments", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"payments\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by payment_id\n            order by created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(payment_id as integer) as payment_id,\n        cast(subscription_id as integer) as subscription_id,\n        cast(payment_date as date) as payment_date,\n        cast(amount as double) as amount,\n        lower(trim(status)) as status,\n        lower(trim(payment_method)) as payment_method,\n        cast(created_at as timestamp) as created_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_payments\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:39.899138Z", "completed_at": "2026-02-05T20:13:39.904023Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:39.905407Z", "completed_at": "2026-02-05T20:13:39.905414Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008957147598266602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_plans", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"plans\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by plan_id\n            order by created_date desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(plan_id as integer) as plan_id,\n        trim(plan_name) as plan_name,\n        lower(trim(plan_tier)) as plan_tier,\n        cast(base_price_monthly as double) as base_price_monthly,\n        cast(base_price_annual as double) as base_price_annual,\n        trim(features) as features,\n        cast(max_users as integer) as max_users,\n        cast(created_date as date) as created_date\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_plans\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:39.909817Z", "completed_at": "2026-02-05T20:13:39.913737Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:39.915129Z", "completed_at": "2026-02-05T20:13:39.915138Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008069515228271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_subscriptions", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"subscriptions\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by subscription_id\n            order by updated_at desc nulls last, created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(subscription_id as integer) as subscription_id,\n        cast(customer_id as integer) as customer_id,\n        cast(plan_id as integer) as plan_id,\n        cast(start_date as date) as start_date,\n        cast(end_date as date) as end_date,\n        lower(trim(status)) as status,\n        cast(mrr_amount as double) as mrr_amount,\n        lower(trim(billing_cycle)) as billing_cycle,\n        cast(amount as double) as amount,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_subscriptions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:39.919325Z", "completed_at": "2026-02-05T20:13:39.923473Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:39.924909Z", "completed_at": "2026-02-05T20:13:39.924918Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008220195770263672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_support_tickets", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"support_tickets\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by ticket_id\n            order by created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(ticket_id as integer) as ticket_id,\n        cast(customer_id as integer) as customer_id,\n        cast(created_date as date) as created_date,\n        cast(resolved_date as date) as resolved_date,\n        lower(trim(category)) as category,\n        lower(trim(priority)) as priority,\n        cast(satisfaction_score as integer) as satisfaction_score,\n        cast(created_at as timestamp) as created_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_support_tickets\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:39.929382Z", "completed_at": "2026-02-05T20:13:39.933075Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:39.934456Z", "completed_at": "2026-02-05T20:13:39.934463Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007909536361694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_usage_events", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"usage_events\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by event_id\n            order by created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(event_id as integer) as event_id,\n        cast(customer_id as integer) as customer_id,\n        cast(event_date as date) as event_date,\n        lower(trim(event_type)) as event_type,\n        cast(usage_quantity as integer) as usage_quantity,\n        cast(created_at as timestamp) as created_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_usage_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:39.938893Z", "completed_at": "2026-02-05T20:13:39.953847Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:39.955248Z", "completed_at": "2026-02-05T20:13:39.955260Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018933773040771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_customers_customer_id.b4eeb23995", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main\".\"customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:39.959437Z", "completed_at": "2026-02-05T20:13:39.964668Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:39.966052Z", "completed_at": "2026-02-05T20:13:39.966060Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009138822555541992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_payments_payment_id.3057b24598", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_id\nfrom \"saas_analytics\".\"main\".\"payments\"\nwhere payment_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:39.970138Z", "completed_at": "2026-02-05T20:13:39.975390Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:39.976767Z", "completed_at": "2026-02-05T20:13:39.976776Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009129762649536133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_plans_plan_id.60ea0c3f70", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main\".\"plans\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:39.980882Z", "completed_at": "2026-02-05T20:13:39.986219Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:39.987579Z", "completed_at": "2026-02-05T20:13:39.987589Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009386062622070312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_subscriptions_subscription_id.d38f0dcd3e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main\".\"subscriptions\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:39.992014Z", "completed_at": "2026-02-05T20:13:39.997161Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:39.998516Z", "completed_at": "2026-02-05T20:13:39.998523Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009148836135864258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_support_tickets_ticket_id.f5e0ca9687", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"saas_analytics\".\"main\".\"support_tickets\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.002673Z", "completed_at": "2026-02-05T20:13:40.009418Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.010805Z", "completed_at": "2026-02-05T20:13:40.010814Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010688066482543945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_usage_events_event_id.6b4882f73b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"saas_analytics\".\"main\".\"usage_events\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.015044Z", "completed_at": "2026-02-05T20:13:40.024699Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.026123Z", "completed_at": "2026-02-05T20:13:40.026133Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013751029968261719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_payments_subscription_id__subscription_id__source_raw_saas_subscriptions_.eec6fd2df4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select subscription_id as from_field\n    from \"saas_analytics\".\"main\".\"payments\"\n    where subscription_id is not null\n),\n\nparent as (\n    select subscription_id as to_field\n    from \"saas_analytics\".\"main\".\"subscriptions\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.030462Z", "completed_at": "2026-02-05T20:13:40.037575Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.038987Z", "completed_at": "2026-02-05T20:13:40.038998Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011203765869140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_subscriptions_customer_id__customer_id__source_raw_saas_customers_.d9d2470757", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main\".\"subscriptions\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main\".\"customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.043240Z", "completed_at": "2026-02-05T20:13:40.049903Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.051291Z", "completed_at": "2026-02-05T20:13:40.051300Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010670185089111328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_support_tickets_customer_id__customer_id__source_raw_saas_customers_.558da46c8f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main\".\"support_tickets\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main\".\"customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.055528Z", "completed_at": "2026-02-05T20:13:40.063581Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.065001Z", "completed_at": "2026-02-05T20:13:40.065011Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01207876205444336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_usage_events_customer_id__customer_id__source_raw_saas_customers_.edd5bda594", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main\".\"usage_events\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main\".\"customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.069262Z", "completed_at": "2026-02-05T20:13:40.077192Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.078579Z", "completed_at": "2026-02-05T20:13:40.078589Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011955738067626953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_customers_customer_id.5e4b5bfe1e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.082799Z", "completed_at": "2026-02-05T20:13:40.088173Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.089546Z", "completed_at": "2026-02-05T20:13:40.089555Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009294509887695312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_payments_payment_id.3ce97338e8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    payment_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"payments\"\nwhere payment_id is not null\ngroup by payment_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.093769Z", "completed_at": "2026-02-05T20:13:40.099316Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.100747Z", "completed_at": "2026-02-05T20:13:40.100756Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009574651718139648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_plans_plan_id.1874d4258c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    plan_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"plans\"\nwhere plan_id is not null\ngroup by plan_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.105057Z", "completed_at": "2026-02-05T20:13:40.110374Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.111789Z", "completed_at": "2026-02-05T20:13:40.111798Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009411811828613281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_subscriptions_subscription_id.f107c8e56a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"subscriptions\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.116093Z", "completed_at": "2026-02-05T20:13:40.123099Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.124485Z", "completed_at": "2026-02-05T20:13:40.124493Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011061906814575195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_support_tickets_ticket_id.590438c9f6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"support_tickets\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.128697Z", "completed_at": "2026-02-05T20:13:40.133875Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.135238Z", "completed_at": "2026-02-05T20:13:40.135247Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00905752182006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_usage_events_event_id.e76df55de9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"usage_events\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.139437Z", "completed_at": "2026-02-05T20:13:40.145294Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.146676Z", "completed_at": "2026-02-05T20:13:40.146685Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009836912155151367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_dates_date_day.1717af99fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"saas_analytics\".\"main_marts\".\"dim_dates\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.150907Z", "completed_at": "2026-02-05T20:13:40.156683Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.158099Z", "completed_at": "2026-02-05T20:13:40.158109Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009807586669921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_dates_date_month.8043b8f3cb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"dim_dates\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.162441Z", "completed_at": "2026-02-05T20:13:40.167794Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.169179Z", "completed_at": "2026-02-05T20:13:40.169189Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009409666061401367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_dim_dates_date_day.5e9dfa95c7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_day as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"dim_dates\"\nwhere date_day is not null\ngroup by date_day\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.173383Z", "completed_at": "2026-02-05T20:13:40.180176Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.181582Z", "completed_at": "2026-02-05T20:13:40.181593Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010808706283569336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.dim_customers", "compiled": true, "compiled_code": "with customers as (\n    select\n        customer_id,\n        email,\n        company_name,\n        industry,\n        company_size,\n        country,\n        signup_date,\n        end_date,\n        account_status\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n),\n\nfinal as (\n    select\n        customer_id,\n        email,\n        company_name,\n        industry,\n        company_size,\n        case\n            when lower(company_size) = 'small' then 'smb'\n            when lower(company_size) = 'medium' then 'mid-market'\n            when lower(company_size) = 'large' then 'enterprise'\n            else 'unknown'\n        end as customer_segment,\n        country,\n        signup_date,\n        end_date as churn_date,\n        account_status,\n        case when account_status = 'active' then true else false end as is_active\n    from customers\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"dim_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.186149Z", "completed_at": "2026-02-05T20:13:40.190264Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.191656Z", "completed_at": "2026-02-05T20:13:40.191667Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008341550827026367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_customer_cohorts", "compiled": true, "compiled_code": "with customers as (\n    select\n        customer_id,\n        signup_date\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n),\n\nfinal as (\n    select\n        customer_id,\n        date_trunc('month', signup_date) as cohort_month\n    from customers\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.196130Z", "completed_at": "2026-02-05T20:13:40.207071Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.208556Z", "completed_at": "2026-02-05T20:13:40.208569Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015244007110595703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_customers_account_status__active__churned.4ba2500c79", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        account_status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n    group by account_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','churned'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.212918Z", "completed_at": "2026-02-05T20:13:40.232911Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.234487Z", "completed_at": "2026-02-05T20:13:40.234502Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024264097213745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_match_regex_stg_customers_email___a_zA_Z0_9__a_zA_Z0_9_a_zA_Z0_9_.796c35c3c5", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \n\nregexp_matches(email, '^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$', '')\n\n\n > 0\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.239130Z", "completed_at": "2026-02-05T20:13:40.246091Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.247497Z", "completed_at": "2026-02-05T20:13:40.247507Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011126518249511719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_account_status.d9b1d833ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_status\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere account_status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.251686Z", "completed_at": "2026-02-05T20:13:40.257070Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.258430Z", "completed_at": "2026-02-05T20:13:40.258439Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009263038635253906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.262598Z", "completed_at": "2026-02-05T20:13:40.267804Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.269182Z", "completed_at": "2026-02-05T20:13:40.269191Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00910639762878418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_email.d7cf761533", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere email is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.273509Z", "completed_at": "2026-02-05T20:13:40.278645Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.280025Z", "completed_at": "2026-02-05T20:13:40.280034Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009252071380615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_signup_date.ef12d9c335", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect signup_date\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere signup_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.284157Z", "completed_at": "2026-02-05T20:13:40.290668Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.292050Z", "completed_at": "2026-02-05T20:13:40.292059Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0104217529296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_customers_customer_id.c7614daada", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.296151Z", "completed_at": "2026-02-05T20:13:40.313076Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.314571Z", "completed_at": "2026-02-05T20:13:40.314583Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021034955978393555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_payment_history", "compiled": true, "compiled_code": "with payments as (\n    select\n        subscription_id,\n        date_trunc('month', payment_date) as payment_month,\n        status,\n        amount\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n),\n\nmonthly_payments as (\n    select\n        subscription_id,\n        payment_month,\n        count(*) as payment_count,\n        sum(case when status = 'success' then 1 else 0 end) as successful_payments,\n        sum(case when status = 'failed' then 1 else 0 end) as failed_payments,\n        sum(case when status = 'refunded' then 1 else 0 end) as refunded_payments,\n        sum(amount) as net_amount\n    from payments\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(subscription_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(payment_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as subscription_month_id,\n        subscription_id,\n        payment_month,\n        payment_count,\n        successful_payments,\n        failed_payments,\n        refunded_payments,\n        net_amount\n    from monthly_payments\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_payment_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.319298Z", "completed_at": "2026-02-05T20:13:40.327022Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.328484Z", "completed_at": "2026-02-05T20:13:40.328497Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01205897331237793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_payments_payment_method__credit_card__bank_transfer__paypal.9a9e2818f7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        payment_method as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n    group by payment_method\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'credit_card','bank_transfer','paypal'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.332781Z", "completed_at": "2026-02-05T20:13:40.339771Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.341176Z", "completed_at": "2026-02-05T20:13:40.341186Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011059045791625977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_payments_status__success__failed__refunded.f3ae67bf94", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'success','failed','refunded'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.345402Z", "completed_at": "2026-02-05T20:13:40.350975Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.352365Z", "completed_at": "2026-02-05T20:13:40.352376Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009516716003417969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_payment_id.c19cc50075", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere payment_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.358242Z", "completed_at": "2026-02-05T20:13:40.434508Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.436146Z", "completed_at": "2026-02-05T20:13:40.436160Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08055520057678223, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_payment_method.dad6ff229d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_method\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere payment_method is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.440632Z", "completed_at": "2026-02-05T20:13:40.446010Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.447446Z", "completed_at": "2026-02-05T20:13:40.447455Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009343147277832031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_status.dec3c85699", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.451637Z", "completed_at": "2026-02-05T20:13:40.457074Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.458440Z", "completed_at": "2026-02-05T20:13:40.458450Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009359121322631836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_subscription_id.182bae4263", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.462644Z", "completed_at": "2026-02-05T20:13:40.468239Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.469621Z", "completed_at": "2026-02-05T20:13:40.469631Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009540557861328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_payments_payment_id.3744510712", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    payment_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere payment_id is not null\ngroup by payment_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.473856Z", "completed_at": "2026-02-05T20:13:40.479387Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.480821Z", "completed_at": "2026-02-05T20:13:40.480830Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009516716003417969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.dim_plans", "compiled": true, "compiled_code": "with plans as (\n    select\n        plan_id,\n        plan_name,\n        plan_tier,\n        base_price_monthly,\n        base_price_annual,\n        features,\n        max_users,\n        created_date\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n),\n\nfinal as (\n    select\n        plan_id,\n        plan_name,\n        plan_tier,\n        base_price_monthly,\n        base_price_annual,\n        max_users,\n        features,\n        created_date\n    from plans\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"dim_plans\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.485286Z", "completed_at": "2026-02-05T20:13:40.492191Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.493582Z", "completed_at": "2026-02-05T20:13:40.493591Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01087331771850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_plans_plan_tier__starter__professional__enterprise.6627a5bb68", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        plan_tier as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n    group by plan_tier\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'starter','professional','enterprise'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.497827Z", "completed_at": "2026-02-05T20:13:40.509913Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.511334Z", "completed_at": "2026-02-05T20:13:40.511344Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01610279083251953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_plans_base_price_annual__1000000__0.90f48edeea", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_annual >= 0 and base_price_annual <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.515591Z", "completed_at": "2026-02-05T20:13:40.521238Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.522649Z", "completed_at": "2026-02-05T20:13:40.522656Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009622573852539062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_plans_base_price_monthly__100000__0.29dde2c990", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_monthly >= 0 and base_price_monthly <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.526823Z", "completed_at": "2026-02-05T20:13:40.531653Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.533105Z", "completed_at": "2026-02-05T20:13:40.533112Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008854389190673828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_base_price_annual.7ff22b0352", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_annual\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere base_price_annual is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.537194Z", "completed_at": "2026-02-05T20:13:40.543299Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.544653Z", "completed_at": "2026-02-05T20:13:40.544660Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010035991668701172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_base_price_monthly.768fac3224", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_monthly\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere base_price_monthly is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.548748Z", "completed_at": "2026-02-05T20:13:40.553519Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.554915Z", "completed_at": "2026-02-05T20:13:40.554923Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008836030960083008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_plan_id.97197e92e3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.559157Z", "completed_at": "2026-02-05T20:13:40.563902Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.565251Z", "completed_at": "2026-02-05T20:13:40.565258Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008687496185302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_plan_tier.eba3d0c0c9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_tier\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere plan_tier is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.569344Z", "completed_at": "2026-02-05T20:13:40.574152Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.575539Z", "completed_at": "2026-02-05T20:13:40.575547Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008758306503295898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_plans_plan_id.b3adbcbaf7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    plan_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere plan_id is not null\ngroup by plan_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.579672Z", "completed_at": "2026-02-05T20:13:40.587636Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.589209Z", "completed_at": "2026-02-05T20:13:40.589219Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012067556381225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.fct_monthly_recurring_revenue", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\nsubscriptions as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        billing_cycle,\n        amount,\n        -- Normalize MRR from amount + billing_cycle (more robust than trusting raw mrr_amount)\n        \n    case\n        when billing_cycle = 'annual' then amount / 12.0\n        when billing_cycle = 'monthly' then amount\n        else 0\n    end\n as normalized_mrr_amount\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n),\n\nsubscription_months as (\n    select\n        s.customer_id,\n        s.subscription_id,\n        s.plan_id,\n        m.date_month,\n        s.status,\n        s.billing_cycle,\n        s.amount,\n        case\n            when s.status = 'paused' then 0\n            else s.normalized_mrr_amount\n        end as mrr_amount\n    from subscriptions s\n    join months m\n        on m.date_month >= date_trunc('month', s.start_date)\n        and (\n            s.end_date is null\n            or m.date_month <= date_trunc('month', s.end_date)\n        )\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_month_id,\n        customer_id,\n        date_month,\n        sum(mrr_amount) as mrr_amount,\n        count(distinct subscription_id) as subscription_count\n    from subscription_months\n    group by 1, 2, 3\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.594013Z", "completed_at": "2026-02-05T20:13:40.597953Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.599415Z", "completed_at": "2026-02-05T20:13:40.599423Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008242368698120117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.fct_subscriptions", "compiled": true, "compiled_code": "with subscriptions as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        billing_cycle,\n        amount,\n        mrr_amount\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n),\n\nfinal as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        billing_cycle,\n        amount,\n        mrr_amount,\n        case\n            when status = 'active' then true\n            else false\n        end as is_currently_active\n    from subscriptions\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"fct_subscriptions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.603993Z", "completed_at": "2026-02-05T20:13:40.607841Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.609276Z", "completed_at": "2026-02-05T20:13:40.609284Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008117914199829102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_subscription_periods", "compiled": true, "compiled_code": "with subscriptions as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        mrr_amount,\n        billing_cycle,\n        amount\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n),\n\nfinal as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        mrr_amount,\n        billing_cycle,\n        amount\n    from subscriptions\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.613644Z", "completed_at": "2026-02-05T20:13:40.620046Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.621424Z", "completed_at": "2026-02-05T20:13:40.621432Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01033163070678711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_subscriptions_billing_cycle__monthly__annual.373ee04739", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        billing_cycle as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    group by billing_cycle\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'monthly','annual'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.625562Z", "completed_at": "2026-02-05T20:13:40.633532Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.634935Z", "completed_at": "2026-02-05T20:13:40.634943Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011938333511352539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_subscriptions_status__active__paused__churned__upgraded__downgraded.2ca9adef65", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','paused','churned','upgraded','downgraded'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.639106Z", "completed_at": "2026-02-05T20:13:40.644503Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.645917Z", "completed_at": "2026-02-05T20:13:40.645924Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00936269760131836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_subscriptions_amount__1000000__0.0aec0f7ac5", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and amount >= 0 and amount <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.650109Z", "completed_at": "2026-02-05T20:13:40.655617Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.657032Z", "completed_at": "2026-02-05T20:13:40.657039Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00948190689086914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_subscriptions_mrr_amount__100000__0.1f718c7d2b", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.661197Z", "completed_at": "2026-02-05T20:13:40.666092Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.667451Z", "completed_at": "2026-02-05T20:13:40.667458Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008847951889038086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_amount.d2bc105990", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.671513Z", "completed_at": "2026-02-05T20:13:40.676357Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.677741Z", "completed_at": "2026-02-05T20:13:40.677748Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008750438690185547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_billing_cycle.a5cc3f107d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect billing_cycle\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere billing_cycle is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.681870Z", "completed_at": "2026-02-05T20:13:40.687962Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.689316Z", "completed_at": "2026-02-05T20:13:40.689323Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009961128234863281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_customer_id.2baac6ebd7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.693388Z", "completed_at": "2026-02-05T20:13:40.698283Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.699756Z", "completed_at": "2026-02-05T20:13:40.699764Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008849143981933594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_mrr_amount.9940a0b6a0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.703871Z", "completed_at": "2026-02-05T20:13:40.708610Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.709991Z", "completed_at": "2026-02-05T20:13:40.709999Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008690357208251953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_plan_id.ebc4c7e103", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.714095Z", "completed_at": "2026-02-05T20:13:40.718937Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.720308Z", "completed_at": "2026-02-05T20:13:40.720315Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008786678314208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_start_date.aae12535b8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_date\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere start_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.724459Z", "completed_at": "2026-02-05T20:13:40.730695Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.732083Z", "completed_at": "2026-02-05T20:13:40.732093Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01025533676147461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_status.e945ee07e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.736178Z", "completed_at": "2026-02-05T20:13:40.741212Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.742610Z", "completed_at": "2026-02-05T20:13:40.742617Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00896763801574707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_subscription_id.68a3edda91", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.746761Z", "completed_at": "2026-02-05T20:13:40.752608Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.754023Z", "completed_at": "2026-02-05T20:13:40.754030Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009789228439331055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_payments_subscription_id__subscription_id__ref_stg_subscriptions_.0ab4d26fa6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select subscription_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n    where subscription_id is not null\n),\n\nparent as (\n    select subscription_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.758200Z", "completed_at": "2026-02-05T20:13:40.764056Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.765448Z", "completed_at": "2026-02-05T20:13:40.765455Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009871244430541992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_subscriptions_customer_id__customer_id__ref_stg_customers_.3a4746f98e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.769614Z", "completed_at": "2026-02-05T20:13:40.775804Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.777183Z", "completed_at": "2026-02-05T20:13:40.777190Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010146141052246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_subscriptions_plan_id__plan_id__ref_stg_plans_.9e3939335e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select plan_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    where plan_id is not null\n),\n\nparent as (\n    select plan_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.781321Z", "completed_at": "2026-02-05T20:13:40.787289Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.788647Z", "completed_at": "2026-02-05T20:13:40.788654Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00990748405456543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_subscriptions_subscription_id.d45e893a6e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.792773Z", "completed_at": "2026-02-05T20:13:40.799905Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.801302Z", "completed_at": "2026-02-05T20:13:40.801311Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011088371276855469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_support_tickets_category__billing__technical__feature_request__other.2da1083ca7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        category as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    group by category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'billing','technical','feature_request','other'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.805580Z", "completed_at": "2026-02-05T20:13:40.812856Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.814247Z", "completed_at": "2026-02-05T20:13:40.814256Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011281251907348633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_support_tickets_priority__low__medium__high__urgent.63d517161e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        priority as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    group by priority\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'low','medium','high','urgent'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.818514Z", "completed_at": "2026-02-05T20:13:40.824759Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.826175Z", "completed_at": "2026-02-05T20:13:40.826184Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01030731201171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_support_tickets_satisfaction_score__5__1__satisfaction_score_is_not_null.ea8ac41f35", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and satisfaction_score >= 1 and satisfaction_score <= 5\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    where\n        satisfaction_score is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.830387Z", "completed_at": "2026-02-05T20:13:40.836990Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.838367Z", "completed_at": "2026-02-05T20:13:40.838376Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010611295700073242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_category.28b0c1060c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere category is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.842634Z", "completed_at": "2026-02-05T20:13:40.847801Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.849199Z", "completed_at": "2026-02-05T20:13:40.849208Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00925302505493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_customer_id.1a8e520036", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.853359Z", "completed_at": "2026-02-05T20:13:40.858614Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.860001Z", "completed_at": "2026-02-05T20:13:40.860010Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009221076965332031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_priority.beb363395f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect priority\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere priority is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.864196Z", "completed_at": "2026-02-05T20:13:40.869508Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.870905Z", "completed_at": "2026-02-05T20:13:40.870914Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009312152862548828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_ticket_id.7830ecbac2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.875085Z", "completed_at": "2026-02-05T20:13:40.881165Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.882542Z", "completed_at": "2026-02-05T20:13:40.882550Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010097265243530273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_support_tickets_customer_id__customer_id__ref_stg_customers_.be9984b1c6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.886735Z", "completed_at": "2026-02-05T20:13:40.893183Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.894555Z", "completed_at": "2026-02-05T20:13:40.894564Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010429859161376953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_support_tickets_ticket_id.eed19dcb0a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.898729Z", "completed_at": "2026-02-05T20:13:40.904361Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.905794Z", "completed_at": "2026-02-05T20:13:40.905802Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009655475616455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_customer_health_score", "compiled": true, "compiled_code": "with customers as (\n    select\n        customer_id\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n),\n\nas_of as (\n    select\n        greatest(\n            coalesce((select max(event_date) from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"), date '1900-01-01'),\n            coalesce((select max(payment_date) from \"saas_analytics\".\"main_staging\".\"stg_payments\"), date '1900-01-01'),\n            coalesce((select max(created_date) from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"), date '1900-01-01')\n        ) as as_of_date\n),\n\nusage_last_30d as (\n    select\n        ue.customer_id,\n        count(*) as events_last_30d,\n        sum(ue.usage_quantity) as usage_quantity_last_30d\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\" ue\n    cross join as_of a\n    where ue.event_date > a.as_of_date - interval 30 day\n      and ue.event_date <= a.as_of_date\n    group by 1\n),\n\ntickets_last_90d as (\n    select\n        t.customer_id,\n        count(*) as tickets_created_last_90d,\n        sum(case when t.resolved_date is null then 1 else 0 end) as open_tickets\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\" t\n    cross join as_of a\n    where t.created_date > a.as_of_date - interval 90 day\n      and t.created_date <= a.as_of_date\n    group by 1\n),\n\npayment_failures_last_90d as (\n    select\n        s.customer_id,\n        count(*) as payment_events_last_90d,\n        sum(case when p.status = 'failed' then 1 else 0 end) as failed_payments_last_90d\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\" p\n    join \"saas_analytics\".\"main_staging\".\"stg_subscriptions\" s\n        on p.subscription_id = s.subscription_id\n    cross join as_of a\n    where p.payment_date > a.as_of_date - interval 90 day\n      and p.payment_date <= a.as_of_date\n    group by 1\n),\n\nscored as (\n    select\n        c.customer_id,\n        a.as_of_date,\n        coalesce(u.events_last_30d, 0) as events_last_30d,\n        coalesce(u.usage_quantity_last_30d, 0) as usage_quantity_last_30d,\n        coalesce(t.tickets_created_last_90d, 0) as tickets_created_last_90d,\n        coalesce(t.open_tickets, 0) as open_tickets,\n        coalesce(p.payment_events_last_90d, 0) as payment_events_last_90d,\n        coalesce(p.failed_payments_last_90d, 0) as failed_payments_last_90d,\n        case\n            when coalesce(p.payment_events_last_90d, 0) = 0 then 0\n            else coalesce(p.failed_payments_last_90d, 0)::double / p.payment_events_last_90d\n        end as payment_failure_rate_last_90d\n    from customers c\n    cross join as_of a\n    left join usage_last_30d u\n        on c.customer_id = u.customer_id\n    left join tickets_last_90d t\n        on c.customer_id = t.customer_id\n    left join payment_failures_last_90d p\n        on c.customer_id = p.customer_id\n),\n\nfinal as (\n    select\n        customer_id,\n        as_of_date,\n        events_last_30d,\n        usage_quantity_last_30d,\n        tickets_created_last_90d,\n        open_tickets,\n        payment_events_last_90d,\n        failed_payments_last_90d,\n        payment_failure_rate_last_90d,\n        least(\n            100,\n            greatest(\n                0,\n                70\n                + least(30, events_last_30d)::integer\n                - least(40, open_tickets * 10)::integer\n                - least(40, (payment_failure_rate_last_90d * 100)::integer)\n            )\n        ) as health_score\n    from scored\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.910177Z", "completed_at": "2026-02-05T20:13:40.915844Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.917270Z", "completed_at": "2026-02-05T20:13:40.917278Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01000213623046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_monthly_usage", "compiled": true, "compiled_code": "with usage_events as (\n    select\n        customer_id,\n        date_trunc('month', event_date) as usage_month,\n        event_type,\n        usage_quantity\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n),\n\nmonthly_usage as (\n    select\n        customer_id,\n        usage_month,\n        count(*) as event_count,\n        sum(usage_quantity) as total_usage_quantity,\n        sum(case when event_type = 'login' then 1 else 0 end) as login_events,\n        sum(case when event_type = 'feature_usage' then 1 else 0 end) as feature_usage_events,\n        sum(case when event_type = 'export' then 1 else 0 end) as export_events,\n        sum(case when event_type = 'api_call' then 1 else 0 end) as api_call_events\n    from usage_events\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(usage_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_month_id,\n        customer_id,\n        usage_month,\n        event_count,\n        total_usage_quantity,\n        login_events,\n        feature_usage_events,\n        export_events,\n        api_call_events\n    from monthly_usage\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.921878Z", "completed_at": "2026-02-05T20:13:40.929980Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.931418Z", "completed_at": "2026-02-05T20:13:40.931430Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012522459030151367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_usage_events_event_type__login__feature_usage__export__api_call.9e239b4047", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        event_type as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n    group by event_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'login','feature_usage','export','api_call'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.935684Z", "completed_at": "2026-02-05T20:13:40.943297Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.944723Z", "completed_at": "2026-02-05T20:13:40.944734Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01167607307434082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_usage_events_usage_quantity__1000000__0.a19ac32495", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and usage_quantity >= 0 and usage_quantity <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.948937Z", "completed_at": "2026-02-05T20:13:40.954164Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.955548Z", "completed_at": "2026-02-05T20:13:40.955557Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009224653244018555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_customer_id.424cb78bfc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.959668Z", "completed_at": "2026-02-05T20:13:40.964928Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.966260Z", "completed_at": "2026-02-05T20:13:40.966267Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009138345718383789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_event_id.2c1891cce4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.970351Z", "completed_at": "2026-02-05T20:13:40.975370Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.976725Z", "completed_at": "2026-02-05T20:13:40.976733Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008901357650756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_event_type.b865685b11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_type\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere event_type is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.980797Z", "completed_at": "2026-02-05T20:13:40.985630Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.987012Z", "completed_at": "2026-02-05T20:13:40.987019Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008797645568847656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_usage_quantity.8fafec8a69", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect usage_quantity\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere usage_quantity is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:40.991183Z", "completed_at": "2026-02-05T20:13:40.998218Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:40.999584Z", "completed_at": "2026-02-05T20:13:40.999591Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011017322540283203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_usage_events_customer_id__customer_id__ref_stg_customers_.33deb2f692", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.003645Z", "completed_at": "2026-02-05T20:13:41.008501Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.009906Z", "completed_at": "2026-02-05T20:13:41.009913Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008793115615844727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_usage_events_event_id.8f4005aa34", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.014046Z", "completed_at": "2026-02-05T20:13:41.020465Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.021887Z", "completed_at": "2026-02-05T20:13:41.021895Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010456085205078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_dim_customers_customer_segment__smb__mid_market__enterprise__unknown.59f6eba2cc", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.026051Z", "completed_at": "2026-02-05T20:13:41.030961Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.032304Z", "completed_at": "2026-02-05T20:13:41.032311Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008933544158935547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_customer_id.dd91cd1c8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.036548Z", "completed_at": "2026-02-05T20:13:41.042570Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.043958Z", "completed_at": "2026-02-05T20:13:41.043965Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009910821914672852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_customer_segment.bc342ee8ba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.048069Z", "completed_at": "2026-02-05T20:13:41.052827Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.054226Z", "completed_at": "2026-02-05T20:13:41.054233Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008746862411499023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_email.ed68b54d1a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere email is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.058320Z", "completed_at": "2026-02-05T20:13:41.063610Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.065002Z", "completed_at": "2026-02-05T20:13:41.065010Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009161233901977539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_signup_date.7f7d0227dd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect signup_date\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere signup_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.069100Z", "completed_at": "2026-02-05T20:13:41.073909Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.075266Z", "completed_at": "2026-02-05T20:13:41.075274Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008664369583129883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_dim_customers_customer_id.15c9f1e2fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.079503Z", "completed_at": "2026-02-05T20:13:41.084318Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.085680Z", "completed_at": "2026-02-05T20:13:41.085687Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00884246826171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_cohorts_cohort_month.5f7f1ecfb6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_month\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\"\nwhere cohort_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.089843Z", "completed_at": "2026-02-05T20:13:41.095962Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.097336Z", "completed_at": "2026-02-05T20:13:41.097343Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010114431381225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_cohorts_customer_id.a75833fcff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.101445Z", "completed_at": "2026-02-05T20:13:41.106147Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.107520Z", "completed_at": "2026-02-05T20:13:41.107527Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008624076843261719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_customer_cohorts_customer_id.279a739d39", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.111684Z", "completed_at": "2026-02-05T20:13:41.117124Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.118525Z", "completed_at": "2026-02-05T20:13:41.118532Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009488821029663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_payment_history_net_amount__1000000000___1000000000.297926e2b5", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and net_amount >= -1000000000 and net_amount <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.122732Z", "completed_at": "2026-02-05T20:13:41.128200Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.129584Z", "completed_at": "2026-02-05T20:13:41.129591Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009401321411132812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_payment_history_payment_count__100000000__0.41e5b20a2f", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and payment_count >= 0 and payment_count <= 100000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.133737Z", "completed_at": "2026-02-05T20:13:41.138578Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.139965Z", "completed_at": "2026-02-05T20:13:41.139972Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008794784545898438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_net_amount.c0b496bbc8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect net_amount\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere net_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.144112Z", "completed_at": "2026-02-05T20:13:41.150136Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.151508Z", "completed_at": "2026-02-05T20:13:41.151515Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009942054748535156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_payment_count.c9d746fa8b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_count\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere payment_count is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.155611Z", "completed_at": "2026-02-05T20:13:41.160460Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.161858Z", "completed_at": "2026-02-05T20:13:41.161866Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00875997543334961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_payment_month.218496379c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_month\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere payment_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.166002Z", "completed_at": "2026-02-05T20:13:41.170757Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.172138Z", "completed_at": "2026-02-05T20:13:41.172146Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008733749389648438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_subscription_id.f530bb3c51", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.176253Z", "completed_at": "2026-02-05T20:13:41.181102Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.182446Z", "completed_at": "2026-02-05T20:13:41.182453Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008781194686889648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_subscription_month_id.ea8c983f61", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_month_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere subscription_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.186548Z", "completed_at": "2026-02-05T20:13:41.193463Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.194902Z", "completed_at": "2026-02-05T20:13:41.194910Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010921716690063477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_payment_history_subscription_id__subscription_id__ref_stg_subscriptions_.c2dc1d48a4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select subscription_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\n    where subscription_id is not null\n),\n\nparent as (\n    select subscription_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.199080Z", "completed_at": "2026-02-05T20:13:41.203759Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.205145Z", "completed_at": "2026-02-05T20:13:41.205152Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008689641952514648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_payment_history_subscription_month_id.d1f891bb75", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere subscription_month_id is not null\ngroup by subscription_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.209308Z", "completed_at": "2026-02-05T20:13:41.214373Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.215772Z", "completed_at": "2026-02-05T20:13:41.215780Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009053707122802734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_dim_plans_plan_tier__starter__professional__enterprise.951b43f83d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        plan_tier as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n    group by plan_tier\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'starter','professional','enterprise'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.219902Z", "completed_at": "2026-02-05T20:13:41.225421Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.226837Z", "completed_at": "2026-02-05T20:13:41.226844Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009473323822021484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_dim_plans_base_price_annual__1000000__0.3da0c08240", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_annual >= 0 and base_price_annual <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.231027Z", "completed_at": "2026-02-05T20:13:41.236416Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.237826Z", "completed_at": "2026-02-05T20:13:41.237833Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009377479553222656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_dim_plans_base_price_monthly__100000__0.80491e18f9", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_monthly >= 0 and base_price_monthly <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.242018Z", "completed_at": "2026-02-05T20:13:41.248080Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.249472Z", "completed_at": "2026-02-05T20:13:41.249479Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01002359390258789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_base_price_annual.eee138969b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_annual\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere base_price_annual is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.253546Z", "completed_at": "2026-02-05T20:13:41.258484Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.259883Z", "completed_at": "2026-02-05T20:13:41.259890Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008881568908691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_base_price_monthly.0aa94d6b4b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_monthly\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere base_price_monthly is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.264034Z", "completed_at": "2026-02-05T20:13:41.268775Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.270142Z", "completed_at": "2026-02-05T20:13:41.270150Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00872659683227539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_plan_id.78a937462a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.274360Z", "completed_at": "2026-02-05T20:13:41.280016Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.281374Z", "completed_at": "2026-02-05T20:13:41.281383Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009562253952026367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_plan_tier.154dd327a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_tier\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere plan_tier is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.285491Z", "completed_at": "2026-02-05T20:13:41.291776Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.293142Z", "completed_at": "2026-02-05T20:13:41.293149Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010199546813964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_dim_plans_plan_id.27d8cecd0f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    plan_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere plan_id is not null\ngroup by plan_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.297244Z", "completed_at": "2026-02-05T20:13:41.302866Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.304269Z", "completed_at": "2026-02-05T20:13:41.304276Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00959467887878418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.churn_analysis", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\ncustomer_month_spine as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        m.date_month\n    from customers c\n    cross join months m\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\nwith_prev as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        lag(mrr_amount) over (partition by customer_id order by date_month) as prev_mrr_amount\n    from customer_mrr\n),\n\nmonthly as (\n    select\n        date_month,\n        customer_segment,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 then 1 else 0 end) as starting_customers,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then 1 else 0 end) as churned_customers,\n        sum(coalesce(prev_mrr_amount, 0)) as starting_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then coalesce(prev_mrr_amount, 0) else 0 end) as churned_mrr\n    from with_prev\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_month_id,\n        date_month,\n        customer_segment,\n        starting_customers,\n        churned_customers,\n        case\n            when starting_customers = 0 then 0\n            else churned_customers::double / starting_customers\n        end as customer_churn_rate,\n        starting_mrr,\n        churned_mrr,\n        case\n            when starting_mrr = 0 then 0\n            else churned_mrr / starting_mrr\n        end as revenue_churn_rate\n    from monthly\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"churn_analysis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.308723Z", "completed_at": "2026-02-05T20:13:41.314502Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.315952Z", "completed_at": "2026-02-05T20:13:41.315960Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010129928588867188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.cohort_retention", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncohorts as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        date_trunc('month', c.signup_date) as cohort_month\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\" c\n),\n\ncohort_sizes as (\n    select\n        cohort_month,\n        customer_segment,\n        count(*) as cohort_customers\n    from cohorts\n    group by 1, 2\n),\n\ncustomer_month_spine as (\n    select\n        co.customer_id,\n        co.customer_segment,\n        co.cohort_month,\n        m.date_month\n    from cohorts co\n    join months m\n        on m.date_month >= co.cohort_month\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.cohort_month,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\nactive_customers as (\n    select\n        cohort_month,\n        customer_segment,\n        date_month,\n        datediff('month', cohort_month, date_month) as months_since_signup,\n        count(distinct case when mrr_amount > 0 then customer_id end) as active_customers\n    from customer_mrr\n    group by 1, 2, 3, 4\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(a.customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(a.cohort_month as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(a.months_since_signup as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as cohort_segment_period_id,\n        a.cohort_month,\n        a.customer_segment,\n        a.months_since_signup,\n        a.date_month as active_month,\n        s.cohort_customers,\n        a.active_customers,\n        case\n            when s.cohort_customers = 0 then 0\n            else a.active_customers::double / s.cohort_customers\n        end as retention_rate\n    from active_customers a\n    join cohort_sizes s\n        on a.cohort_month = s.cohort_month\n        and a.customer_segment = s.customer_segment\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"cohort_retention\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.320390Z", "completed_at": "2026-02-05T20:13:41.326094Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.327503Z", "completed_at": "2026-02-05T20:13:41.327510Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010028362274169922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.mrr_analysis", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\ncustomer_month_spine as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        m.date_month\n    from customers c\n    cross join months m\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\ncustomer_mrr_with_prev as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        lag(mrr_amount) over (partition by customer_id order by date_month) as prev_mrr_amount\n    from customer_mrr\n),\n\nclassified as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        coalesce(prev_mrr_amount, 0) as prev_mrr_amount,\n        mrr_amount - coalesce(prev_mrr_amount, 0) as mrr_change,\n        case\n            when coalesce(prev_mrr_amount, 0) = 0 and mrr_amount > 0 then 'new'\n            when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then 'churn'\n            when mrr_amount > coalesce(prev_mrr_amount, 0) and coalesce(prev_mrr_amount, 0) > 0 then 'expansion'\n            when mrr_amount < coalesce(prev_mrr_amount, 0) and mrr_amount > 0 then 'contraction'\n            else 'no_change'\n        end as mrr_movement_type\n    from customer_mrr_with_prev\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_month_id,\n        date_month,\n        customer_segment,\n        sum(mrr_amount) as total_mrr,\n        sum(case when mrr_movement_type = 'new' then mrr_amount else 0 end) as new_mrr,\n        sum(case when mrr_movement_type = 'expansion' then mrr_change else 0 end) as expansion_mrr,\n        sum(case when mrr_movement_type = 'contraction' then abs(mrr_change) else 0 end) as contraction_mrr,\n        sum(case when mrr_movement_type = 'churn' then prev_mrr_amount else 0 end) as churned_mrr,\n        sum(case when mrr_movement_type in ('new', 'expansion') then mrr_change else 0 end)\n        - sum(case when mrr_movement_type in ('contraction', 'churn') then abs(mrr_change) else 0 end) as net_new_mrr\n    from classified\n    group by 1, 2, 3\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"mrr_analysis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.331887Z", "completed_at": "2026-02-05T20:13:41.338441Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.339857Z", "completed_at": "2026-02-05T20:13:41.339865Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010793447494506836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.net_revenue_retention", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\ncustomer_month_spine as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        m.date_month\n    from customers c\n    cross join months m\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\nwith_prev as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        lag(mrr_amount) over (partition by customer_id order by date_month) as prev_mrr_amount\n    from customer_mrr\n),\n\nmovement as (\n    select\n        date_month,\n        customer_segment,\n        sum(coalesce(prev_mrr_amount, 0)) as starting_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount > coalesce(prev_mrr_amount, 0) then mrr_amount - prev_mrr_amount else 0 end) as expansion_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount > 0 and mrr_amount < coalesce(prev_mrr_amount, 0) then prev_mrr_amount - mrr_amount else 0 end) as contraction_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then prev_mrr_amount else 0 end) as churned_mrr\n    from with_prev\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_month_id,\n        date_month,\n        customer_segment,\n        starting_mrr,\n        expansion_mrr,\n        contraction_mrr,\n        churned_mrr,\n        case\n            when starting_mrr = 0 then 0\n            else (starting_mrr + expansion_mrr - contraction_mrr - churned_mrr) / starting_mrr\n        end as net_revenue_retention,\n        case\n            when starting_mrr = 0 then 0\n            else (starting_mrr - contraction_mrr - churned_mrr) / starting_mrr\n        end as gross_revenue_retention\n    from movement\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"net_revenue_retention\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.344262Z", "completed_at": "2026-02-05T20:13:41.349773Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.351164Z", "completed_at": "2026-02-05T20:13:41.351172Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009648799896240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_fct_monthly_recurring_revenue_mrr_amount__1000000__0.30bcc21edd", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.355262Z", "completed_at": "2026-02-05T20:13:41.360011Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.361372Z", "completed_at": "2026-02-05T20:13:41.361379Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008683919906616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_customer_id.a66423ce4f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.365529Z", "completed_at": "2026-02-05T20:13:41.370462Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.371830Z", "completed_at": "2026-02-05T20:13:41.371837Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008766412734985352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_customer_month_id.b7a062ebbc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_month_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere customer_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.375910Z", "completed_at": "2026-02-05T20:13:41.380825Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.382190Z", "completed_at": "2026-02-05T20:13:41.382197Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008773088455200195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_date_month.8089d21391", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.386272Z", "completed_at": "2026-02-05T20:13:41.392281Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.393632Z", "completed_at": "2026-02-05T20:13:41.393639Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00987100601196289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_mrr_amount.4c2963d658", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.397784Z", "completed_at": "2026-02-05T20:13:41.403591Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.404997Z", "completed_at": "2026-02-05T20:13:41.405005Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009758472442626953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_fct_monthly_recurring_revenue_customer_id__customer_id__ref_dim_customers_.09138f6532", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.409139Z", "completed_at": "2026-02-05T20:13:41.414035Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.415392Z", "completed_at": "2026-02-05T20:13:41.415400Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008786439895629883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_fct_monthly_recurring_revenue_customer_month_id.a9d2287217", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere customer_month_id is not null\ngroup by customer_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.419551Z", "completed_at": "2026-02-05T20:13:41.424679Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.426065Z", "completed_at": "2026-02-05T20:13:41.426073Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009093284606933594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_fct_subscriptions_billing_cycle__monthly__annual.f19036f213", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        billing_cycle as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    group by billing_cycle\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'monthly','annual'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.430218Z", "completed_at": "2026-02-05T20:13:41.436421Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.437812Z", "completed_at": "2026-02-05T20:13:41.437819Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010186433792114258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_fct_subscriptions_status__active__paused__churned__upgraded__downgraded.15fca4795f", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','paused','churned','upgraded','downgraded'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.441860Z", "completed_at": "2026-02-05T20:13:41.447334Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.448732Z", "completed_at": "2026-02-05T20:13:41.448740Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009420633316040039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_fct_subscriptions_amount__1000000__0.21af0e0ca7", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and amount >= 0 and amount <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.452869Z", "completed_at": "2026-02-05T20:13:41.458168Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.459540Z", "completed_at": "2026-02-05T20:13:41.459547Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00926065444946289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_fct_subscriptions_mrr_amount__100000__0.b7f8e4f817", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.463698Z", "completed_at": "2026-02-05T20:13:41.468615Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.469977Z", "completed_at": "2026-02-05T20:13:41.469984Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00885462760925293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_amount.77f80a5332", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.474050Z", "completed_at": "2026-02-05T20:13:41.479045Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.480407Z", "completed_at": "2026-02-05T20:13:41.480414Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008925914764404297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_billing_cycle.0a7a17a18b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect billing_cycle\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere billing_cycle is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.484510Z", "completed_at": "2026-02-05T20:13:41.490575Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.491957Z", "completed_at": "2026-02-05T20:13:41.491964Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009987831115722656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_customer_id.ae33a3a9d8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.496033Z", "completed_at": "2026-02-05T20:13:41.500919Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.502277Z", "completed_at": "2026-02-05T20:13:41.502284Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008812665939331055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_mrr_amount.0b5f93cb94", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.506339Z", "completed_at": "2026-02-05T20:13:41.511146Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.512512Z", "completed_at": "2026-02-05T20:13:41.512519Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008646249771118164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_plan_id.07baa591b1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.516621Z", "completed_at": "2026-02-05T20:13:41.521524Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.522889Z", "completed_at": "2026-02-05T20:13:41.522897Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008790254592895508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_status.daa1b1fe34", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.526954Z", "completed_at": "2026-02-05T20:13:41.532958Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.534297Z", "completed_at": "2026-02-05T20:13:41.534304Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009895801544189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_subscription_id.f690e778b1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.538344Z", "completed_at": "2026-02-05T20:13:41.606472Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.607888Z", "completed_at": "2026-02-05T20:13:41.607898Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07204651832580566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_fct_subscriptions_customer_id__customer_id__ref_dim_customers_.738b2dd4ca", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.612054Z", "completed_at": "2026-02-05T20:13:41.618246Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.619622Z", "completed_at": "2026-02-05T20:13:41.619633Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010137796401977539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_fct_subscriptions_plan_id__plan_id__ref_dim_plans_.09ecb91cb5", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select plan_id as from_field\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    where plan_id is not null\n),\n\nparent as (\n    select plan_id as to_field\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.624013Z", "completed_at": "2026-02-05T20:13:41.628975Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.630322Z", "completed_at": "2026-02-05T20:13:41.630330Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009062767028808594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_fct_subscriptions_subscription_id.71386a928a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.634377Z", "completed_at": "2026-02-05T20:13:41.639954Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.641330Z", "completed_at": "2026-02-05T20:13:41.641337Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009490013122558594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_subscription_periods_mrr_amount__100000__0.32396aeab0", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.645432Z", "completed_at": "2026-02-05T20:13:41.651181Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.652521Z", "completed_at": "2026-02-05T20:13:41.652528Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009633779525756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_subscription_periods_customer_id.33a91ad17a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.656811Z", "completed_at": "2026-02-05T20:13:41.661451Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.662809Z", "completed_at": "2026-02-05T20:13:41.662817Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008738994598388672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_subscription_periods_mrr_amount.c3d6239f36", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.666881Z", "completed_at": "2026-02-05T20:13:41.671703Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.673082Z", "completed_at": "2026-02-05T20:13:41.673090Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008779287338256836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_subscription_periods_subscription_id.228100b7db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.677165Z", "completed_at": "2026-02-05T20:13:41.683019Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.684391Z", "completed_at": "2026-02-05T20:13:41.684398Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009814262390136719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_subscription_periods_customer_id__customer_id__ref_stg_customers_.d2a65dcd76", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.688496Z", "completed_at": "2026-02-05T20:13:41.693221Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.694567Z", "completed_at": "2026-02-05T20:13:41.694575Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008614540100097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_subscription_periods_subscription_id.213d4156ea", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.698651Z", "completed_at": "2026-02-05T20:13:41.705267Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.706644Z", "completed_at": "2026-02-05T20:13:41.706652Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010487794876098633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_customer_health_score_health_score__100__0.0fbd6b513b", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and health_score >= 0 and health_score <= 100\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.710787Z", "completed_at": "2026-02-05T20:13:41.716196Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.717605Z", "completed_at": "2026-02-05T20:13:41.717612Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009357929229736328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_customer_health_score_payment_failure_rate_last_90d__1__0.7e1e7e5f41", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and payment_failure_rate_last_90d >= 0 and payment_failure_rate_last_90d <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.721781Z", "completed_at": "2026-02-05T20:13:41.726523Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.727906Z", "completed_at": "2026-02-05T20:13:41.727914Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008649587631225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_as_of_date.36d720fd53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect as_of_date\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere as_of_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.731976Z", "completed_at": "2026-02-05T20:13:41.736947Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.738311Z", "completed_at": "2026-02-05T20:13:41.738319Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008916139602661133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_customer_id.270547872f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.742410Z", "completed_at": "2026-02-05T20:13:41.748277Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.749634Z", "completed_at": "2026-02-05T20:13:41.749642Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00976872444152832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_health_score.f383d46da2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect health_score\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere health_score is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.753726Z", "completed_at": "2026-02-05T20:13:41.758836Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.760192Z", "completed_at": "2026-02-05T20:13:41.760199Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008954048156738281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_payment_failure_rate_last_90d.e26d5a38c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_failure_rate_last_90d\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere payment_failure_rate_last_90d is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.764267Z", "completed_at": "2026-02-05T20:13:41.770062Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.771440Z", "completed_at": "2026-02-05T20:13:41.771447Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009741067886352539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_customer_health_score_customer_id__customer_id__ref_stg_customers_.fe675ec61f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.775557Z", "completed_at": "2026-02-05T20:13:41.780285Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.781639Z", "completed_at": "2026-02-05T20:13:41.781646Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008640050888061523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_customer_health_score_customer_id.d7e00c064a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.785762Z", "completed_at": "2026-02-05T20:13:41.791213Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.792598Z", "completed_at": "2026-02-05T20:13:41.792604Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009364604949951172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_monthly_usage_event_count__100000000__0.7fcfb98d27", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and event_count >= 0 and event_count <= 100000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.796778Z", "completed_at": "2026-02-05T20:13:41.803378Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.804868Z", "completed_at": "2026-02-05T20:13:41.804875Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010688543319702148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_monthly_usage_total_usage_quantity__1000000000__0.a3a21278a6", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and total_usage_quantity >= 0 and total_usage_quantity <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.808997Z", "completed_at": "2026-02-05T20:13:41.813803Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.815162Z", "completed_at": "2026-02-05T20:13:41.815169Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008747339248657227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_customer_id.9f5a52035d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.819188Z", "completed_at": "2026-02-05T20:13:41.824123Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.825514Z", "completed_at": "2026-02-05T20:13:41.825521Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008819103240966797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_customer_month_id.74f34aceba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_month_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere customer_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.829598Z", "completed_at": "2026-02-05T20:13:41.834592Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.835987Z", "completed_at": "2026-02-05T20:13:41.835994Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008919954299926758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_event_count.823f19e9a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_count\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere event_count is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.840064Z", "completed_at": "2026-02-05T20:13:41.846016Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.847372Z", "completed_at": "2026-02-05T20:13:41.847379Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009827136993408203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_total_usage_quantity.9c8d7d37db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_usage_quantity\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere total_usage_quantity is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.851441Z", "completed_at": "2026-02-05T20:13:41.856282Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.857652Z", "completed_at": "2026-02-05T20:13:41.857660Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008750200271606445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_usage_month.5593c46a18", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect usage_month\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere usage_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.861794Z", "completed_at": "2026-02-05T20:13:41.867649Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.869059Z", "completed_at": "2026-02-05T20:13:41.869066Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009859085083007812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_monthly_usage_customer_id__customer_id__ref_stg_customers_.46c0ada6b9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.873219Z", "completed_at": "2026-02-05T20:13:41.877932Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.879276Z", "completed_at": "2026-02-05T20:13:41.879284Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008654594421386719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_monthly_usage_customer_month_id.50e00ffb9c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere customer_month_id is not null\ngroup by customer_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.883309Z", "completed_at": "2026-02-05T20:13:41.889281Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.890667Z", "completed_at": "2026-02-05T20:13:41.890674Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009859800338745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.customer_lifetime_value", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n    where date_month >= '2022-06-01'  -- Start after 6 months of data exists\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\nmrr as (\n    select\n        customer_id,\n        date_month,\n        mrr_amount\n    from \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\n),\n\nchurn as (\n    select\n        date_month,\n        customer_segment,\n        customer_churn_rate\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n),\n\n-- For each as_of_month, calculate ARPU using trailing 6 months\nsegment_arpu_by_month as (\n    select\n        m.date_month as as_of_month,\n        c.customer_segment,\n        avg(case when mrr.mrr_amount > 0 then mrr.mrr_amount end) as arpu\n    from months m\n    cross join customers c\n    left join mrr\n        on c.customer_id = mrr.customer_id\n        and mrr.date_month > m.date_month - interval 6 month\n        and mrr.date_month <= m.date_month\n    group by 1, 2\n),\n\n-- For each as_of_month, calculate avg churn using trailing 6 months\nsegment_churn_by_month as (\n    select\n        m.date_month as as_of_month,\n        ch.customer_segment,\n        avg(ch.customer_churn_rate) as avg_monthly_customer_churn_rate\n    from months m\n    join churn ch\n        on ch.date_month > m.date_month - interval 6 month\n        and ch.date_month <= m.date_month\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(a.as_of_month as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(coalesce(a.customer_segment, ch.customer_segment) as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_as_of_id,\n        a.as_of_month,\n        coalesce(a.customer_segment, ch.customer_segment) as customer_segment,\n        coalesce(a.arpu, 0) as arpu,\n        coalesce(ch.avg_monthly_customer_churn_rate, 0) as avg_monthly_customer_churn_rate,\n        case\n            when coalesce(ch.avg_monthly_customer_churn_rate, 0) = 0 then null\n            else least(120, 1.0 / ch.avg_monthly_customer_churn_rate)\n        end as expected_lifetime_months,\n        case\n            when coalesce(ch.avg_monthly_customer_churn_rate, 0) = 0 then null\n            else coalesce(a.arpu, 0) * least(120, 1.0 / ch.avg_monthly_customer_churn_rate)\n        end as lifetime_value\n    from segment_arpu_by_month a\n    full outer join segment_churn_by_month ch\n        on a.as_of_month = ch.as_of_month\n        and a.customer_segment = ch.customer_segment\n    where coalesce(a.as_of_month, ch.as_of_month) is not null\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"customer_lifetime_value\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.895144Z", "completed_at": "2026-02-05T20:13:41.901653Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.903097Z", "completed_at": "2026-02-05T20:13:41.903105Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010893106460571289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_churn_analysis_customer_segment__smb__mid_market__enterprise__unknown.12ff3b906a", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.907233Z", "completed_at": "2026-02-05T20:13:41.912670Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.914083Z", "completed_at": "2026-02-05T20:13:41.914091Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009447813034057617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_churned_customers__1000000000__0.ecf0d4d6a8", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and churned_customers >= 0 and churned_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.918255Z", "completed_at": "2026-02-05T20:13:41.923530Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.924933Z", "completed_at": "2026-02-05T20:13:41.924941Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009229898452758789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_customer_churn_rate__1__0.a3521c9c86", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and customer_churn_rate >= 0 and customer_churn_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.929058Z", "completed_at": "2026-02-05T20:13:41.934470Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.935884Z", "completed_at": "2026-02-05T20:13:41.935892Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009350061416625977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_revenue_churn_rate__1__0.ca578782ea", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and revenue_churn_rate >= 0 and revenue_churn_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.940042Z", "completed_at": "2026-02-05T20:13:41.946589Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.948263Z", "completed_at": "2026-02-05T20:13:41.948271Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010800361633300781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_starting_customers__1000000000__0.434546e5eb", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and starting_customers >= 0 and starting_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.952453Z", "completed_at": "2026-02-05T20:13:41.957294Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.958658Z", "completed_at": "2026-02-05T20:13:41.958667Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008871078491210938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_churned_customers.8445fc5f8a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect churned_customers\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere churned_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.962920Z", "completed_at": "2026-02-05T20:13:41.968628Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.970034Z", "completed_at": "2026-02-05T20:13:41.970043Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009770631790161133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_customer_churn_rate.b2257552ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_churn_rate\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere customer_churn_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.974206Z", "completed_at": "2026-02-05T20:13:41.979420Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.980817Z", "completed_at": "2026-02-05T20:13:41.980825Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009143352508544922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_customer_segment.f82e1dbd2a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.984923Z", "completed_at": "2026-02-05T20:13:41.989772Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:41.991128Z", "completed_at": "2026-02-05T20:13:41.991135Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008784770965576172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_date_month.aeceb24cdf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:41.995241Z", "completed_at": "2026-02-05T20:13:42.001528Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.002910Z", "completed_at": "2026-02-05T20:13:42.002917Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010201692581176758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_revenue_churn_rate.f68037cf43", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect revenue_churn_rate\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere revenue_churn_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.007023Z", "completed_at": "2026-02-05T20:13:42.011901Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.013274Z", "completed_at": "2026-02-05T20:13:42.013282Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008840799331665039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_segment_month_id.face7d9329", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_month_id\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere segment_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.017371Z", "completed_at": "2026-02-05T20:13:42.022082Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.023427Z", "completed_at": "2026-02-05T20:13:42.023434Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008528709411621094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_starting_customers.5eb8964198", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect starting_customers\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere starting_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.027469Z", "completed_at": "2026-02-05T20:13:42.032357Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.033736Z", "completed_at": "2026-02-05T20:13:42.033744Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008822441101074219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_churn_analysis_segment_month_id.d17ebe9d07", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere segment_month_id is not null\ngroup by segment_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.037976Z", "completed_at": "2026-02-05T20:13:42.044012Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.045380Z", "completed_at": "2026-02-05T20:13:42.045387Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00995326042175293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_cohort_retention_customer_segment__smb__mid_market__enterprise__unknown.537731c238", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.049475Z", "completed_at": "2026-02-05T20:13:42.054890Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.056291Z", "completed_at": "2026-02-05T20:13:42.056298Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009369850158691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_active_customers__1000000000__0.c41f1ccb43", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and active_customers >= 0 and active_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.060489Z", "completed_at": "2026-02-05T20:13:42.066259Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.067658Z", "completed_at": "2026-02-05T20:13:42.067666Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00973963737487793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_cohort_customers__1000000000__0.3ded49037c", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and cohort_customers >= 0 and cohort_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.071839Z", "completed_at": "2026-02-05T20:13:42.077422Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.078840Z", "completed_at": "2026-02-05T20:13:42.078848Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009546518325805664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_months_since_signup__120__0.3abf594756", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and months_since_signup >= 0 and months_since_signup <= 120\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.083008Z", "completed_at": "2026-02-05T20:13:42.088331Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.089746Z", "completed_at": "2026-02-05T20:13:42.089754Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009335041046142578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_retention_rate__1__0.75ce1e0e47", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and retention_rate >= 0 and retention_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.093899Z", "completed_at": "2026-02-05T20:13:42.100174Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.101528Z", "completed_at": "2026-02-05T20:13:42.101535Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010223865509033203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_active_customers.f50b652fd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect active_customers\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere active_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.105599Z", "completed_at": "2026-02-05T20:13:42.110466Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.111877Z", "completed_at": "2026-02-05T20:13:42.111884Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008810997009277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_cohort_customers.37da0ff420", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_customers\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.115979Z", "completed_at": "2026-02-05T20:13:42.120656Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.122025Z", "completed_at": "2026-02-05T20:13:42.122033Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008614778518676758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_cohort_month.0e607e02af", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_month\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.126112Z", "completed_at": "2026-02-05T20:13:42.130935Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.132283Z", "completed_at": "2026-02-05T20:13:42.132291Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008739233016967773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_cohort_segment_period_id.0d29ee4706", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_segment_period_id\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_segment_period_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.136356Z", "completed_at": "2026-02-05T20:13:42.142200Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.143552Z", "completed_at": "2026-02-05T20:13:42.143560Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009730100631713867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_customer_segment.c697b5eb0e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.147604Z", "completed_at": "2026-02-05T20:13:42.152443Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.153832Z", "completed_at": "2026-02-05T20:13:42.153839Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008716583251953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_months_since_signup.41d00203f4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect months_since_signup\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere months_since_signup is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.157963Z", "completed_at": "2026-02-05T20:13:42.162900Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.164261Z", "completed_at": "2026-02-05T20:13:42.164268Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008861780166625977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_retention_rate.8166dc37e8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect retention_rate\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere retention_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.168348Z", "completed_at": "2026-02-05T20:13:42.173059Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.174412Z", "completed_at": "2026-02-05T20:13:42.174420Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008617877960205078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_cohort_retention_cohort_segment_period_id.5afcaa3a16", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    cohort_segment_period_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_segment_period_id is not null\ngroup by cohort_segment_period_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.178510Z", "completed_at": "2026-02-05T20:13:42.183575Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.184957Z", "completed_at": "2026-02-05T20:13:42.184965Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008952140808105469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_mrr_analysis_customer_segment__smb__mid_market__enterprise__unknown.1257e5343c", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.189095Z", "completed_at": "2026-02-05T20:13:42.195785Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.197172Z", "completed_at": "2026-02-05T20:13:42.197179Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010667562484741211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_mrr_analysis_churned_mrr__1000000000__0.5cafc45ab5", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and churned_mrr >= 0 and churned_mrr <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.201292Z", "completed_at": "2026-02-05T20:13:42.206569Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.208005Z", "completed_at": "2026-02-05T20:13:42.208013Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009317398071289062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_mrr_analysis_new_mrr__1000000000__0.1d1f2a56be", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and new_mrr >= 0 and new_mrr <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.212130Z", "completed_at": "2026-02-05T20:13:42.217536Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.218949Z", "completed_at": "2026-02-05T20:13:42.218958Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009395360946655273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_mrr_analysis_total_mrr__1000000000__0.03c10ae006", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and total_mrr >= 0 and total_mrr <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.223066Z", "completed_at": "2026-02-05T20:13:42.228019Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.229388Z", "completed_at": "2026-02-05T20:13:42.229395Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008890151977539062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_churned_mrr.a3d399ce96", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect churned_mrr\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere churned_mrr is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.233482Z", "completed_at": "2026-02-05T20:13:42.239565Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.240929Z", "completed_at": "2026-02-05T20:13:42.240937Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009981393814086914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_customer_segment.c66caf3809", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.244991Z", "completed_at": "2026-02-05T20:13:42.249922Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.251275Z", "completed_at": "2026-02-05T20:13:42.251282Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00878143310546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_date_month.b31589f01e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.255363Z", "completed_at": "2026-02-05T20:13:42.260177Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.261521Z", "completed_at": "2026-02-05T20:13:42.261529Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008701562881469727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_new_mrr.7bd7ba8daa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect new_mrr\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere new_mrr is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.265611Z", "completed_at": "2026-02-05T20:13:42.270530Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.271920Z", "completed_at": "2026-02-05T20:13:42.271927Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008860349655151367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_segment_month_id.96b64accac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_month_id\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere segment_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.276003Z", "completed_at": "2026-02-05T20:13:42.280934Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.282284Z", "completed_at": "2026-02-05T20:13:42.282291Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00884556770324707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_total_mrr.80e9772030", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_mrr\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere total_mrr is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.286362Z", "completed_at": "2026-02-05T20:13:42.292412Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.293765Z", "completed_at": "2026-02-05T20:13:42.293772Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00993657112121582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_mrr_analysis_segment_month_id.73b748be94", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere segment_month_id is not null\ngroup by segment_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.297859Z", "completed_at": "2026-02-05T20:13:42.303215Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.304600Z", "completed_at": "2026-02-05T20:13:42.304611Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009354352951049805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_net_revenue_retention_customer_segment__smb__mid_market__enterprise__unknown.bad1f7855d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.308898Z", "completed_at": "2026-02-05T20:13:42.315083Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.316489Z", "completed_at": "2026-02-05T20:13:42.316499Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010267972946166992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_net_revenue_retention_gross_revenue_retention__1__0.069667a4ae", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and gross_revenue_retention >= 0 and gross_revenue_retention <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.320763Z", "completed_at": "2026-02-05T20:13:42.326328Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.327726Z", "completed_at": "2026-02-05T20:13:42.327734Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009557247161865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_net_revenue_retention_net_revenue_retention__5__0.02505b257b", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and net_revenue_retention >= 0 and net_revenue_retention <= 5\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.331922Z", "completed_at": "2026-02-05T20:13:42.338051Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.339413Z", "completed_at": "2026-02-05T20:13:42.339420Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010040044784545898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_customer_segment.a64b766957", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.343512Z", "completed_at": "2026-02-05T20:13:42.348294Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.349642Z", "completed_at": "2026-02-05T20:13:42.349650Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008713722229003906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_date_month.8b7a8fb0c8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.353928Z", "completed_at": "2026-02-05T20:13:42.358595Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.359977Z", "completed_at": "2026-02-05T20:13:42.359984Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008777379989624023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_gross_revenue_retention.11b3e16b67", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect gross_revenue_retention\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere gross_revenue_retention is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.364087Z", "completed_at": "2026-02-05T20:13:42.368904Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.370338Z", "completed_at": "2026-02-05T20:13:42.370345Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008736610412597656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_net_revenue_retention.8a6d154e31", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect net_revenue_retention\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere net_revenue_retention is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.374385Z", "completed_at": "2026-02-05T20:13:42.379253Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.380628Z", "completed_at": "2026-02-05T20:13:42.380635Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008785247802734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_segment_month_id.64a6b596d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_month_id\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere segment_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.384769Z", "completed_at": "2026-02-05T20:13:42.390625Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.391996Z", "completed_at": "2026-02-05T20:13:42.392003Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00971674919128418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_net_revenue_retention_segment_month_id.cc84fd260d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere segment_month_id is not null\ngroup by segment_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.395997Z", "completed_at": "2026-02-05T20:13:42.401610Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.403033Z", "completed_at": "2026-02-05T20:13:42.403040Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009505987167358398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.unit_economics", "compiled": true, "compiled_code": "with ltv as (\n    select\n        as_of_month,\n        customer_segment,\n        arpu,\n        avg_monthly_customer_churn_rate,\n        expected_lifetime_months,\n        lifetime_value\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n),\n\nwith_cac as (\n    select\n        as_of_month,\n        customer_segment,\n        arpu,\n        avg_monthly_customer_churn_rate,\n        expected_lifetime_months,\n        lifetime_value,\n        case\n            when customer_segment = 'smb' then 600\n            when customer_segment = 'mid-market' then 2500\n            when customer_segment = 'enterprise' then 12000\n            else null\n        end as assumed_cac\n    from ltv\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(as_of_month as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_as_of_id,\n        as_of_month,\n        customer_segment,\n        arpu,\n        avg_monthly_customer_churn_rate,\n        expected_lifetime_months,\n        lifetime_value,\n        assumed_cac,\n        case\n            when assumed_cac is null or assumed_cac = 0 then null\n            else lifetime_value / assumed_cac\n        end as ltv_to_cac_ratio,\n        case\n            when arpu is null or arpu = 0 or assumed_cac is null then null\n            else assumed_cac / arpu\n        end as payback_months\n    from with_cac\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"unit_economics\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.407388Z", "completed_at": "2026-02-05T20:13:42.412534Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.413947Z", "completed_at": "2026-02-05T20:13:42.413955Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009300470352172852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_customer_lifetime_value_customer_segment__smb__mid_market__enterprise__unknown.d1b95c9570", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.418105Z", "completed_at": "2026-02-05T20:13:42.423387Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.424784Z", "completed_at": "2026-02-05T20:13:42.424791Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009270906448364258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_arpu__1000000__0.149ff1813f", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and arpu >= 0 and arpu <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.428988Z", "completed_at": "2026-02-05T20:13:42.435410Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.436809Z", "completed_at": "2026-02-05T20:13:42.436816Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010478734970092773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_avg_monthly_customer_churn_rate__1__0.02204de856", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and avg_monthly_customer_churn_rate >= 0 and avg_monthly_customer_churn_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.440945Z", "completed_at": "2026-02-05T20:13:42.446899Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.448297Z", "completed_at": "2026-02-05T20:13:42.448304Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009958267211914062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_expected_lifetime_months__120__0__expected_lifetime_months_is_not_null.5d159b06eb", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and expected_lifetime_months >= 0 and expected_lifetime_months <= 120\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    where\n        expected_lifetime_months is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.452454Z", "completed_at": "2026-02-05T20:13:42.458271Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.459674Z", "completed_at": "2026-02-05T20:13:42.459681Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009801387786865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_lifetime_value__1000000000__0__lifetime_value_is_not_null.1e26703122", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and lifetime_value >= 0 and lifetime_value <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    where\n        lifetime_value is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.463855Z", "completed_at": "2026-02-05T20:13:42.468692Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.470049Z", "completed_at": "2026-02-05T20:13:42.470056Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008791923522949219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_arpu.68cf958b17", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect arpu\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere arpu is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.474092Z", "completed_at": "2026-02-05T20:13:42.478949Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.480296Z", "completed_at": "2026-02-05T20:13:42.480303Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008705854415893555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_as_of_month.2440beb6c2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect as_of_month\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere as_of_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.484384Z", "completed_at": "2026-02-05T20:13:42.490670Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.492034Z", "completed_at": "2026-02-05T20:13:42.492041Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010183572769165039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_avg_monthly_customer_churn_rate.1d3497b679", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_monthly_customer_churn_rate\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere avg_monthly_customer_churn_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.496160Z", "completed_at": "2026-02-05T20:13:42.500994Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.502341Z", "completed_at": "2026-02-05T20:13:42.502349Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008686065673828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_customer_segment.77e1bf04e8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.506419Z", "completed_at": "2026-02-05T20:13:42.511219Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.512571Z", "completed_at": "2026-02-05T20:13:42.512578Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008699178695678711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_segment_as_of_id.6b96a69161", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_as_of_id\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere segment_as_of_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.516893Z", "completed_at": "2026-02-05T20:13:42.521521Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.522884Z", "completed_at": "2026-02-05T20:13:42.522892Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008599281311035156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_customer_lifetime_value_segment_as_of_id.c8b6e3f3fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_as_of_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere segment_as_of_id is not null\ngroup by segment_as_of_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.527007Z", "completed_at": "2026-02-05T20:13:42.534080Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.535453Z", "completed_at": "2026-02-05T20:13:42.535460Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01104879379272461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_unit_economics_assumed_cac__1000000000__0__assumed_cac_is_not_null.0593deb695", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and assumed_cac >= 0 and assumed_cac <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"unit_economics\"\n    where\n        assumed_cac is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.539578Z", "completed_at": "2026-02-05T20:13:42.545699Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.547118Z", "completed_at": "2026-02-05T20:13:42.547126Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01011347770690918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_unit_economics_ltv_to_cac_ratio__1000__0__ltv_to_cac_ratio_is_not_null.d76c1f7ce7", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and ltv_to_cac_ratio >= 0 and ltv_to_cac_ratio <= 1000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"unit_economics\"\n    where\n        ltv_to_cac_ratio is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.551261Z", "completed_at": "2026-02-05T20:13:42.557119Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.558506Z", "completed_at": "2026-02-05T20:13:42.558513Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009788036346435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_unit_economics_payback_months__120__0__payback_months_is_not_null.77c8663847", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and payback_months >= 0 and payback_months <= 120\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"unit_economics\"\n    where\n        payback_months is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.562786Z", "completed_at": "2026-02-05T20:13:42.567662Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.569032Z", "completed_at": "2026-02-05T20:13:42.569039Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008812904357910156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_unit_economics_segment_as_of_id.1d127f6ec4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_as_of_id\nfrom \"saas_analytics\".\"main_marts\".\"unit_economics\"\nwhere segment_as_of_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T20:13:42.573104Z", "completed_at": "2026-02-05T20:13:42.577907Z"}, {"name": "execute", "started_at": "2026-02-05T20:13:42.579274Z", "completed_at": "2026-02-05T20:13:42.579281Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008661031723022461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_unit_economics_segment_as_of_id.5d713df7b9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_as_of_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"unit_economics\"\nwhere segment_as_of_id is not null\ngroup by segment_as_of_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 2.885067939758301, "args": {"invocation_command": "dbt docs generate", "compile": true, "print": true, "enable_legacy_logger": false, "which": "generate", "log_path": "/home/runner/work/saas-analytics-quality/saas-analytics-quality/dbt_project/logs", "cache_selected_only": false, "vars": {}, "log_format": "default", "partial_parse": true, "partial_parse_file_diff": true, "send_anonymous_usage_stats": true, "project_dir": "/home/runner/work/saas-analytics-quality/saas-analytics-quality/dbt_project", "show_resource_report": false, "exclude": [], "populate_cache": true, "defer": false, "use_colors_file": true, "static_parser": true, "use_colors": true, "favor_state": false, "write_json": true, "warn_error_options": {"include": [], "exclude": []}, "macro_debugging": false, "log_level": "info", "quiet": false, "select": [], "profiles_dir": ".", "indirect_selection": "eager", "log_format_file": "debug", "printer_width": 80, "log_level_file": "debug", "static": false, "introspect": true, "strict_mode": false, "version_check": true, "empty_catalog": false, "log_file_max_bytes": 10485760}}