{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.0", "generated_at": "2026-02-05T21:50:56.857603Z", "invocation_id": "91589a0b-4304-49ce-8fe6-8b5e5c282089", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.000963Z", "completed_at": "2026-02-05T21:50:54.052930Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.054383Z", "completed_at": "2026-02-05T21:50:54.054399Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05934548377990723, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.dim_dates", "compiled": true, "compiled_code": "with date_spine as (\n    \n\n\n\n\n\nwith rawdata as (\n\n    \n\n    \n\n    with p as (\n        select 0 as generated_number union all select 1\n    ), unioned as (\n\n    select\n\n    \n    p0.generated_number * power(2, 0)\n     + \n    \n    p1.generated_number * power(2, 1)\n     + \n    \n    p2.generated_number * power(2, 2)\n     + \n    \n    p3.generated_number * power(2, 3)\n     + \n    \n    p4.generated_number * power(2, 4)\n     + \n    \n    p5.generated_number * power(2, 5)\n     + \n    \n    p6.generated_number * power(2, 6)\n     + \n    \n    p7.generated_number * power(2, 7)\n     + \n    \n    p8.generated_number * power(2, 8)\n     + \n    \n    p9.generated_number * power(2, 9)\n     + \n    \n    p10.generated_number * power(2, 10)\n    \n    \n    + 1\n    as generated_number\n\n    from\n\n    \n    p as p0\n     cross join \n    \n    p as p1\n     cross join \n    \n    p as p2\n     cross join \n    \n    p as p3\n     cross join \n    \n    p as p4\n     cross join \n    \n    p as p5\n     cross join \n    \n    p as p6\n     cross join \n    \n    p as p7\n     cross join \n    \n    p as p8\n     cross join \n    \n    p as p9\n     cross join \n    \n    p as p10\n    \n    \n\n    )\n\n    select *\n    from unioned\n    where generated_number <= 1095\n    order by generated_number\n\n\n\n),\n\nall_periods as (\n\n    select (\n        \n\n    cast('2022-01-01' as date) + ((interval '1 day') * (row_number() over (order by 1) - 1))\n\n\n    ) as date_day\n    from rawdata\n\n),\n\nfiltered as (\n\n    select *\n    from all_periods\n    where date_day <= cast('2024-12-31' as date)\n\n)\n\nselect * from filtered\n\n\n),\n\nfinal as (\n    select\n        cast(date_day as date) as date_day,\n        date_trunc('month', date_day) as date_month,\n        extract(year from date_day) as year,\n        extract(quarter from date_day) as quarter,\n        extract(month from date_day) as month,\n        extract(day from date_day) as day_of_month,\n        extract(dow from date_day) as day_of_week,\n        case when extract(dow from date_day) in (0, 6) then true else false end as is_weekend\n    from date_spine\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"dim_dates\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.062303Z", "completed_at": "2026-02-05T21:50:54.066907Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.068347Z", "completed_at": "2026-02-05T21:50:54.068357Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008954524993896484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_customers", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"customers\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by customer_id\n            order by updated_at desc nulls last, created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(customer_id as integer) as customer_id,\n        lower(trim(email)) as email,\n        trim(company_name) as company_name,\n        cast(signup_date as date) as signup_date,\n        cast(end_date as date) as end_date,\n        lower(trim(account_status)) as account_status,\n        trim(industry) as industry,\n        trim(company_size) as company_size,\n        trim(country) as country,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.072749Z", "completed_at": "2026-02-05T21:50:54.077126Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.078575Z", "completed_at": "2026-02-05T21:50:54.078584Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008481502532958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_payments", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"payments\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by payment_id\n            order by created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(payment_id as integer) as payment_id,\n        cast(subscription_id as integer) as subscription_id,\n        cast(payment_date as date) as payment_date,\n        cast(amount as double) as amount,\n        lower(trim(status)) as status,\n        lower(trim(payment_method)) as payment_method,\n        cast(created_at as timestamp) as created_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_payments\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.082993Z", "completed_at": "2026-02-05T21:50:54.088343Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.089789Z", "completed_at": "2026-02-05T21:50:54.089798Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009598255157470703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_plans", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"plans\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by plan_id\n            order by created_date desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(plan_id as integer) as plan_id,\n        trim(plan_name) as plan_name,\n        lower(trim(plan_tier)) as plan_tier,\n        cast(base_price_monthly as double) as base_price_monthly,\n        cast(base_price_annual as double) as base_price_annual,\n        trim(features) as features,\n        cast(max_users as integer) as max_users,\n        cast(created_date as date) as created_date\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_plans\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.094306Z", "completed_at": "2026-02-05T21:50:54.098616Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.100035Z", "completed_at": "2026-02-05T21:50:54.100044Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008548259735107422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_subscriptions", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"subscriptions\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by subscription_id\n            order by updated_at desc nulls last, created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(subscription_id as integer) as subscription_id,\n        cast(customer_id as integer) as customer_id,\n        cast(plan_id as integer) as plan_id,\n        cast(start_date as date) as start_date,\n        cast(end_date as date) as end_date,\n        lower(trim(status)) as status,\n        cast(mrr_amount as double) as mrr_amount,\n        lower(trim(billing_cycle)) as billing_cycle,\n        cast(amount as double) as amount,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_subscriptions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.104725Z", "completed_at": "2026-02-05T21:50:54.108850Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.110275Z", "completed_at": "2026-02-05T21:50:54.110284Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008635520935058594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_support_tickets", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"support_tickets\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by ticket_id\n            order by created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(ticket_id as integer) as ticket_id,\n        cast(customer_id as integer) as customer_id,\n        cast(created_date as date) as created_date,\n        cast(resolved_date as date) as resolved_date,\n        lower(trim(category)) as category,\n        lower(trim(priority)) as priority,\n        cast(satisfaction_score as integer) as satisfaction_score,\n        cast(created_at as timestamp) as created_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_support_tickets\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.115039Z", "completed_at": "2026-02-05T21:50:54.119117Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.120526Z", "completed_at": "2026-02-05T21:50:54.120536Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008398056030273438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.stg_usage_events", "compiled": true, "compiled_code": "with source as (\n    select *\n    from \"saas_analytics\".\"main\".\"usage_events\"\n),\n\ndeduped as (\n    select\n        *,\n        row_number() over (\n            partition by event_id\n            order by created_at desc nulls last\n        ) as _row_num\n    from source\n),\n\nfinal as (\n    select\n        cast(event_id as integer) as event_id,\n        cast(customer_id as integer) as customer_id,\n        cast(event_date as date) as event_date,\n        lower(trim(event_type)) as event_type,\n        cast(usage_quantity as integer) as usage_quantity,\n        cast(created_at as timestamp) as created_at\n    from deduped\n    where _row_num = 1\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_staging\".\"stg_usage_events\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.125045Z", "completed_at": "2026-02-05T21:50:54.140606Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.142014Z", "completed_at": "2026-02-05T21:50:54.142024Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019844532012939453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_customers_customer_id.b4eeb23995", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main\".\"customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.146197Z", "completed_at": "2026-02-05T21:50:54.151288Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.152679Z", "completed_at": "2026-02-05T21:50:54.152686Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008997201919555664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_payments_payment_id.3057b24598", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_id\nfrom \"saas_analytics\".\"main\".\"payments\"\nwhere payment_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.156767Z", "completed_at": "2026-02-05T21:50:54.161949Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.163297Z", "completed_at": "2026-02-05T21:50:54.163303Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009091377258300781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_plans_plan_id.60ea0c3f70", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main\".\"plans\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.167402Z", "completed_at": "2026-02-05T21:50:54.172464Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.173859Z", "completed_at": "2026-02-05T21:50:54.173866Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00897669792175293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_subscriptions_subscription_id.d38f0dcd3e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main\".\"subscriptions\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.178084Z", "completed_at": "2026-02-05T21:50:54.183109Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.184521Z", "completed_at": "2026-02-05T21:50:54.184528Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009013891220092773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_support_tickets_ticket_id.f5e0ca9687", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"saas_analytics\".\"main\".\"support_tickets\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.188666Z", "completed_at": "2026-02-05T21:50:54.194917Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.196332Z", "completed_at": "2026-02-05T21:50:54.196339Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010197162628173828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_not_null_raw_saas_usage_events_event_id.6b4882f73b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"saas_analytics\".\"main\".\"usage_events\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.200502Z", "completed_at": "2026-02-05T21:50:54.209992Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.211415Z", "completed_at": "2026-02-05T21:50:54.211422Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013504981994628906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_payments_subscription_id__subscription_id__source_raw_saas_subscriptions_.eec6fd2df4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select subscription_id as from_field\n    from \"saas_analytics\".\"main\".\"payments\"\n    where subscription_id is not null\n),\n\nparent as (\n    select subscription_id as to_field\n    from \"saas_analytics\".\"main\".\"subscriptions\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.215622Z", "completed_at": "2026-02-05T21:50:54.222119Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.223535Z", "completed_at": "2026-02-05T21:50:54.223542Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010449409484863281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_subscriptions_customer_id__customer_id__source_raw_saas_customers_.d9d2470757", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main\".\"subscriptions\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main\".\"customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.227708Z", "completed_at": "2026-02-05T21:50:54.233785Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.235174Z", "completed_at": "2026-02-05T21:50:54.235181Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010018110275268555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_support_tickets_customer_id__customer_id__source_raw_saas_customers_.558da46c8f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main\".\"support_tickets\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main\".\"customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.239348Z", "completed_at": "2026-02-05T21:50:54.247143Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.248581Z", "completed_at": "2026-02-05T21:50:54.248588Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011774778366088867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_relationships_raw_saas_usage_events_customer_id__customer_id__source_raw_saas_customers_.edd5bda594", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main\".\"usage_events\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main\".\"customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.252830Z", "completed_at": "2026-02-05T21:50:54.260133Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.261537Z", "completed_at": "2026-02-05T21:50:54.261545Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011331319808959961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_customers_customer_id.5e4b5bfe1e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.265661Z", "completed_at": "2026-02-05T21:50:54.270568Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.271950Z", "completed_at": "2026-02-05T21:50:54.271956Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00881338119506836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_payments_payment_id.3ce97338e8", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    payment_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"payments\"\nwhere payment_id is not null\ngroup by payment_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.276045Z", "completed_at": "2026-02-05T21:50:54.280990Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.282391Z", "completed_at": "2026-02-05T21:50:54.282398Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008911609649658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_plans_plan_id.1874d4258c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    plan_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"plans\"\nwhere plan_id is not null\ngroup by plan_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.286574Z", "completed_at": "2026-02-05T21:50:54.291483Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.292858Z", "completed_at": "2026-02-05T21:50:54.292865Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008868217468261719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_subscriptions_subscription_id.f107c8e56a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"subscriptions\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.297099Z", "completed_at": "2026-02-05T21:50:54.303297Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.304700Z", "completed_at": "2026-02-05T21:50:54.304707Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010204315185546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_support_tickets_ticket_id.590438c9f6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"support_tickets\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.308823Z", "completed_at": "2026-02-05T21:50:54.313628Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.314998Z", "completed_at": "2026-02-05T21:50:54.315004Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008769989013671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.source_unique_raw_saas_usage_events_event_id.e76df55de9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main\".\"usage_events\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.319092Z", "completed_at": "2026-02-05T21:50:54.324066Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.325469Z", "completed_at": "2026-02-05T21:50:54.325476Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008866548538208008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_dates_date_day.1717af99fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_day\nfrom \"saas_analytics\".\"main_marts\".\"dim_dates\"\nwhere date_day is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.329627Z", "completed_at": "2026-02-05T21:50:54.334644Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.336028Z", "completed_at": "2026-02-05T21:50:54.336035Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008951187133789062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_dates_date_month.8043b8f3cb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"dim_dates\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.340156Z", "completed_at": "2026-02-05T21:50:54.344969Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.346378Z", "completed_at": "2026-02-05T21:50:54.346386Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008720159530639648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_dim_dates_date_day.5e9dfa95c7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    date_day as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"dim_dates\"\nwhere date_day is not null\ngroup by date_day\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.350579Z", "completed_at": "2026-02-05T21:50:54.355541Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.356975Z", "completed_at": "2026-02-05T21:50:54.356982Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008920907974243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.dim_customers", "compiled": true, "compiled_code": "with customers as (\n    select\n        customer_id,\n        email,\n        company_name,\n        industry,\n        company_size,\n        country,\n        signup_date,\n        end_date,\n        account_status\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n),\n\nfinal as (\n    select\n        customer_id,\n        email,\n        company_name,\n        industry,\n        company_size,\n        case\n            when lower(company_size) = 'small' then 'smb'\n            when lower(company_size) = 'medium' then 'mid-market'\n            when lower(company_size) = 'large' then 'enterprise'\n            else 'unknown'\n        end as customer_segment,\n        country,\n        signup_date,\n        end_date as churn_date,\n        account_status,\n        case when account_status = 'active' then true else false end as is_active\n    from customers\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"dim_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.361424Z", "completed_at": "2026-02-05T21:50:54.365027Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.366448Z", "completed_at": "2026-02-05T21:50:54.366455Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007796764373779297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_customer_cohorts", "compiled": true, "compiled_code": "with customers as (\n    select\n        customer_id,\n        signup_date\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n),\n\nfinal as (\n    select\n        customer_id,\n        date_trunc('month', signup_date) as cohort_month\n    from customers\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.370823Z", "completed_at": "2026-02-05T21:50:54.380611Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.382018Z", "completed_at": "2026-02-05T21:50:54.382025Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01393890380859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_customers_account_status__active__churned.4ba2500c79", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        account_status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n    group by account_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','churned'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.386195Z", "completed_at": "2026-02-05T21:50:54.405141Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.406584Z", "completed_at": "2026-02-05T21:50:54.406592Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02295064926147461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_match_regex_stg_customers_email___a_zA_Z0_9__a_zA_Z0_9_a_zA_Z0_9_.796c35c3c5", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \n\nregexp_matches(email, '^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\\.[a-zA-Z0-9-.]+$', '')\n\n\n > 0\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.410801Z", "completed_at": "2026-02-05T21:50:54.417000Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.418374Z", "completed_at": "2026-02-05T21:50:54.418380Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010196685791015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_account_status.d9b1d833ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect account_status\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere account_status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.422542Z", "completed_at": "2026-02-05T21:50:54.427511Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.428889Z", "completed_at": "2026-02-05T21:50:54.428898Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008920431137084961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_customer_id.e2cfb1f9aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.433144Z", "completed_at": "2026-02-05T21:50:54.438534Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.439902Z", "completed_at": "2026-02-05T21:50:54.439910Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009414434432983398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_email.d7cf761533", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere email is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.444092Z", "completed_at": "2026-02-05T21:50:54.449371Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.450781Z", "completed_at": "2026-02-05T21:50:54.450788Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009267568588256836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_customers_signup_date.ef12d9c335", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect signup_date\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere signup_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.455051Z", "completed_at": "2026-02-05T21:50:54.461194Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.462623Z", "completed_at": "2026-02-05T21:50:54.462632Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01018977165222168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_customers_customer_id.c7614daada", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.466862Z", "completed_at": "2026-02-05T21:50:54.483919Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.485353Z", "completed_at": "2026-02-05T21:50:54.485362Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021152734756469727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_payment_history", "compiled": true, "compiled_code": "with payments as (\n    select\n        subscription_id,\n        date_trunc('month', payment_date) as payment_month,\n        status,\n        amount\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n),\n\nmonthly_payments as (\n    select\n        subscription_id,\n        payment_month,\n        count(*) as payment_count,\n        sum(case when status = 'success' then 1 else 0 end) as successful_payments,\n        sum(case when status = 'failed' then 1 else 0 end) as failed_payments,\n        sum(case when status = 'refunded' then 1 else 0 end) as refunded_payments,\n        sum(amount) as net_amount\n    from payments\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(subscription_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(payment_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as subscription_month_id,\n        subscription_id,\n        payment_month,\n        payment_count,\n        successful_payments,\n        failed_payments,\n        refunded_payments,\n        net_amount\n    from monthly_payments\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_payment_history\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.490008Z", "completed_at": "2026-02-05T21:50:54.496947Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.498380Z", "completed_at": "2026-02-05T21:50:54.498387Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011258125305175781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_payments_payment_method__credit_card__bank_transfer__paypal.9a9e2818f7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        payment_method as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n    group by payment_method\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'credit_card','bank_transfer','paypal'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.502606Z", "completed_at": "2026-02-05T21:50:54.509021Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.510406Z", "completed_at": "2026-02-05T21:50:54.510413Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010567665100097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_payments_status__success__failed__refunded.f3ae67bf94", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'success','failed','refunded'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.514724Z", "completed_at": "2026-02-05T21:50:54.520681Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.522059Z", "completed_at": "2026-02-05T21:50:54.522066Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009931802749633789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_payment_id.c19cc50075", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere payment_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.526210Z", "completed_at": "2026-02-05T21:50:54.588411Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.589842Z", "completed_at": "2026-02-05T21:50:54.589852Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06627702713012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_payment_method.dad6ff229d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_method\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere payment_method is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.594053Z", "completed_at": "2026-02-05T21:50:54.599097Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.600476Z", "completed_at": "2026-02-05T21:50:54.600483Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009015321731567383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_status.dec3c85699", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.604580Z", "completed_at": "2026-02-05T21:50:54.609556Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.610919Z", "completed_at": "2026-02-05T21:50:54.610926Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008857965469360352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_payments_subscription_id.182bae4263", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.614977Z", "completed_at": "2026-02-05T21:50:54.619807Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.621203Z", "completed_at": "2026-02-05T21:50:54.621209Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0087127685546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_payments_payment_id.3744510712", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    payment_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_payments\"\nwhere payment_id is not null\ngroup by payment_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.625319Z", "completed_at": "2026-02-05T21:50:54.629991Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.631349Z", "completed_at": "2026-02-05T21:50:54.631356Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00852346420288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.dim_plans", "compiled": true, "compiled_code": "with plans as (\n    select\n        plan_id,\n        plan_name,\n        plan_tier,\n        base_price_monthly,\n        base_price_annual,\n        features,\n        max_users,\n        created_date\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n),\n\nfinal as (\n    select\n        plan_id,\n        plan_name,\n        plan_tier,\n        base_price_monthly,\n        base_price_annual,\n        max_users,\n        features,\n        created_date\n    from plans\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"dim_plans\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.635810Z", "completed_at": "2026-02-05T21:50:54.642449Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.643848Z", "completed_at": "2026-02-05T21:50:54.643856Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010867118835449219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_plans_plan_tier__starter__professional__enterprise.6627a5bb68", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        plan_tier as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n    group by plan_tier\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'starter','professional','enterprise'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.648085Z", "completed_at": "2026-02-05T21:50:54.660188Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.661720Z", "completed_at": "2026-02-05T21:50:54.661728Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016294002532958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_plans_base_price_annual__1000000__0.90f48edeea", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_annual >= 0 and base_price_annual <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.665979Z", "completed_at": "2026-02-05T21:50:54.671621Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.673027Z", "completed_at": "2026-02-05T21:50:54.673035Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009624719619750977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_plans_base_price_monthly__100000__0.29dde2c990", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_monthly >= 0 and base_price_monthly <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.677250Z", "completed_at": "2026-02-05T21:50:54.683698Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.685089Z", "completed_at": "2026-02-05T21:50:54.685097Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010482072830200195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_base_price_annual.7ff22b0352", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_annual\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere base_price_annual is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.689259Z", "completed_at": "2026-02-05T21:50:54.694340Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.695762Z", "completed_at": "2026-02-05T21:50:54.695769Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009106636047363281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_base_price_monthly.768fac3224", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_monthly\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere base_price_monthly is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.699964Z", "completed_at": "2026-02-05T21:50:54.704875Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.706245Z", "completed_at": "2026-02-05T21:50:54.706252Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008920907974243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_plan_id.97197e92e3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.710417Z", "completed_at": "2026-02-05T21:50:54.715582Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.716964Z", "completed_at": "2026-02-05T21:50:54.716971Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009052276611328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_plans_plan_tier.eba3d0c0c9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_tier\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere plan_tier is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.721090Z", "completed_at": "2026-02-05T21:50:54.726172Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.727584Z", "completed_at": "2026-02-05T21:50:54.727591Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009069204330444336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_plans_plan_id.b3adbcbaf7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    plan_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_plans\"\nwhere plan_id is not null\ngroup by plan_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.731825Z", "completed_at": "2026-02-05T21:50:54.740237Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.741665Z", "completed_at": "2026-02-05T21:50:54.741673Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012411832809448242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.fct_monthly_recurring_revenue", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\nsubscriptions as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        billing_cycle,\n        amount,\n        -- Normalize MRR from amount + billing_cycle (more robust than trusting raw mrr_amount)\n        \n    case\n        when billing_cycle = 'annual' then amount / 12.0\n        when billing_cycle = 'monthly' then amount\n        else 0\n    end\n as normalized_mrr_amount\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n),\n\nsubscription_months as (\n    select\n        s.customer_id,\n        s.subscription_id,\n        s.plan_id,\n        m.date_month,\n        s.status,\n        s.billing_cycle,\n        s.amount,\n        case\n            when s.status = 'paused' then 0\n            else s.normalized_mrr_amount\n        end as mrr_amount\n    from subscriptions s\n    join months m\n        on m.date_month >= date_trunc('month', s.start_date)\n        and (\n            s.end_date is null\n            or m.date_month <= date_trunc('month', s.end_date)\n        )\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_month_id,\n        customer_id,\n        date_month,\n        sum(mrr_amount) as mrr_amount,\n        count(distinct subscription_id) as subscription_count\n    from subscription_months\n    group by 1, 2, 3\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.745930Z", "completed_at": "2026-02-05T21:50:54.750008Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.751407Z", "completed_at": "2026-02-05T21:50:54.751414Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008175134658813477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.fct_subscriptions", "compiled": true, "compiled_code": "with subscriptions as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        billing_cycle,\n        amount,\n        mrr_amount\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n),\n\nfinal as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        billing_cycle,\n        amount,\n        mrr_amount,\n        case\n            when status = 'active' then true\n            else false\n        end as is_currently_active\n    from subscriptions\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"fct_subscriptions\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.755942Z", "completed_at": "2026-02-05T21:50:54.759681Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.761054Z", "completed_at": "2026-02-05T21:50:54.761061Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007965326309204102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_subscription_periods", "compiled": true, "compiled_code": "with subscriptions as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        mrr_amount,\n        billing_cycle,\n        amount\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n),\n\nfinal as (\n    select\n        subscription_id,\n        customer_id,\n        plan_id,\n        start_date,\n        end_date,\n        status,\n        mrr_amount,\n        billing_cycle,\n        amount\n    from subscriptions\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.765322Z", "completed_at": "2026-02-05T21:50:54.771828Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.773215Z", "completed_at": "2026-02-05T21:50:54.773222Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010495662689208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_subscriptions_billing_cycle__monthly__annual.373ee04739", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        billing_cycle as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    group by billing_cycle\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'monthly','annual'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.777372Z", "completed_at": "2026-02-05T21:50:54.785086Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.786504Z", "completed_at": "2026-02-05T21:50:54.786511Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011663198471069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_subscriptions_status__active__paused__churned__upgraded__downgraded.2ca9adef65", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','paused','churned','upgraded','downgraded'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.790614Z", "completed_at": "2026-02-05T21:50:54.796103Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.797512Z", "completed_at": "2026-02-05T21:50:54.797520Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009406089782714844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_subscriptions_amount__1000000__0.0aec0f7ac5", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and amount >= 0 and amount <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.801662Z", "completed_at": "2026-02-05T21:50:54.807176Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.808602Z", "completed_at": "2026-02-05T21:50:54.808609Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009566307067871094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_subscriptions_mrr_amount__100000__0.1f718c7d2b", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.812742Z", "completed_at": "2026-02-05T21:50:54.817759Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.819131Z", "completed_at": "2026-02-05T21:50:54.819137Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008891105651855469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_amount.d2bc105990", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.823250Z", "completed_at": "2026-02-05T21:50:54.828250Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.829630Z", "completed_at": "2026-02-05T21:50:54.829637Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008879423141479492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_billing_cycle.a5cc3f107d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect billing_cycle\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere billing_cycle is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.833728Z", "completed_at": "2026-02-05T21:50:54.840212Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.841589Z", "completed_at": "2026-02-05T21:50:54.841597Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010361671447753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_customer_id.2baac6ebd7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.845632Z", "completed_at": "2026-02-05T21:50:54.850697Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.852067Z", "completed_at": "2026-02-05T21:50:54.852074Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00893259048461914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_mrr_amount.9940a0b6a0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.856173Z", "completed_at": "2026-02-05T21:50:54.861112Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.862573Z", "completed_at": "2026-02-05T21:50:54.862580Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00897073745727539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_plan_id.ebc4c7e103", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.866719Z", "completed_at": "2026-02-05T21:50:54.871871Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.873239Z", "completed_at": "2026-02-05T21:50:54.873246Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009035348892211914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_start_date.aae12535b8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect start_date\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere start_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.877373Z", "completed_at": "2026-02-05T21:50:54.883475Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.884822Z", "completed_at": "2026-02-05T21:50:54.884829Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00993204116821289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_status.e945ee07e0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.888906Z", "completed_at": "2026-02-05T21:50:54.893873Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.895233Z", "completed_at": "2026-02-05T21:50:54.895240Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008915185928344727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_subscriptions_subscription_id.68a3edda91", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.899347Z", "completed_at": "2026-02-05T21:50:54.905317Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.906737Z", "completed_at": "2026-02-05T21:50:54.906745Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00991964340209961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_payments_subscription_id__subscription_id__ref_stg_subscriptions_.0ab4d26fa6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select subscription_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\"\n    where subscription_id is not null\n),\n\nparent as (\n    select subscription_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.911032Z", "completed_at": "2026-02-05T21:50:54.917183Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.918622Z", "completed_at": "2026-02-05T21:50:54.918631Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010187864303588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_subscriptions_customer_id__customer_id__ref_stg_customers_.3a4746f98e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.922880Z", "completed_at": "2026-02-05T21:50:54.929379Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.930792Z", "completed_at": "2026-02-05T21:50:54.930800Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010556459426879883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_subscriptions_plan_id__plan_id__ref_stg_plans_.9e3939335e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select plan_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n    where plan_id is not null\n),\n\nparent as (\n    select plan_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_plans\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.935088Z", "completed_at": "2026-02-05T21:50:54.941757Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.943142Z", "completed_at": "2026-02-05T21:50:54.943149Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01074528694152832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_subscriptions_subscription_id.d45e893a6e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.947290Z", "completed_at": "2026-02-05T21:50:54.954556Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.955951Z", "completed_at": "2026-02-05T21:50:54.955958Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011189937591552734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_support_tickets_category__billing__technical__feature_request__other.2da1083ca7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        category as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    group by category\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'billing','technical','feature_request','other'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.960114Z", "completed_at": "2026-02-05T21:50:54.967375Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.968803Z", "completed_at": "2026-02-05T21:50:54.968810Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011214494705200195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_support_tickets_priority__low__medium__high__urgent.63d517161e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        priority as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    group by priority\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'low','medium','high','urgent'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.973164Z", "completed_at": "2026-02-05T21:50:54.979038Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.980421Z", "completed_at": "2026-02-05T21:50:54.980428Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009888648986816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_support_tickets_satisfaction_score__5__1__satisfaction_score_is_not_null.ea8ac41f35", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and satisfaction_score >= 1 and satisfaction_score <= 5\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    where\n        satisfaction_score is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.984623Z", "completed_at": "2026-02-05T21:50:54.990716Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:54.992066Z", "completed_at": "2026-02-05T21:50:54.992072Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010034561157226562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_category.28b0c1060c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere category is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:54.996347Z", "completed_at": "2026-02-05T21:50:55.001494Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.002909Z", "completed_at": "2026-02-05T21:50:55.002917Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009221792221069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_customer_id.1a8e520036", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.007156Z", "completed_at": "2026-02-05T21:50:55.012075Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.013430Z", "completed_at": "2026-02-05T21:50:55.013452Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008888721466064453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_priority.beb363395f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect priority\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere priority is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.017637Z", "completed_at": "2026-02-05T21:50:55.022678Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.024043Z", "completed_at": "2026-02-05T21:50:55.024052Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008944511413574219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_support_tickets_ticket_id.7830ecbac2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ticket_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere ticket_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.028465Z", "completed_at": "2026-02-05T21:50:55.036665Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.038128Z", "completed_at": "2026-02-05T21:50:55.038142Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012561798095703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_support_tickets_customer_id__customer_id__ref_stg_customers_.be9984b1c6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.042533Z", "completed_at": "2026-02-05T21:50:55.047813Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.049176Z", "completed_at": "2026-02-05T21:50:55.049185Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009215354919433594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_support_tickets_ticket_id.eed19dcb0a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    ticket_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"\nwhere ticket_id is not null\ngroup by ticket_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.053344Z", "completed_at": "2026-02-05T21:50:55.059127Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.060622Z", "completed_at": "2026-02-05T21:50:55.060630Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00980067253112793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_customer_health_score", "compiled": true, "compiled_code": "with customers as (\n    select\n        customer_id\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n),\n\nas_of as (\n    select\n        greatest(\n            coalesce((select max(event_date) from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"), date '1900-01-01'),\n            coalesce((select max(payment_date) from \"saas_analytics\".\"main_staging\".\"stg_payments\"), date '1900-01-01'),\n            coalesce((select max(created_date) from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\"), date '1900-01-01')\n        ) as as_of_date\n),\n\nusage_last_30d as (\n    select\n        ue.customer_id,\n        count(*) as events_last_30d,\n        sum(ue.usage_quantity) as usage_quantity_last_30d\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\" ue\n    cross join as_of a\n    where ue.event_date > a.as_of_date - interval 30 day\n      and ue.event_date <= a.as_of_date\n    group by 1\n),\n\ntickets_last_90d as (\n    select\n        t.customer_id,\n        count(*) as tickets_created_last_90d,\n        sum(case when t.resolved_date is null then 1 else 0 end) as open_tickets\n    from \"saas_analytics\".\"main_staging\".\"stg_support_tickets\" t\n    cross join as_of a\n    where t.created_date > a.as_of_date - interval 90 day\n      and t.created_date <= a.as_of_date\n    group by 1\n),\n\npayment_failures_last_90d as (\n    select\n        s.customer_id,\n        count(*) as payment_events_last_90d,\n        sum(case when p.status = 'failed' then 1 else 0 end) as failed_payments_last_90d\n    from \"saas_analytics\".\"main_staging\".\"stg_payments\" p\n    join \"saas_analytics\".\"main_staging\".\"stg_subscriptions\" s\n        on p.subscription_id = s.subscription_id\n    cross join as_of a\n    where p.payment_date > a.as_of_date - interval 90 day\n      and p.payment_date <= a.as_of_date\n    group by 1\n),\n\nscored as (\n    select\n        c.customer_id,\n        a.as_of_date,\n        coalesce(u.events_last_30d, 0) as events_last_30d,\n        coalesce(u.usage_quantity_last_30d, 0) as usage_quantity_last_30d,\n        coalesce(t.tickets_created_last_90d, 0) as tickets_created_last_90d,\n        coalesce(t.open_tickets, 0) as open_tickets,\n        coalesce(p.payment_events_last_90d, 0) as payment_events_last_90d,\n        coalesce(p.failed_payments_last_90d, 0) as failed_payments_last_90d,\n        case\n            when coalesce(p.payment_events_last_90d, 0) = 0 then 0\n            else coalesce(p.failed_payments_last_90d, 0)::double / p.payment_events_last_90d\n        end as payment_failure_rate_last_90d\n    from customers c\n    cross join as_of a\n    left join usage_last_30d u\n        on c.customer_id = u.customer_id\n    left join tickets_last_90d t\n        on c.customer_id = t.customer_id\n    left join payment_failures_last_90d p\n        on c.customer_id = p.customer_id\n),\n\nfinal as (\n    select\n        customer_id,\n        as_of_date,\n        events_last_30d,\n        usage_quantity_last_30d,\n        tickets_created_last_90d,\n        open_tickets,\n        payment_events_last_90d,\n        failed_payments_last_90d,\n        payment_failure_rate_last_90d,\n        least(\n            100,\n            greatest(\n                0,\n                70\n                + least(30, events_last_30d)::integer\n                - least(40, open_tickets * 10)::integer\n                - least(40, (payment_failure_rate_last_90d * 100)::integer)\n            )\n        ) as health_score\n    from scored\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.064808Z", "completed_at": "2026-02-05T21:50:55.071276Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.072742Z", "completed_at": "2026-02-05T21:50:55.072751Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010571479797363281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.int_monthly_usage", "compiled": true, "compiled_code": "with usage_events as (\n    select\n        customer_id,\n        date_trunc('month', event_date) as usage_month,\n        event_type,\n        usage_quantity\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n),\n\nmonthly_usage as (\n    select\n        customer_id,\n        usage_month,\n        count(*) as event_count,\n        sum(usage_quantity) as total_usage_quantity,\n        sum(case when event_type = 'login' then 1 else 0 end) as login_events,\n        sum(case when event_type = 'feature_usage' then 1 else 0 end) as feature_usage_events,\n        sum(case when event_type = 'export' then 1 else 0 end) as export_events,\n        sum(case when event_type = 'api_call' then 1 else 0 end) as api_call_events\n    from usage_events\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(usage_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as customer_month_id,\n        customer_id,\n        usage_month,\n        event_count,\n        total_usage_quantity,\n        login_events,\n        feature_usage_events,\n        export_events,\n        api_call_events\n    from monthly_usage\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.077027Z", "completed_at": "2026-02-05T21:50:55.084966Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.086362Z", "completed_at": "2026-02-05T21:50:55.086369Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011930227279663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_stg_usage_events_event_type__login__feature_usage__export__api_call.9e239b4047", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        event_type as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n    group by event_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'login','feature_usage','export','api_call'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.090553Z", "completed_at": "2026-02-05T21:50:55.098139Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.099585Z", "completed_at": "2026-02-05T21:50:55.099594Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01165914535522461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_stg_usage_events_usage_quantity__1000000__0.a19ac32495", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and usage_quantity >= 0 and usage_quantity <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.103801Z", "completed_at": "2026-02-05T21:50:55.108733Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.110083Z", "completed_at": "2026-02-05T21:50:55.110091Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008832216262817383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_customer_id.424cb78bfc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.114296Z", "completed_at": "2026-02-05T21:50:55.119404Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.120787Z", "completed_at": "2026-02-05T21:50:55.120794Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009114503860473633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_event_id.2c1891cce4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_id\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere event_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.125044Z", "completed_at": "2026-02-05T21:50:55.130336Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.131754Z", "completed_at": "2026-02-05T21:50:55.131763Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0094146728515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_event_type.b865685b11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_type\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere event_type is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.135994Z", "completed_at": "2026-02-05T21:50:55.142688Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.144056Z", "completed_at": "2026-02-05T21:50:55.144066Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010694265365600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_stg_usage_events_usage_quantity.8fafec8a69", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect usage_quantity\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere usage_quantity is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.148252Z", "completed_at": "2026-02-05T21:50:55.154458Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.155903Z", "completed_at": "2026-02-05T21:50:55.155913Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01029062271118164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_stg_usage_events_customer_id__customer_id__ref_stg_customers_.33deb2f692", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.160256Z", "completed_at": "2026-02-05T21:50:55.165505Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.166883Z", "completed_at": "2026-02-05T21:50:55.166892Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009213924407958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_stg_usage_events_event_id.8f4005aa34", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_staging\".\"stg_usage_events\"\nwhere event_id is not null\ngroup by event_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.171097Z", "completed_at": "2026-02-05T21:50:55.178202Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.179605Z", "completed_at": "2026-02-05T21:50:55.179614Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011106014251708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_dim_customers_customer_segment__smb__mid_market__enterprise__unknown.59f6eba2cc", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.183753Z", "completed_at": "2026-02-05T21:50:55.188936Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.190300Z", "completed_at": "2026-02-05T21:50:55.190307Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0090789794921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_customer_id.dd91cd1c8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.194507Z", "completed_at": "2026-02-05T21:50:55.201579Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.202973Z", "completed_at": "2026-02-05T21:50:55.202981Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01103973388671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_customer_segment.bc342ee8ba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.207117Z", "completed_at": "2026-02-05T21:50:55.212039Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.213392Z", "completed_at": "2026-02-05T21:50:55.213399Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00877690315246582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_email.ed68b54d1a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect email\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere email is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.217454Z", "completed_at": "2026-02-05T21:50:55.222554Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.223952Z", "completed_at": "2026-02-05T21:50:55.223961Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00902867317199707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_customers_signup_date.7f7d0227dd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect signup_date\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere signup_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.228172Z", "completed_at": "2026-02-05T21:50:55.233733Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.235080Z", "completed_at": "2026-02-05T21:50:55.235090Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00946950912475586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_dim_customers_customer_id.15c9f1e2fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"dim_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.239392Z", "completed_at": "2026-02-05T21:50:55.246370Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.247756Z", "completed_at": "2026-02-05T21:50:55.247766Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01094675064086914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_cohorts_cohort_month.5f7f1ecfb6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_month\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\"\nwhere cohort_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.251925Z", "completed_at": "2026-02-05T21:50:55.258007Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.259416Z", "completed_at": "2026-02-05T21:50:55.259427Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01016688346862793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_cohorts_customer_id.a75833fcff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.263637Z", "completed_at": "2026-02-05T21:50:55.269000Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.270344Z", "completed_at": "2026-02-05T21:50:55.270352Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009260892868041992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_customer_cohorts_customer_id.279a739d39", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_cohorts\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.274541Z", "completed_at": "2026-02-05T21:50:55.280467Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.281862Z", "completed_at": "2026-02-05T21:50:55.281870Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009936094284057617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_payment_history_net_amount__1000000000___1000000000.297926e2b5", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and net_amount >= -1000000000 and net_amount <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.286413Z", "completed_at": "2026-02-05T21:50:55.292657Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.294147Z", "completed_at": "2026-02-05T21:50:55.294158Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010442018508911133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_payment_history_payment_count__100000000__0.41e5b20a2f", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and payment_count >= 0 and payment_count <= 100000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.298503Z", "completed_at": "2026-02-05T21:50:55.305480Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.306848Z", "completed_at": "2026-02-05T21:50:55.306857Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011070728302001953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_net_amount.c0b496bbc8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect net_amount\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere net_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.311045Z", "completed_at": "2026-02-05T21:50:55.316128Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.317551Z", "completed_at": "2026-02-05T21:50:55.317559Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00904536247253418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_payment_count.c9d746fa8b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_count\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere payment_count is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.321848Z", "completed_at": "2026-02-05T21:50:55.327467Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.328879Z", "completed_at": "2026-02-05T21:50:55.328889Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009668827056884766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_payment_month.218496379c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_month\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere payment_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.333089Z", "completed_at": "2026-02-05T21:50:55.338541Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.339931Z", "completed_at": "2026-02-05T21:50:55.339939Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00939631462097168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_subscription_id.f530bb3c51", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.344108Z", "completed_at": "2026-02-05T21:50:55.350653Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.352066Z", "completed_at": "2026-02-05T21:50:55.352075Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010576009750366211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_payment_history_subscription_month_id.ea8c983f61", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_month_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere subscription_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.356473Z", "completed_at": "2026-02-05T21:50:55.363156Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.364608Z", "completed_at": "2026-02-05T21:50:55.364618Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010823965072631836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_payment_history_subscription_id__subscription_id__ref_stg_subscriptions_.c2dc1d48a4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select subscription_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\n    where subscription_id is not null\n),\n\nparent as (\n    select subscription_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_subscriptions\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.368871Z", "completed_at": "2026-02-05T21:50:55.374266Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.375784Z", "completed_at": "2026-02-05T21:50:55.375793Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00960850715637207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_payment_history_subscription_month_id.d1f891bb75", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_payment_history\"\nwhere subscription_month_id is not null\ngroup by subscription_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.380083Z", "completed_at": "2026-02-05T21:50:55.386054Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.387477Z", "completed_at": "2026-02-05T21:50:55.387489Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010126352310180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_dim_plans_plan_tier__starter__professional__enterprise.951b43f83d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        plan_tier as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n    group by plan_tier\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'starter','professional','enterprise'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.391784Z", "completed_at": "2026-02-05T21:50:55.397952Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.399363Z", "completed_at": "2026-02-05T21:50:55.399372Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010191679000854492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_dim_plans_base_price_annual__1000000__0.3da0c08240", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_annual >= 0 and base_price_annual <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.403690Z", "completed_at": "2026-02-05T21:50:55.411337Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.412863Z", "completed_at": "2026-02-05T21:50:55.412873Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011894941329956055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_dim_plans_base_price_monthly__100000__0.80491e18f9", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and base_price_monthly >= 0 and base_price_monthly <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.417220Z", "completed_at": "2026-02-05T21:50:55.422882Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.424252Z", "completed_at": "2026-02-05T21:50:55.424262Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009648323059082031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_base_price_annual.eee138969b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_annual\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere base_price_annual is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.428467Z", "completed_at": "2026-02-05T21:50:55.433715Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.435079Z", "completed_at": "2026-02-05T21:50:55.435086Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009133338928222656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_base_price_monthly.0aa94d6b4b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect base_price_monthly\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere base_price_monthly is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.439221Z", "completed_at": "2026-02-05T21:50:55.444431Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.445830Z", "completed_at": "2026-02-05T21:50:55.445837Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00911855697631836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_plan_id.78a937462a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.450109Z", "completed_at": "2026-02-05T21:50:55.456901Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.458301Z", "completed_at": "2026-02-05T21:50:55.458311Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010939598083496094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_dim_plans_plan_tier.154dd327a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_tier\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere plan_tier is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.462541Z", "completed_at": "2026-02-05T21:50:55.467753Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.469113Z", "completed_at": "2026-02-05T21:50:55.469121Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009122133255004883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_dim_plans_plan_id.27d8cecd0f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    plan_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"dim_plans\"\nwhere plan_id is not null\ngroup by plan_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.473289Z", "completed_at": "2026-02-05T21:50:55.479340Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.480809Z", "completed_at": "2026-02-05T21:50:55.480818Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010054349899291992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.churn_analysis", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\ncustomer_month_spine as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        m.date_month\n    from customers c\n    cross join months m\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\nwith_prev as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        lag(mrr_amount) over (partition by customer_id order by date_month) as prev_mrr_amount\n    from customer_mrr\n),\n\nmonthly as (\n    select\n        date_month,\n        customer_segment,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 then 1 else 0 end) as starting_customers,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then 1 else 0 end) as churned_customers,\n        sum(coalesce(prev_mrr_amount, 0)) as starting_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then coalesce(prev_mrr_amount, 0) else 0 end) as churned_mrr\n    from with_prev\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_month_id,\n        date_month,\n        customer_segment,\n        starting_customers,\n        churned_customers,\n        case\n            when starting_customers = 0 then 0\n            else churned_customers::double / starting_customers\n        end as customer_churn_rate,\n        starting_mrr,\n        churned_mrr,\n        case\n            when starting_mrr = 0 then 0\n            else churned_mrr / starting_mrr\n        end as revenue_churn_rate\n    from monthly\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"churn_analysis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.485455Z", "completed_at": "2026-02-05T21:50:55.492182Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.493642Z", "completed_at": "2026-02-05T21:50:55.493653Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011231660842895508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.cohort_retention", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncohorts as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        date_trunc('month', c.signup_date) as cohort_month\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\" c\n),\n\ncohort_sizes as (\n    select\n        cohort_month,\n        customer_segment,\n        count(*) as cohort_customers\n    from cohorts\n    group by 1, 2\n),\n\ncustomer_month_spine as (\n    select\n        co.customer_id,\n        co.customer_segment,\n        co.cohort_month,\n        m.date_month\n    from cohorts co\n    join months m\n        on m.date_month >= co.cohort_month\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.cohort_month,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\nactive_customers as (\n    select\n        cohort_month,\n        customer_segment,\n        date_month,\n        datediff('month', cohort_month, date_month) as months_since_signup,\n        count(distinct case when mrr_amount > 0 then customer_id end) as active_customers\n    from customer_mrr\n    group by 1, 2, 3, 4\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(a.customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(a.cohort_month as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(a.months_since_signup as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as cohort_segment_period_id,\n        a.cohort_month,\n        a.customer_segment,\n        a.months_since_signup,\n        a.date_month as active_month,\n        s.cohort_customers,\n        a.active_customers,\n        case\n            when s.cohort_customers = 0 then 0\n            else a.active_customers::double / s.cohort_customers\n        end as retention_rate\n    from active_customers a\n    join cohort_sizes s\n        on a.cohort_month = s.cohort_month\n        and a.customer_segment = s.customer_segment\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"cohort_retention\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.498173Z", "completed_at": "2026-02-05T21:50:55.505836Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.507254Z", "completed_at": "2026-02-05T21:50:55.507263Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012060880661010742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.mrr_analysis", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\ncustomer_month_spine as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        m.date_month\n    from customers c\n    cross join months m\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\ncustomer_mrr_with_prev as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        lag(mrr_amount) over (partition by customer_id order by date_month) as prev_mrr_amount\n    from customer_mrr\n),\n\nclassified as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        coalesce(prev_mrr_amount, 0) as prev_mrr_amount,\n        mrr_amount - coalesce(prev_mrr_amount, 0) as mrr_change,\n        case\n            when coalesce(prev_mrr_amount, 0) = 0 and mrr_amount > 0 then 'new'\n            when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then 'churn'\n            when mrr_amount > coalesce(prev_mrr_amount, 0) and coalesce(prev_mrr_amount, 0) > 0 then 'expansion'\n            when mrr_amount < coalesce(prev_mrr_amount, 0) and mrr_amount > 0 then 'contraction'\n            else 'no_change'\n        end as mrr_movement_type\n    from customer_mrr_with_prev\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_month_id,\n        date_month,\n        customer_segment,\n        sum(mrr_amount) as total_mrr,\n        sum(case when mrr_movement_type = 'new' then mrr_amount else 0 end) as new_mrr,\n        sum(case when mrr_movement_type = 'expansion' then mrr_change else 0 end) as expansion_mrr,\n        sum(case when mrr_movement_type = 'contraction' then abs(mrr_change) else 0 end) as contraction_mrr,\n        sum(case when mrr_movement_type = 'churn' then prev_mrr_amount else 0 end) as churned_mrr,\n        sum(case when mrr_movement_type in ('new', 'expansion') then mrr_change else 0 end)\n        - sum(case when mrr_movement_type in ('contraction', 'churn') then abs(mrr_change) else 0 end) as net_new_mrr\n    from classified\n    group by 1, 2, 3\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"mrr_analysis\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.511875Z", "completed_at": "2026-02-05T21:50:55.518206Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.519661Z", "completed_at": "2026-02-05T21:50:55.519672Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010686159133911133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.net_revenue_retention", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\ncustomer_month_spine as (\n    select\n        c.customer_id,\n        c.customer_segment,\n        m.date_month\n    from customers c\n    cross join months m\n),\n\ncustomer_mrr as (\n    select\n        cms.customer_id,\n        cms.customer_segment,\n        cms.date_month,\n        coalesce(f.mrr_amount, 0) as mrr_amount\n    from customer_month_spine cms\n    left join \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\" f\n        on cms.customer_id = f.customer_id\n        and cms.date_month = f.date_month\n),\n\nwith_prev as (\n    select\n        customer_id,\n        customer_segment,\n        date_month,\n        mrr_amount,\n        lag(mrr_amount) over (partition by customer_id order by date_month) as prev_mrr_amount\n    from customer_mrr\n),\n\nmovement as (\n    select\n        date_month,\n        customer_segment,\n        sum(coalesce(prev_mrr_amount, 0)) as starting_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount > coalesce(prev_mrr_amount, 0) then mrr_amount - prev_mrr_amount else 0 end) as expansion_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount > 0 and mrr_amount < coalesce(prev_mrr_amount, 0) then prev_mrr_amount - mrr_amount else 0 end) as contraction_mrr,\n        sum(case when coalesce(prev_mrr_amount, 0) > 0 and mrr_amount = 0 then prev_mrr_amount else 0 end) as churned_mrr\n    from with_prev\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(date_month as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_month_id,\n        date_month,\n        customer_segment,\n        starting_mrr,\n        expansion_mrr,\n        contraction_mrr,\n        churned_mrr,\n        case\n            when starting_mrr = 0 then 0\n            else (starting_mrr + expansion_mrr - contraction_mrr - churned_mrr) / starting_mrr\n        end as net_revenue_retention,\n        case\n            when starting_mrr = 0 then 0\n            else (starting_mrr - contraction_mrr - churned_mrr) / starting_mrr\n        end as gross_revenue_retention\n    from movement\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"net_revenue_retention\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.524177Z", "completed_at": "2026-02-05T21:50:55.530364Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.531805Z", "completed_at": "2026-02-05T21:50:55.531814Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010587453842163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_fct_monthly_recurring_revenue_mrr_amount__1000000__0.30bcc21edd", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.536143Z", "completed_at": "2026-02-05T21:50:55.541585Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.542963Z", "completed_at": "2026-02-05T21:50:55.542975Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00953221321105957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_customer_id.a66423ce4f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.547140Z", "completed_at": "2026-02-05T21:50:55.552612Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.554051Z", "completed_at": "2026-02-05T21:50:55.554059Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009502887725830078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_customer_month_id.b7a062ebbc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_month_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere customer_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.558214Z", "completed_at": "2026-02-05T21:50:55.565260Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.566673Z", "completed_at": "2026-02-05T21:50:55.566683Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01109933853149414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_date_month.8089d21391", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.570897Z", "completed_at": "2026-02-05T21:50:55.576161Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.577530Z", "completed_at": "2026-02-05T21:50:55.577538Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009256124496459961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_monthly_recurring_revenue_mrr_amount.4c2963d658", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.581666Z", "completed_at": "2026-02-05T21:50:55.587747Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.589121Z", "completed_at": "2026-02-05T21:50:55.589129Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010023355484008789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_fct_monthly_recurring_revenue_customer_id__customer_id__ref_dim_customers_.09138f6532", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.593367Z", "completed_at": "2026-02-05T21:50:55.598780Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.600152Z", "completed_at": "2026-02-05T21:50:55.600161Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009453773498535156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_fct_monthly_recurring_revenue_customer_month_id.a9d2287217", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\nwhere customer_month_id is not null\ngroup by customer_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.604495Z", "completed_at": "2026-02-05T21:50:55.611042Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.612389Z", "completed_at": "2026-02-05T21:50:55.612396Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010411739349365234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_fct_subscriptions_billing_cycle__monthly__annual.f19036f213", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        billing_cycle as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    group by billing_cycle\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'monthly','annual'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.616560Z", "completed_at": "2026-02-05T21:50:55.622157Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.623553Z", "completed_at": "2026-02-05T21:50:55.623562Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009590387344360352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_fct_subscriptions_status__active__paused__churned__upgraded__downgraded.15fca4795f", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'active','paused','churned','upgraded','downgraded'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.627804Z", "completed_at": "2026-02-05T21:50:55.633693Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.635110Z", "completed_at": "2026-02-05T21:50:55.635117Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009963035583496094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_fct_subscriptions_amount__1000000__0.21af0e0ca7", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and amount >= 0 and amount <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.639297Z", "completed_at": "2026-02-05T21:50:55.645187Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.646602Z", "completed_at": "2026-02-05T21:50:55.646612Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009903192520141602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_fct_subscriptions_mrr_amount__100000__0.b7f8e4f817", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.650911Z", "completed_at": "2026-02-05T21:50:55.656168Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.657613Z", "completed_at": "2026-02-05T21:50:55.657624Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009474992752075195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_amount.77f80a5332", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect amount\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.661849Z", "completed_at": "2026-02-05T21:50:55.668829Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.670200Z", "completed_at": "2026-02-05T21:50:55.670210Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010970592498779297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_billing_cycle.0a7a17a18b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect billing_cycle\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere billing_cycle is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.674421Z", "completed_at": "2026-02-05T21:50:55.680064Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.681457Z", "completed_at": "2026-02-05T21:50:55.681467Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009666204452514648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_customer_id.ae33a3a9d8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.685618Z", "completed_at": "2026-02-05T21:50:55.691009Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.692412Z", "completed_at": "2026-02-05T21:50:55.692421Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009379148483276367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_mrr_amount.0b5f93cb94", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.696643Z", "completed_at": "2026-02-05T21:50:55.702325Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.703725Z", "completed_at": "2026-02-05T21:50:55.703735Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009717941284179688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_plan_id.07baa591b1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect plan_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere plan_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.707905Z", "completed_at": "2026-02-05T21:50:55.714519Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.715872Z", "completed_at": "2026-02-05T21:50:55.715880Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010489702224731445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_status.daa1b1fe34", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere status is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.720015Z", "completed_at": "2026-02-05T21:50:55.796763Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.798158Z", "completed_at": "2026-02-05T21:50:55.798170Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08079099655151367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_fct_subscriptions_subscription_id.f690e778b1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.802342Z", "completed_at": "2026-02-05T21:50:55.808688Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.810057Z", "completed_at": "2026-02-05T21:50:55.810067Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010329484939575195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_fct_subscriptions_customer_id__customer_id__ref_dim_customers_.738b2dd4ca", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.814273Z", "completed_at": "2026-02-05T21:50:55.820786Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.822166Z", "completed_at": "2026-02-05T21:50:55.822175Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010501623153686523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_fct_subscriptions_plan_id__plan_id__ref_dim_plans_.09ecb91cb5", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select plan_id as from_field\n    from \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\n    where plan_id is not null\n),\n\nparent as (\n    select plan_id as to_field\n    from \"saas_analytics\".\"main_marts\".\"dim_plans\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.826497Z", "completed_at": "2026-02-05T21:50:55.831816Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.833166Z", "completed_at": "2026-02-05T21:50:55.833175Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009299278259277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_fct_subscriptions_subscription_id.71386a928a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"fct_subscriptions\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.837356Z", "completed_at": "2026-02-05T21:50:55.844545Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.845947Z", "completed_at": "2026-02-05T21:50:55.845957Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011255264282226562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_subscription_periods_mrr_amount__100000__0.32396aeab0", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and mrr_amount >= 0 and mrr_amount <= 100000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.850168Z", "completed_at": "2026-02-05T21:50:55.855609Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.856997Z", "completed_at": "2026-02-05T21:50:55.857007Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009363651275634766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_subscription_periods_customer_id.33a91ad17a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.861269Z", "completed_at": "2026-02-05T21:50:55.866914Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.868270Z", "completed_at": "2026-02-05T21:50:55.868281Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009595394134521484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_subscription_periods_mrr_amount.c3d6239f36", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mrr_amount\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere mrr_amount is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.872415Z", "completed_at": "2026-02-05T21:50:55.877951Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.879324Z", "completed_at": "2026-02-05T21:50:55.879334Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009503602981567383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_subscription_periods_subscription_id.228100b7db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect subscription_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere subscription_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.883636Z", "completed_at": "2026-02-05T21:50:55.891776Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.893202Z", "completed_at": "2026-02-05T21:50:55.893214Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012353658676147461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_subscription_periods_customer_id__customer_id__ref_stg_customers_.d2a65dcd76", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.897621Z", "completed_at": "2026-02-05T21:50:55.902993Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.904350Z", "completed_at": "2026-02-05T21:50:55.904360Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009308576583862305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_subscription_periods_subscription_id.213d4156ea", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    subscription_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_subscription_periods\"\nwhere subscription_id is not null\ngroup by subscription_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.908553Z", "completed_at": "2026-02-05T21:50:55.914852Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.916284Z", "completed_at": "2026-02-05T21:50:55.916296Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010416746139526367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_customer_health_score_health_score__100__0.0fbd6b513b", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and health_score >= 0 and health_score <= 100\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.920701Z", "completed_at": "2026-02-05T21:50:55.928776Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.930183Z", "completed_at": "2026-02-05T21:50:55.930195Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01223897933959961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_customer_health_score_payment_failure_rate_last_90d__1__0.7e1e7e5f41", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and payment_failure_rate_last_90d >= 0 and payment_failure_rate_last_90d <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.934419Z", "completed_at": "2026-02-05T21:50:55.939890Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.941230Z", "completed_at": "2026-02-05T21:50:55.941240Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009343624114990234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_as_of_date.36d720fd53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect as_of_date\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere as_of_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.945399Z", "completed_at": "2026-02-05T21:50:55.952237Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.953609Z", "completed_at": "2026-02-05T21:50:55.953618Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010737180709838867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_customer_id.270547872f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.957800Z", "completed_at": "2026-02-05T21:50:55.963523Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.964892Z", "completed_at": "2026-02-05T21:50:55.964902Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00974273681640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_health_score.f383d46da2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect health_score\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere health_score is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.969027Z", "completed_at": "2026-02-05T21:50:55.974397Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.975782Z", "completed_at": "2026-02-05T21:50:55.975791Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009351730346679688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_customer_health_score_payment_failure_rate_last_90d.e26d5a38c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect payment_failure_rate_last_90d\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere payment_failure_rate_last_90d is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.979934Z", "completed_at": "2026-02-05T21:50:55.986152Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:55.987543Z", "completed_at": "2026-02-05T21:50:55.987553Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010271310806274414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_customer_health_score_customer_id__customer_id__ref_stg_customers_.fe675ec61f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:55.991820Z", "completed_at": "2026-02-05T21:50:55.998786Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.000137Z", "completed_at": "2026-02-05T21:50:56.000148Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010970830917358398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_customer_health_score_customer_id.d7e00c064a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_customer_health_score\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.004278Z", "completed_at": "2026-02-05T21:50:56.010047Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.011404Z", "completed_at": "2026-02-05T21:50:56.011412Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009711980819702148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_monthly_usage_event_count__100000000__0.7fcfb98d27", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and event_count >= 0 and event_count <= 100000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.015649Z", "completed_at": "2026-02-05T21:50:56.021563Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.022975Z", "completed_at": "2026-02-05T21:50:56.022985Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009981155395507812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_int_monthly_usage_total_usage_quantity__1000000000__0.a3a21278a6", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and total_usage_quantity >= 0 and total_usage_quantity <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.027180Z", "completed_at": "2026-02-05T21:50:56.032811Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.034134Z", "completed_at": "2026-02-05T21:50:56.034143Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009542465209960938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_customer_id.9f5a52035d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.038185Z", "completed_at": "2026-02-05T21:50:56.043381Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.044743Z", "completed_at": "2026-02-05T21:50:56.044751Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009102106094360352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_customer_month_id.74f34aceba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_month_id\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere customer_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.048948Z", "completed_at": "2026-02-05T21:50:56.055990Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.057338Z", "completed_at": "2026-02-05T21:50:56.057347Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011045694351196289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_event_count.823f19e9a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_count\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere event_count is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.061458Z", "completed_at": "2026-02-05T21:50:56.066623Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.067967Z", "completed_at": "2026-02-05T21:50:56.067975Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009076356887817383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_total_usage_quantity.9c8d7d37db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_usage_quantity\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere total_usage_quantity is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.072045Z", "completed_at": "2026-02-05T21:50:56.077201Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.078561Z", "completed_at": "2026-02-05T21:50:56.078570Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00897836685180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_int_monthly_usage_usage_month.5593c46a18", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect usage_month\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere usage_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.082674Z", "completed_at": "2026-02-05T21:50:56.088835Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.090180Z", "completed_at": "2026-02-05T21:50:56.090188Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010004043579101562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.relationships_int_monthly_usage_customer_id__customer_id__ref_stg_customers_.46c0ada6b9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_id as from_field\n    from \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\n    where customer_id is not null\n),\n\nparent as (\n    select customer_id as to_field\n    from \"saas_analytics\".\"main_staging\".\"stg_customers\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.094193Z", "completed_at": "2026-02-05T21:50:56.100611Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.102008Z", "completed_at": "2026-02-05T21:50:56.102017Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010339736938476562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_int_monthly_usage_customer_month_id.50e00ffb9c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_intermediate\".\"int_monthly_usage\"\nwhere customer_month_id is not null\ngroup by customer_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.106190Z", "completed_at": "2026-02-05T21:50:56.112282Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.113668Z", "completed_at": "2026-02-05T21:50:56.113675Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010033369064331055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.customer_lifetime_value", "compiled": true, "compiled_code": "with months as (\n    select distinct\n        date_month\n    from \"saas_analytics\".\"main_marts\".\"dim_dates\"\n    where date_month >= '2022-06-01'  -- Start after 6 months of data exists\n),\n\ncustomers as (\n    select\n        customer_id,\n        customer_segment\n    from \"saas_analytics\".\"main_marts\".\"dim_customers\"\n),\n\nmrr as (\n    select\n        customer_id,\n        date_month,\n        mrr_amount\n    from \"saas_analytics\".\"main_marts\".\"fct_monthly_recurring_revenue\"\n),\n\nchurn as (\n    select\n        date_month,\n        customer_segment,\n        customer_churn_rate\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n),\n\n-- For each as_of_month, calculate ARPU using trailing 6 months\nsegment_arpu_by_month as (\n    select\n        m.date_month as as_of_month,\n        c.customer_segment,\n        avg(case when mrr.mrr_amount > 0 then mrr.mrr_amount end) as arpu\n    from months m\n    cross join customers c\n    left join mrr\n        on c.customer_id = mrr.customer_id\n        and mrr.date_month > m.date_month - interval 6 month\n        and mrr.date_month <= m.date_month\n    group by 1, 2\n),\n\n-- For each as_of_month, calculate avg churn using trailing 6 months\nsegment_churn_by_month as (\n    select\n        m.date_month as as_of_month,\n        ch.customer_segment,\n        avg(ch.customer_churn_rate) as avg_monthly_customer_churn_rate\n    from months m\n    join churn ch\n        on ch.date_month > m.date_month - interval 6 month\n        and ch.date_month <= m.date_month\n    group by 1, 2\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(a.as_of_month as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(coalesce(a.customer_segment, ch.customer_segment) as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_as_of_id,\n        a.as_of_month,\n        coalesce(a.customer_segment, ch.customer_segment) as customer_segment,\n        coalesce(a.arpu, 0) as arpu,\n        coalesce(ch.avg_monthly_customer_churn_rate, 0) as avg_monthly_customer_churn_rate,\n        case\n            when coalesce(ch.avg_monthly_customer_churn_rate, 0) = 0 then null\n            else least(120, 1.0 / ch.avg_monthly_customer_churn_rate)\n        end as expected_lifetime_months,\n        case\n            when coalesce(ch.avg_monthly_customer_churn_rate, 0) = 0 then null\n            else coalesce(a.arpu, 0) * least(120, 1.0 / ch.avg_monthly_customer_churn_rate)\n        end as lifetime_value\n    from segment_arpu_by_month a\n    full outer join segment_churn_by_month ch\n        on a.as_of_month = ch.as_of_month\n        and a.customer_segment = ch.customer_segment\n    where coalesce(a.as_of_month, ch.as_of_month) is not null\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"customer_lifetime_value\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.118291Z", "completed_at": "2026-02-05T21:50:56.123610Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.124961Z", "completed_at": "2026-02-05T21:50:56.124969Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009771347045898438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_churn_analysis_customer_segment__smb__mid_market__enterprise__unknown.12ff3b906a", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.129051Z", "completed_at": "2026-02-05T21:50:56.133145Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.134501Z", "completed_at": "2026-02-05T21:50:56.134509Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007911205291748047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.churn_rate_sanity", "compiled": true, "compiled_code": "\n\nselect\n    date_month,\n    customer_segment,\n    customer_churn_rate,\n    starting_customers,\n    churned_customers,\n    'Churn rate exceeds 50% - likely data issue' as failure_reason\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere customer_churn_rate > 0.50\n  and starting_customers > 10  -- Only flag if meaningful sample size", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.138585Z", "completed_at": "2026-02-05T21:50:56.144409Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.145811Z", "completed_at": "2026-02-05T21:50:56.145818Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009766817092895508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_churned_customers__1000000000__0.ecf0d4d6a8", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and churned_customers >= 0 and churned_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.149996Z", "completed_at": "2026-02-05T21:50:56.156848Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.158218Z", "completed_at": "2026-02-05T21:50:56.158225Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010864496231079102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_customer_churn_rate__1__0.a3521c9c86", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and customer_churn_rate >= 0 and customer_churn_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.162431Z", "completed_at": "2026-02-05T21:50:56.168106Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.169743Z", "completed_at": "2026-02-05T21:50:56.169752Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00991058349609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_revenue_churn_rate__1__0.ca578782ea", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and revenue_churn_rate >= 0 and revenue_churn_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.173961Z", "completed_at": "2026-02-05T21:50:56.179907Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.181286Z", "completed_at": "2026-02-05T21:50:56.181293Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009984254837036133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_churn_analysis_starting_customers__1000000000__0.434546e5eb", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and starting_customers >= 0 and starting_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"churn_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.185490Z", "completed_at": "2026-02-05T21:50:56.190854Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.192231Z", "completed_at": "2026-02-05T21:50:56.192240Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009306669235229492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_churned_customers.8445fc5f8a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect churned_customers\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere churned_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.196421Z", "completed_at": "2026-02-05T21:50:56.203218Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.204588Z", "completed_at": "2026-02-05T21:50:56.204597Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010712862014770508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_customer_churn_rate.b2257552ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_churn_rate\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere customer_churn_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.208753Z", "completed_at": "2026-02-05T21:50:56.213704Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.215048Z", "completed_at": "2026-02-05T21:50:56.215056Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008881568908691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_customer_segment.f82e1dbd2a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.219169Z", "completed_at": "2026-02-05T21:50:56.224547Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.225884Z", "completed_at": "2026-02-05T21:50:56.225892Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009287357330322266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_date_month.aeceb24cdf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.229995Z", "completed_at": "2026-02-05T21:50:56.235178Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.236534Z", "completed_at": "2026-02-05T21:50:56.236542Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009143352508544922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_revenue_churn_rate.f68037cf43", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect revenue_churn_rate\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere revenue_churn_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.240651Z", "completed_at": "2026-02-05T21:50:56.246165Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.247553Z", "completed_at": "2026-02-05T21:50:56.247563Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009507417678833008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_segment_month_id.face7d9329", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_month_id\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere segment_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.251676Z", "completed_at": "2026-02-05T21:50:56.258389Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.259749Z", "completed_at": "2026-02-05T21:50:56.259757Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010559558868408203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_churn_analysis_starting_customers.5eb8964198", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect starting_customers\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere starting_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.263768Z", "completed_at": "2026-02-05T21:50:56.268663Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.270043Z", "completed_at": "2026-02-05T21:50:56.270051Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00877070426940918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_churn_analysis_segment_month_id.d17ebe9d07", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"churn_analysis\"\nwhere segment_month_id is not null\ngroup by segment_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.274123Z", "completed_at": "2026-02-05T21:50:56.279409Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.280779Z", "completed_at": "2026-02-05T21:50:56.280787Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009198665618896484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_cohort_retention_customer_segment__smb__mid_market__enterprise__unknown.537731c238", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.284932Z", "completed_at": "2026-02-05T21:50:56.290960Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.292328Z", "completed_at": "2026-02-05T21:50:56.292337Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009961843490600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_active_customers__1000000000__0.c41f1ccb43", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and active_customers >= 0 and active_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.296609Z", "completed_at": "2026-02-05T21:50:56.303593Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.304964Z", "completed_at": "2026-02-05T21:50:56.304972Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010920047760009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_cohort_customers__1000000000__0.3ded49037c", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and cohort_customers >= 0 and cohort_customers <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.309082Z", "completed_at": "2026-02-05T21:50:56.315037Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.316492Z", "completed_at": "2026-02-05T21:50:56.316504Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009954690933227539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_months_since_signup__120__0.3abf594756", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and months_since_signup >= 0 and months_since_signup <= 120\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.320804Z", "completed_at": "2026-02-05T21:50:56.326644Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.328025Z", "completed_at": "2026-02-05T21:50:56.328034Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009912252426147461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_cohort_retention_retention_rate__1__0.75ce1e0e47", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and retention_rate >= 0 and retention_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"cohort_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.332264Z", "completed_at": "2026-02-05T21:50:56.337841Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.339200Z", "completed_at": "2026-02-05T21:50:56.339210Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009581327438354492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_active_customers.f50b652fd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect active_customers\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere active_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.343385Z", "completed_at": "2026-02-05T21:50:56.348723Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.350085Z", "completed_at": "2026-02-05T21:50:56.350094Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009278535842895508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_cohort_customers.37da0ff420", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_customers\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_customers is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.354239Z", "completed_at": "2026-02-05T21:50:56.360850Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.362195Z", "completed_at": "2026-02-05T21:50:56.362202Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010467529296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_cohort_month.0e607e02af", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_month\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.366371Z", "completed_at": "2026-02-05T21:50:56.371579Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.372954Z", "completed_at": "2026-02-05T21:50:56.372962Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00909876823425293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_cohort_segment_period_id.0d29ee4706", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cohort_segment_period_id\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_segment_period_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.377054Z", "completed_at": "2026-02-05T21:50:56.382183Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.383554Z", "completed_at": "2026-02-05T21:50:56.383562Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008991479873657227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_customer_segment.c697b5eb0e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.387818Z", "completed_at": "2026-02-05T21:50:56.392942Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.394318Z", "completed_at": "2026-02-05T21:50:56.394327Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009150266647338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_months_since_signup.41d00203f4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect months_since_signup\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere months_since_signup is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.398522Z", "completed_at": "2026-02-05T21:50:56.405273Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.406641Z", "completed_at": "2026-02-05T21:50:56.406650Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010651350021362305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_cohort_retention_retention_rate.8166dc37e8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect retention_rate\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere retention_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.410739Z", "completed_at": "2026-02-05T21:50:56.415727Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.417068Z", "completed_at": "2026-02-05T21:50:56.417076Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008939027786254883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_cohort_retention_cohort_segment_period_id.5afcaa3a16", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    cohort_segment_period_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"cohort_retention\"\nwhere cohort_segment_period_id is not null\ngroup by cohort_segment_period_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.421312Z", "completed_at": "2026-02-05T21:50:56.426917Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.428337Z", "completed_at": "2026-02-05T21:50:56.428346Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009622573852539062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_mrr_analysis_customer_segment__smb__mid_market__enterprise__unknown.1257e5343c", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.432591Z", "completed_at": "2026-02-05T21:50:56.438586Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.439977Z", "completed_at": "2026-02-05T21:50:56.439984Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0100250244140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_mrr_analysis_churned_mrr__1000000000__0.5cafc45ab5", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and churned_mrr >= 0 and churned_mrr <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.444114Z", "completed_at": "2026-02-05T21:50:56.449807Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.451209Z", "completed_at": "2026-02-05T21:50:56.451217Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009618759155273438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_mrr_analysis_new_mrr__1000000000__0.1d1f2a56be", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and new_mrr >= 0 and new_mrr <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.455341Z", "completed_at": "2026-02-05T21:50:56.462540Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.463922Z", "completed_at": "2026-02-05T21:50:56.463932Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011196374893188477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_mrr_analysis_total_mrr__1000000000__0.03c10ae006", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and total_mrr >= 0 and total_mrr <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.468189Z", "completed_at": "2026-02-05T21:50:56.472366Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.473740Z", "completed_at": "2026-02-05T21:50:56.473749Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008095264434814453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.mrr_month_over_month_sanity", "compiled": true, "compiled_code": "\n\nwith monthly_mrr as (\n    select\n        date_month,\n        sum(total_mrr) as total_mrr\n    from \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\n    group by date_month\n),\n\nmrr_changes as (\n    select\n        date_month,\n        total_mrr,\n        lag(total_mrr) over (order by date_month) as prior_month_mrr,\n        case\n            when lag(total_mrr) over (order by date_month) = 0 then 0\n            else (total_mrr - lag(total_mrr) over (order by date_month)) \n                 / lag(total_mrr) over (order by date_month)\n        end as pct_change\n    from monthly_mrr\n)\n\nselect\n    date_month,\n    total_mrr,\n    prior_month_mrr,\n    pct_change,\n    'MRR dropped more than 20% month-over-month' as failure_reason\nfrom mrr_changes\nwhere pct_change < -0.20\n  and prior_month_mrr > 0  -- Only flag if there was prior MRR to compare against", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.477965Z", "completed_at": "2026-02-05T21:50:56.483386Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.484796Z", "completed_at": "2026-02-05T21:50:56.484804Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009506464004516602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_churned_mrr.a3d399ce96", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect churned_mrr\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere churned_mrr is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.488980Z", "completed_at": "2026-02-05T21:50:56.494190Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.495595Z", "completed_at": "2026-02-05T21:50:56.495604Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009253501892089844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_customer_segment.c66caf3809", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.499723Z", "completed_at": "2026-02-05T21:50:56.506239Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.507641Z", "completed_at": "2026-02-05T21:50:56.507650Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010460615158081055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_date_month.b31589f01e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.511809Z", "completed_at": "2026-02-05T21:50:56.517227Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.518601Z", "completed_at": "2026-02-05T21:50:56.518610Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009443998336791992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_new_mrr.7bd7ba8daa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect new_mrr\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere new_mrr is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.522784Z", "completed_at": "2026-02-05T21:50:56.528152Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.529605Z", "completed_at": "2026-02-05T21:50:56.529612Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009438276290893555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_segment_month_id.96b64accac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_month_id\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere segment_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.533743Z", "completed_at": "2026-02-05T21:50:56.539055Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.540411Z", "completed_at": "2026-02-05T21:50:56.540419Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009260892868041992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_mrr_analysis_total_mrr.80e9772030", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_mrr\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere total_mrr is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.544543Z", "completed_at": "2026-02-05T21:50:56.549546Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.550893Z", "completed_at": "2026-02-05T21:50:56.550901Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008939027786254883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_mrr_analysis_segment_month_id.73b748be94", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"mrr_analysis\"\nwhere segment_month_id is not null\ngroup by segment_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.555150Z", "completed_at": "2026-02-05T21:50:56.562256Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.563676Z", "completed_at": "2026-02-05T21:50:56.563685Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0110931396484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_net_revenue_retention_customer_segment__smb__mid_market__enterprise__unknown.bad1f7855d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.567823Z", "completed_at": "2026-02-05T21:50:56.573571Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.574944Z", "completed_at": "2026-02-05T21:50:56.574951Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009742259979248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_net_revenue_retention_gross_revenue_retention__1__0.069667a4ae", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and gross_revenue_retention >= 0 and gross_revenue_retention <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.579128Z", "completed_at": "2026-02-05T21:50:56.584839Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.586218Z", "completed_at": "2026-02-05T21:50:56.586227Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009702444076538086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_net_revenue_retention_net_revenue_retention__5__0.02505b257b", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and net_revenue_retention >= 0 and net_revenue_retention <= 5\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.590467Z", "completed_at": "2026-02-05T21:50:56.595689Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.597063Z", "completed_at": "2026-02-05T21:50:56.597072Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009165287017822266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_customer_segment.a64b766957", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.601212Z", "completed_at": "2026-02-05T21:50:56.607980Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.609327Z", "completed_at": "2026-02-05T21:50:56.609336Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010735750198364258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_date_month.8b7a8fb0c8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_month\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere date_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.613553Z", "completed_at": "2026-02-05T21:50:56.618568Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.619924Z", "completed_at": "2026-02-05T21:50:56.619932Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009003639221191406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_gross_revenue_retention.11b3e16b67", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect gross_revenue_retention\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere gross_revenue_retention is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.624029Z", "completed_at": "2026-02-05T21:50:56.629133Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.630598Z", "completed_at": "2026-02-05T21:50:56.630605Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009207010269165039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_net_revenue_retention.8a6d154e31", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect net_revenue_retention\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere net_revenue_retention is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.634839Z", "completed_at": "2026-02-05T21:50:56.640145Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.641536Z", "completed_at": "2026-02-05T21:50:56.641545Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00923776626586914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_net_revenue_retention_segment_month_id.64a6b596d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_month_id\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere segment_month_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.645715Z", "completed_at": "2026-02-05T21:50:56.650648Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.651990Z", "completed_at": "2026-02-05T21:50:56.651999Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008829593658447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_net_revenue_retention_segment_month_id.cc84fd260d", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_month_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"net_revenue_retention\"\nwhere segment_month_id is not null\ngroup by segment_month_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.656124Z", "completed_at": "2026-02-05T21:50:56.663853Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.665255Z", "completed_at": "2026-02-05T21:50:56.665265Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01174306869506836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.saas_analytics.unit_economics", "compiled": true, "compiled_code": "with ltv as (\n    select\n        as_of_month,\n        customer_segment,\n        arpu,\n        avg_monthly_customer_churn_rate,\n        expected_lifetime_months,\n        lifetime_value\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n),\n\nwith_cac as (\n    select\n        as_of_month,\n        customer_segment,\n        arpu,\n        avg_monthly_customer_churn_rate,\n        expected_lifetime_months,\n        lifetime_value,\n        case\n            when customer_segment = 'smb' then 600\n            when customer_segment = 'mid-market' then 2500\n            when customer_segment = 'enterprise' then 12000\n            else null\n        end as assumed_cac\n    from ltv\n),\n\nfinal as (\n    select\n        md5(cast(coalesce(cast(as_of_month as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(customer_segment as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as segment_as_of_id,\n        as_of_month,\n        customer_segment,\n        arpu,\n        avg_monthly_customer_churn_rate,\n        expected_lifetime_months,\n        lifetime_value,\n        assumed_cac,\n        case\n            when assumed_cac is null or assumed_cac = 0 then null\n            else lifetime_value / assumed_cac\n        end as ltv_to_cac_ratio,\n        case\n            when arpu is null or arpu = 0 or assumed_cac is null then null\n            else assumed_cac / arpu\n        end as payback_months\n    from with_cac\n)\n\nselect *\nfrom final", "relation_name": "\"saas_analytics\".\"main_marts\".\"unit_economics\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.669842Z", "completed_at": "2026-02-05T21:50:56.675546Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.676924Z", "completed_at": "2026-02-05T21:50:56.676934Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009897470474243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.accepted_values_customer_lifetime_value_customer_segment__smb__mid_market__enterprise__unknown.d1b95c9570", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_segment as value_field,\n        count(*) as n_records\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    group by customer_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'smb','mid-market','enterprise','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.681120Z", "completed_at": "2026-02-05T21:50:56.687046Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.688478Z", "completed_at": "2026-02-05T21:50:56.688488Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009986400604248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_arpu__1000000__0.149ff1813f", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and arpu >= 0 and arpu <= 1000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.692749Z", "completed_at": "2026-02-05T21:50:56.698804Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.700208Z", "completed_at": "2026-02-05T21:50:56.700218Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010076522827148438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_avg_monthly_customer_churn_rate__1__0.02204de856", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and avg_monthly_customer_churn_rate >= 0 and avg_monthly_customer_churn_rate <= 1\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.704477Z", "completed_at": "2026-02-05T21:50:56.712266Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.713684Z", "completed_at": "2026-02-05T21:50:56.713694Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01190328598022461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_expected_lifetime_months__120__0__expected_lifetime_months_is_not_null.5d159b06eb", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and expected_lifetime_months >= 0 and expected_lifetime_months <= 120\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    where\n        expected_lifetime_months is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.717938Z", "completed_at": "2026-02-05T21:50:56.724715Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.726119Z", "completed_at": "2026-02-05T21:50:56.726131Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010912656784057617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_customer_lifetime_value_lifetime_value__1000000000__0__lifetime_value_is_not_null.1e26703122", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and lifetime_value >= 0 and lifetime_value <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\n    where\n        lifetime_value is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.730501Z", "completed_at": "2026-02-05T21:50:56.736288Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.737677Z", "completed_at": "2026-02-05T21:50:56.737688Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009872674942016602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_arpu.68cf958b17", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect arpu\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere arpu is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.741984Z", "completed_at": "2026-02-05T21:50:56.747701Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.749060Z", "completed_at": "2026-02-05T21:50:56.749071Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00980377197265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_as_of_month.2440beb6c2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect as_of_month\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere as_of_month is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.753260Z", "completed_at": "2026-02-05T21:50:56.759082Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.760476Z", "completed_at": "2026-02-05T21:50:56.760488Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009831428527832031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_avg_monthly_customer_churn_rate.1d3497b679", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect avg_monthly_customer_churn_rate\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere avg_monthly_customer_churn_rate is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.764657Z", "completed_at": "2026-02-05T21:50:56.771661Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.773026Z", "completed_at": "2026-02-05T21:50:56.773038Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010924339294433594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_customer_segment.77e1bf04e8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_segment\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere customer_segment is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.777227Z", "completed_at": "2026-02-05T21:50:56.782631Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.783968Z", "completed_at": "2026-02-05T21:50:56.783977Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009331703186035156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_customer_lifetime_value_segment_as_of_id.6b96a69161", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_as_of_id\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere segment_as_of_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.788061Z", "completed_at": "2026-02-05T21:50:56.793228Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.794614Z", "completed_at": "2026-02-05T21:50:56.794623Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009111642837524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_customer_lifetime_value_segment_as_of_id.c8b6e3f3fd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_as_of_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"customer_lifetime_value\"\nwhere segment_as_of_id is not null\ngroup by segment_as_of_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.798728Z", "completed_at": "2026-02-05T21:50:56.805114Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.806506Z", "completed_at": "2026-02-05T21:50:56.806516Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010318517684936523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_unit_economics_assumed_cac__1000000000__0__assumed_cac_is_not_null.0593deb695", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and assumed_cac >= 0 and assumed_cac <= 1000000000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"unit_economics\"\n    where\n        assumed_cac is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.810694Z", "completed_at": "2026-02-05T21:50:56.818359Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.819764Z", "completed_at": "2026-02-05T21:50:56.819773Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011724472045898438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_unit_economics_ltv_to_cac_ratio__1000__0__ltv_to_cac_ratio_is_not_null.d76c1f7ce7", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and ltv_to_cac_ratio >= 0 and ltv_to_cac_ratio <= 1000\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"unit_economics\"\n    where\n        ltv_to_cac_ratio is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.823961Z", "completed_at": "2026-02-05T21:50:56.830595Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.832011Z", "completed_at": "2026-02-05T21:50:56.832021Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010620832443237305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.dbt_expectations_expect_column_values_to_be_between_unit_economics_payback_months__120__0__payback_months_is_not_null.77c8663847", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and payback_months >= 0 and payback_months <= 120\n)\n as expression\n\n\n    from \"saas_analytics\".\"main_marts\".\"unit_economics\"\n    where\n        payback_months is not null\n    \n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.836213Z", "completed_at": "2026-02-05T21:50:56.841364Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.842724Z", "completed_at": "2026-02-05T21:50:56.842732Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009126663208007812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.not_null_unit_economics_segment_as_of_id.1d127f6ec4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect segment_as_of_id\nfrom \"saas_analytics\".\"main_marts\".\"unit_economics\"\nwhere segment_as_of_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-05T21:50:56.846898Z", "completed_at": "2026-02-05T21:50:56.852182Z"}, {"name": "execute", "started_at": "2026-02-05T21:50:56.853539Z", "completed_at": "2026-02-05T21:50:56.853547Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009157896041870117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.saas_analytics.unique_unit_economics_segment_as_of_id.5d713df7b9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    segment_as_of_id as unique_field,\n    count(*) as n_records\n\nfrom \"saas_analytics\".\"main_marts\".\"unit_economics\"\nwhere segment_as_of_id is not null\ngroup by segment_as_of_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 2.982654333114624, "args": {"version_check": true, "log_format_file": "debug", "warn_error_options": {"include": [], "exclude": []}, "print": true, "static_parser": true, "partial_parse": true, "project_dir": "/home/runner/work/saas-analytics-quality/saas-analytics-quality/dbt_project", "printer_width": 80, "indirect_selection": "eager", "introspect": true, "send_anonymous_usage_stats": true, "use_colors_file": true, "empty_catalog": false, "populate_cache": true, "compile": true, "macro_debugging": false, "log_file_max_bytes": 10485760, "write_json": true, "enable_legacy_logger": false, "log_level_file": "debug", "select": [], "strict_mode": false, "log_path": "/home/runner/work/saas-analytics-quality/saas-analytics-quality/dbt_project/logs", "log_format": "default", "partial_parse_file_diff": true, "cache_selected_only": false, "exclude": [], "invocation_command": "dbt docs generate", "quiet": false, "defer": false, "profiles_dir": ".", "vars": {}, "static": false, "show_resource_report": false, "log_level": "info", "which": "generate", "favor_state": false, "use_colors": true}}